<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Recommender Systems and Customer Targeting | Customer Analytics</title>
  <meta name="description" content="3 Recommender Systems and Customer Targeting | Customer Analytics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Recommender Systems and Customer Targeting | Customer Analytics" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Recommender Systems and Customer Targeting | Customer Analytics" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="customer-satisfaction-and-loyalty.html"/>
<link rel="next" href="probabilistic-models-for-customer-analytics.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>setup</a></li>
<li class="chapter" data-level="1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html"><i class="fa fa-check"></i><b>1</b> Customer Lifetime Value</a>
<ul>
<li class="chapter" data-level="1.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#non-contractual-the-matrix-formulation-migration-model"><i class="fa fa-check"></i><b>1.1</b> Non-contractual: The matrix formulation (Migration model)</a></li>
<li class="chapter" data-level="1.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#contractual-valuing-customer-base-residual-lifetime-value"><i class="fa fa-check"></i><b>1.2</b> Contractual: Valuing customer base + residual lifetime value</a></li>
<li class="chapter" data-level="1.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#non-contractual-setting-probabilitic-models"><i class="fa fa-check"></i><b>1.3</b> Non-Contractual Setting: Probabilitic Models</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#paretonbd-vs.-bgnbd"><i class="fa fa-check"></i><b>1.3.1</b> Pareto/NBD vs.Â BG/NBD</a></li>
<li class="chapter" data-level="1.3.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#paretonbd"><i class="fa fa-check"></i><b>1.3.2</b> Pareto/NBD</a>
<ul>
<li class="chapter" data-level="1.3.2.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#data-preparation"><i class="fa fa-check"></i><b>1.3.2.1</b> Data preparation</a></li>
<li class="chapter" data-level="1.3.2.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#parameter-estimation"><i class="fa fa-check"></i><b>1.3.2.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="1.3.2.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#individual-level-estimations"><i class="fa fa-check"></i><b>1.3.2.3</b> Individual Level Estimations</a></li>
<li class="chapter" data-level="1.3.2.4" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#plotting-goodness-of-fit"><i class="fa fa-check"></i><b>1.3.2.4</b> Plotting / Goodness-of-fit</a></li>
</ul></li>
<li class="chapter" data-level="1.3.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#bgnbd"><i class="fa fa-check"></i><b>1.3.3</b> BG/NBD</a>
<ul>
<li class="chapter" data-level="1.3.3.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#data-preparation-1"><i class="fa fa-check"></i><b>1.3.3.1</b> Data Preparation</a></li>
<li class="chapter" data-level="1.3.3.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#parameter-estimation-1"><i class="fa fa-check"></i><b>1.3.3.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="1.3.3.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#individual-level-estimation"><i class="fa fa-check"></i><b>1.3.3.3</b> Individual Level Estimation</a></li>
<li class="chapter" data-level="1.3.3.4" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#plotting-goodness-of-fit-1"><i class="fa fa-check"></i><b>1.3.3.4</b> Plotting / Goodness-of-fit</a></li>
</ul></li>
<li class="chapter" data-level="1.3.4" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#bgbb---not-curicullum"><i class="fa fa-check"></i><b>1.3.4</b> BG/BB - Not curicullum</a></li>
<li class="chapter" data-level="1.3.5" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#examples-from-the-lecture"><i class="fa fa-check"></i><b>1.3.5</b> Examples from the lecture</a>
<ul>
<li class="chapter" data-level="1.3.5.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#paretonbd-1"><i class="fa fa-check"></i><b>1.3.5.1</b> Pareto/NBD</a>
<ul>
<li class="chapter" data-level="1.3.5.1.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#estimate-parameters-for-paretonbd-model-based-upon-calibration-data"><i class="fa fa-check"></i><b>1.3.5.1.1</b> Estimate parameters for Pareto/NBD model based upon calibration data</a></li>
</ul></li>
<li class="chapter" data-level="1.3.5.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#dert-calculation"><i class="fa fa-check"></i><b>1.3.5.2</b> DERT Calculation</a></li>
<li class="chapter" data-level="1.3.5.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#bgnbg-example"><i class="fa fa-check"></i><b>1.3.5.3</b> BG/NBG example</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html"><i class="fa fa-check"></i><b>2</b> Customer Satisfaction and Loyalty</a>
<ul>
<li class="chapter" data-level="2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#customer-surveys"><i class="fa fa-check"></i><b>2.1</b> Customer surveys</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#concepts-and-examples"><i class="fa fa-check"></i><b>2.1.1</b> (1) Concepts and examples</a></li>
<li class="chapter" data-level="2.1.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#sampling-and-response-rate"><i class="fa fa-check"></i><b>2.1.2</b> (2) Sampling and response rate</a></li>
<li class="chapter" data-level="2.1.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#pretesting-and-measurement-validity"><i class="fa fa-check"></i><b>2.1.3</b> (3) Pretesting and measurement validity</a></li>
<li class="chapter" data-level="2.1.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#questionnaire-design"><i class="fa fa-check"></i><b>2.1.4</b> (4) Questionnaire design</a></li>
<li class="chapter" data-level="2.1.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#simple-size"><i class="fa fa-check"></i><b>2.1.5</b> (5) Simple size</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#nps"><i class="fa fa-check"></i><b>2.2</b> NPS</a></li>
<li class="chapter" data-level="2.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#cfa-and-sem-application-lavann"><i class="fa fa-check"></i><b>2.3</b> CFA and SEM Application Lavann</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#business-problem-objectives"><i class="fa fa-check"></i><b>2.3.1</b> Business Problem &amp; Objectives</a></li>
<li class="chapter" data-level="2.3.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#data"><i class="fa fa-check"></i><b>2.3.2</b> Data</a>
<ul>
<li class="chapter" data-level="2.3.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#efa"><i class="fa fa-check"></i><b>2.3.2.1</b> EFA</a></li>
<li class="chapter" data-level="2.3.2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#cfa-model"><i class="fa fa-check"></i><b>2.3.2.2</b> CFA model</a>
<ul>
<li class="chapter" data-level="2.3.2.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#initial-model"><i class="fa fa-check"></i><b>2.3.2.2.1</b> Initial model</a></li>
<li class="chapter" data-level="2.3.2.2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#second-model"><i class="fa fa-check"></i><b>2.3.2.2.2</b> Second model</a>
<ul>
<li class="chapter" data-level="2.3.2.2.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#intepretation-of-the-model"><i class="fa fa-check"></i><b>2.3.2.2.2.1</b> Intepretation of the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.3.2.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#sem"><i class="fa fa-check"></i><b>2.3.2.3</b> SEM</a></li>
</ul></li>
<li class="chapter" data-level="2.3.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#plotting-the-model"><i class="fa fa-check"></i><b>2.3.3</b> Plotting the model</a></li>
<li class="chapter" data-level="2.3.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#consider-a-more-complex-sem-model-involving-a-mediating-effect."><i class="fa fa-check"></i><b>2.3.4</b> Consider a more complex SEM model involving a mediating effect.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#pls"><i class="fa fa-check"></i><b>2.4</b> PLS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#definition-of-pls"><i class="fa fa-check"></i><b>2.4.1</b> Definition of PLS</a></li>
<li class="chapter" data-level="2.4.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#when-to-use-pls-and-when-to-use-sem"><i class="fa fa-check"></i><b>2.4.2</b> When to use PLS and when to use SEM</a></li>
<li class="chapter" data-level="2.4.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#model-construction"><i class="fa fa-check"></i><b>2.4.3</b> Model construction</a></li>
<li class="chapter" data-level="2.4.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#model-estimation"><i class="fa fa-check"></i><b>2.4.4</b> Model Estimation</a></li>
<li class="chapter" data-level="2.4.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#model-evaluation"><i class="fa fa-check"></i><b>2.4.5</b> Model evaluation</a></li>
<li class="chapter" data-level="2.4.6" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#example-for-the-lecture"><i class="fa fa-check"></i><b>2.4.6</b> Example for the lecture</a>
<ul>
<li class="chapter" data-level="2.4.6.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#making-structural--and-measurement-model"><i class="fa fa-check"></i><b>2.4.6.1</b> Making structural- and measurement model</a></li>
<li class="chapter" data-level="2.4.6.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#now-we-can-estimate-the-model"><i class="fa fa-check"></i><b>2.4.6.2</b> Now we can estimate the model</a></li>
<li class="chapter" data-level="2.4.6.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#measuring-quality-of-the-constructs"><i class="fa fa-check"></i><b>2.4.6.3</b> Measuring quality of the constructs</a></li>
<li class="chapter" data-level="2.4.6.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#are-the-coefficients-significant"><i class="fa fa-check"></i><b>2.4.6.4</b> Are the coefficients significant?</a></li>
</ul></li>
<li class="chapter" data-level="2.4.7" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#revised-code"><i class="fa fa-check"></i><b>2.4.7</b> Revised code</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#segmentation-clustering"><i class="fa fa-check"></i><b>2.5</b> Segmentation (Clustering)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#what-is-clustering"><i class="fa fa-check"></i><b>2.5.1</b> What is clustering</a></li>
<li class="chapter" data-level="2.5.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#clustering-techniques"><i class="fa fa-check"></i><b>2.5.2</b> Clustering techniques</a></li>
<li class="chapter" data-level="2.5.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#an-example"><i class="fa fa-check"></i><b>2.5.3</b> An example</a>
<ul>
<li class="chapter" data-level="2.5.3.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#background"><i class="fa fa-check"></i><b>2.5.3.1</b> 1. Background</a>
<ul>
<li class="chapter" data-level="2.5.3.1.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#the-primary-objective-is"><i class="fa fa-check"></i><b>2.5.3.1.1</b> 1.1. The primary objective is:</a></li>
</ul></li>
<li class="chapter" data-level="2.5.3.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#the-data-data-understanding-phase"><i class="fa fa-check"></i><b>2.5.3.2</b> 2. The data (Data Understanding Phase)</a>
<ul>
<li class="chapter" data-level="2.5.3.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#load-data-correctly"><i class="fa fa-check"></i><b>2.5.3.2.1</b> 2.1 Load data correctly</a></li>
<li class="chapter" data-level="2.5.3.2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#check-if-the-data-is-numerical-or-categorical"><i class="fa fa-check"></i><b>2.5.3.2.2</b> 2.2 Check if the data is numerical or categorical</a></li>
<li class="chapter" data-level="2.5.3.2.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#missing-treatment"><i class="fa fa-check"></i><b>2.5.3.2.3</b> 2.3 Missing treatment</a></li>
<li class="chapter" data-level="2.5.3.2.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#select-relevant-variables"><i class="fa fa-check"></i><b>2.5.3.2.4</b> 2.4 Select relevant variables</a></li>
<li class="chapter" data-level="2.5.3.2.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#identify-extreme-outliers-the-most-dissimilar-customers"><i class="fa fa-check"></i><b>2.5.3.2.5</b> 2.5.Identify extreme outliers (the most dissimilar customers)</a></li>
<li class="chapter" data-level="2.5.3.2.6" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#standardize-the-variables-mean0-std.dev1"><i class="fa fa-check"></i><b>2.5.3.2.6</b> 2.6 Standardize the variables (mean=0, std.dev=1)</a></li>
</ul></li>
<li class="chapter" data-level="2.5.3.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#hierarchical-clustering-using-variables"><i class="fa fa-check"></i><b>2.5.3.3</b> 3. Hierarchical clustering (using variables)</a></li>
<li class="chapter" data-level="2.5.3.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#hierarchical-clustering-using-pcs-score-vectors"><i class="fa fa-check"></i><b>2.5.3.4</b> 4. Hierarchical clustering (using PCs score vectors)</a></li>
<li class="chapter" data-level="2.5.3.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#k-means"><i class="fa fa-check"></i><b>2.5.3.5</b> 5. K-means</a></li>
<li class="chapter" data-level="2.5.3.6" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#validation-and-profiling-the-clusters"><i class="fa fa-check"></i><b>2.5.3.6</b> 6. Validation and profiling the clusters</a>
<ul>
<li class="chapter" data-level="2.5.3.6.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#assessing-cluster-stability"><i class="fa fa-check"></i><b>2.5.3.6.1</b> 6.1. Assessing cluster stability</a></li>
<li class="chapter" data-level="2.5.3.6.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#assessing-criterion-predictive-validity"><i class="fa fa-check"></i><b>2.5.3.6.2</b> 6.2. Assessing criterion (predictive) validity</a></li>
<li class="chapter" data-level="2.5.3.6.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#profiling-the-final-cluster-solution"><i class="fa fa-check"></i><b>2.5.3.6.3</b> 6.3. Profiling the final cluster solution</a></li>
</ul></li>
<li class="chapter" data-level="2.5.3.7" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#final-remarks"><i class="fa fa-check"></i><b>2.5.3.7</b> 7. Final remarks</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html"><i class="fa fa-check"></i><b>3</b> Recommender Systems and Customer Targeting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#association-rule"><i class="fa fa-check"></i><b>3.1</b> Association rule</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-and-data-exploration"><i class="fa fa-check"></i><b>3.1.1</b> Loading and data exploration</a></li>
<li class="chapter" data-level="3.1.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#data-preprocessing"><i class="fa fa-check"></i><b>3.1.2</b> Data preprocessing</a>
<ul>
<li class="chapter" data-level="3.1.2.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#encoding-to-correct-data-types"><i class="fa fa-check"></i><b>3.1.2.1</b> Encoding to correct data types</a></li>
<li class="chapter" data-level="3.1.2.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#create-a-data-frame-with-one-row-pr.-invoice"><i class="fa fa-check"></i><b>3.1.2.2</b> Create a data frame with one row pr. invoice</a></li>
</ul></li>
<li class="chapter" data-level="3.1.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-transactions"><i class="fa fa-check"></i><b>3.1.3</b> Loading transactions</a></li>
<li class="chapter" data-level="3.1.4" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#plotting"><i class="fa fa-check"></i><b>3.1.4</b> Plotting</a></li>
<li class="chapter" data-level="3.1.5" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#apriori-calculation"><i class="fa fa-check"></i><b>3.1.5</b> Apriori calculation</a>
<ul>
<li class="chapter" data-level="3.1.5.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#another-example-where-maxlen-3"><i class="fa fa-check"></i><b>3.1.5.1</b> Another example where maxlen = 3</a></li>
<li class="chapter" data-level="3.1.5.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#filtering-on-right-hand-side.-an-example-with-the-item-metal"><i class="fa fa-check"></i><b>3.1.5.2</b> Filtering on right hand side. An example with the item {METAL}</a></li>
<li class="chapter" data-level="3.1.5.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#filtering-on-left-hand-side.-an-example-with-the-item-metal"><i class="fa fa-check"></i><b>3.1.5.3</b> Filtering on left hand side. An example with the item {METAL}</a></li>
</ul></li>
<li class="chapter" data-level="3.1.6" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#plotting-association-rules"><i class="fa fa-check"></i><b>3.1.6</b> Plotting association rules</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#colaborative-filtering"><i class="fa fa-check"></i><b>3.2</b> Colaborative filtering</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-and-formatting-data"><i class="fa fa-check"></i><b>3.2.1</b> Loading and formatting data</a>
<ul>
<li class="chapter" data-level="3.2.1.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-metadata-that-gets-loaded-with-main-dataset"><i class="fa fa-check"></i><b>3.2.1.1</b> Loading metadata that gets loaded with main dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.2.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#data-exploration"><i class="fa fa-check"></i><b>3.2.2</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="3.2.2.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#plotting-1"><i class="fa fa-check"></i><b>3.2.2.1</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="3.2.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#what-models-can-we-use"><i class="fa fa-check"></i><b>3.2.3</b> What models can we use?</a></li>
<li class="chapter" data-level="3.2.4" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#training-and-test-set"><i class="fa fa-check"></i><b>3.2.4</b> Training and test set</a></li>
<li class="chapter" data-level="3.2.5" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#a-small-example-with-ibcf-item-based"><i class="fa fa-check"></i><b>3.2.5</b> A small example with IBCF (item based)</a></li>
<li class="chapter" data-level="3.2.6" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#ubcf---user-based-collaborative-based"><i class="fa fa-check"></i><b>3.2.6</b> UBCF - User based collaborative based</a>
<ul>
<li class="chapter" data-level="3.2.6.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#fitting-the-model"><i class="fa fa-check"></i><b>3.2.6.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.2.6.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#predicting-making-recommendations"><i class="fa fa-check"></i><b>3.2.6.2</b> Predicting (making) recommendations</a></li>
</ul></li>
<li class="chapter" data-level="3.2.7" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#cross-validation"><i class="fa fa-check"></i><b>3.2.7</b> Cross validation</a></li>
<li class="chapter" data-level="3.2.8" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#ibcf---item-based-collaborative-based"><i class="fa fa-check"></i><b>3.2.8</b> IBCF - Item based collaborative based</a>
<ul>
<li class="chapter" data-level="3.2.8.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#fitting-the-model-using-cv"><i class="fa fa-check"></i><b>3.2.8.1</b> Fitting the model (using CV)</a></li>
<li class="chapter" data-level="3.2.8.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#making-predictions"><i class="fa fa-check"></i><b>3.2.8.2</b> Making predictions</a></li>
<li class="chapter" data-level="3.2.8.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#performance-metrics"><i class="fa fa-check"></i><b>3.2.8.3</b> Performance metrics</a></li>
</ul></li>
<li class="chapter" data-level="3.2.9" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#building-roc-curve-and-precision-recall-rate"><i class="fa fa-check"></i><b>3.2.9</b> Building ROC curve and precision / recall rate</a></li>
<li class="chapter" data-level="3.2.10" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#comparing-ubcf-and-ibcf"><i class="fa fa-check"></i><b>3.2.10</b> Comparing UBCF and IBCF</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#latent-factor-models"><i class="fa fa-check"></i><b>3.3</b> Latent Factor Models</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#fitting-the-model-1"><i class="fa fa-check"></i><b>3.3.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.3.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#making-predictions-1"><i class="fa fa-check"></i><b>3.3.2</b> Making predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html"><i class="fa fa-check"></i><b>4</b> Probabilistic Models for Customer Analytics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#bayesian-networks"><i class="fa fa-check"></i><b>4.1</b> Bayesian Networks</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#why-bayesian"><i class="fa fa-check"></i><b>4.1.1</b> <strong><em>Why Bayesian?</em></strong></a>
<ul>
<li class="chapter" data-level="4.1.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#many-names-for-bayesian-networks"><i class="fa fa-check"></i><b>4.1.1.1</b> <strong>Many names for Bayesian Networks</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#terms-and-explanatory-examples"><i class="fa fa-check"></i><b>4.1.2</b> Terms and explanatory examples</a>
<ul>
<li class="chapter" data-level="4.1.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#types-of-connections"><i class="fa fa-check"></i><b>4.1.2.1</b> Types of connections</a></li>
<li class="chapter" data-level="4.1.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#variable-selection-based-on-a-bayesian-network"><i class="fa fa-check"></i><b>4.1.2.2</b> Variable selection based on a Bayesian Network</a></li>
</ul></li>
<li class="chapter" data-level="4.1.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#independence"><i class="fa fa-check"></i><b>4.1.3</b> Independence</a></li>
<li class="chapter" data-level="4.1.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#methods-for-identifying-the-network"><i class="fa fa-check"></i><b>4.1.4</b> Methods for identifying the network</a>
<ul>
<li class="chapter" data-level="4.1.4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#algorithms-focused-on-causality-discovery"><i class="fa fa-check"></i><b>4.1.4.1</b> 1. <strong><em>Algorithms focused on causality discovery</em></strong></a></li>
<li class="chapter" data-level="4.1.4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#algorithms-focused-on-prediction"><i class="fa fa-check"></i><b>4.1.4.2</b> 2. <strong><em>Algorithms focused on prediction</em></strong></a></li>
</ul></li>
<li class="chapter" data-level="4.1.5" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#real-life-application"><i class="fa fa-check"></i><b>4.1.5</b> <strong>Real life application</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#application-1-explaining-and-predicting-customer-retention-in-a-virtual-community"><i class="fa fa-check"></i><b>4.2</b> Application 1: Explaining and Predicting Customer Retention in a Virtual Community</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#getting-the-structure"><i class="fa fa-check"></i><b>4.2.1</b> 1. Getting the structure</a>
<ul>
<li class="chapter" data-level="4.2.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#a.-building-the-structure-and-parameters-manually"><i class="fa fa-check"></i><b>4.2.1.1</b> A. Building the structure and parameters manually</a>
<ul>
<li class="chapter" data-level="4.2.1.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#approaches-to-make-the-network"><i class="fa fa-check"></i><b>4.2.1.1.1</b> Approaches to make the network</a>
<ul>
<li class="chapter" data-level="4.2.1.1.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#i-first-approach"><i class="fa fa-check"></i><b>4.2.1.1.1.1</b> (i) First approach</a></li>
<li class="chapter" data-level="4.2.1.1.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#ii-second-approach"><i class="fa fa-check"></i><b>4.2.1.1.1.2</b> (ii) Second approach</a></li>
<li class="chapter" data-level="4.2.1.1.1.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#iii-third-approach"><i class="fa fa-check"></i><b>4.2.1.1.1.3</b> (iii) Third approach</a></li>
</ul></li>
<li class="chapter" data-level="4.2.1.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#loadingentering-data"><i class="fa fa-check"></i><b>4.2.1.1.2</b> Loading/entering data</a></li>
<li class="chapter" data-level="4.2.1.1.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#conditional-probability-table-cpt"><i class="fa fa-check"></i><b>4.2.1.1.3</b> Conditional probability table (CPT)</a></li>
</ul></li>
<li class="chapter" data-level="4.2.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#b.-learning-the-structure-and-parameters-from-observational-data"><i class="fa fa-check"></i><b>4.2.1.2</b> B. Learning the structure and parameters from observational data</a>
<ul>
<li class="chapter" data-level="4.2.1.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#grow-shrink-gs---learning-a-structure-using-a-constrained-based-algorithm"><i class="fa fa-check"></i><b>4.2.1.2.1</b> Grow-shrink (gs) - Learning a structure using a constrained-based algorithm</a>
<ul>
<li class="chapter" data-level="4.2.1.2.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#identifying-undirectred-links"><i class="fa fa-check"></i><b>4.2.1.2.1.1</b> Identifying undirectred links</a></li>
</ul></li>
<li class="chapter" data-level="4.2.1.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#hill-climbing-hc---learning-the-structure-using-a-score-based-algorithm"><i class="fa fa-check"></i><b>4.2.1.2.2</b> Hill-Climbing (hc) - Learning the structure using a score-based algorithm</a></li>
<li class="chapter" data-level="4.2.1.2.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#fitting-the-model-to-the-data-learning-the-probabilities"><i class="fa fa-check"></i><b>4.2.1.2.3</b> Fitting the model to the data (learning the probabilities)</a></li>
<li class="chapter" data-level="4.2.1.2.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#alternatives-to-grow-shrink-and-hc"><i class="fa fa-check"></i><b>4.2.1.2.4</b> Alternatives to Grow-Shrink and HC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#model-evaluation-1"><i class="fa fa-check"></i><b>4.2.2</b> 2. Model evaluation</a>
<ul>
<li class="chapter" data-level="4.2.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#i.-metrics-of-model-complexity"><i class="fa fa-check"></i><b>4.2.2.1</b> I. Metrics of model complexity</a></li>
<li class="chapter" data-level="4.2.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#ii.-metrics-of-model-sensitivity"><i class="fa fa-check"></i><b>4.2.2.2</b> II. Metrics of model sensitivity</a></li>
<li class="chapter" data-level="4.2.2.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#iii.-evaluate-the-arc.strength"><i class="fa fa-check"></i><b>4.2.2.3</b> III. Evaluate the arc.strength()</a>
<ul>
<li class="chapter" data-level="4.2.2.3.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#for-the-growth-shrink"><i class="fa fa-check"></i><b>4.2.2.3.1</b> For the growth shrink</a></li>
<li class="chapter" data-level="4.2.2.3.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#for-the-hill-climbing-structure"><i class="fa fa-check"></i><b>4.2.2.3.2</b> For the hill-climbing structure</a></li>
<li class="chapter" data-level="4.2.2.3.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#different-information-criteria-evaluations"><i class="fa fa-check"></i><b>4.2.2.3.3</b> Different information criteria evaluations</a></li>
</ul></li>
<li class="chapter" data-level="4.2.2.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#iv.-metrics-of-predictive-accuracy-error-rate-confusion-matrix-auc"><i class="fa fa-check"></i><b>4.2.2.4</b> IV. Metrics of predictive accuracy (error rate, confusion matrix, AUC)</a>
<ul>
<li class="chapter" data-level="4.2.2.4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#cross-validation-1"><i class="fa fa-check"></i><b>4.2.2.4.1</b> Cross validation</a></li>
<li class="chapter" data-level="4.2.2.4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#alternative-approach-to-fit-and-predict-without-grain"><i class="fa fa-check"></i><b>4.2.2.4.2</b> Alternative approach to fit and predict (Without gRain)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#making-inference-and-queries-based-on-the-model"><i class="fa fa-check"></i><b>4.2.3</b> 3. Making inference and queries based on the model</a>
<ul>
<li class="chapter" data-level="4.2.3.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#diagnostics-forward-inference"><i class="fa fa-check"></i><b>4.2.3.1</b> Diagnostics (Forward inference)</a>
<ul>
<li class="chapter" data-level="4.2.3.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#let-us-repeat-the-same-analysis-by-setting-evidence-in-pleasure"><i class="fa fa-check"></i><b>4.2.3.1.1</b> <em>let us repeat the same analysis by setting evidence in Pleasure</em></a></li>
</ul></li>
<li class="chapter" data-level="4.2.3.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#diagnostic-backward-inference"><i class="fa fa-check"></i><b>4.2.3.2</b> Diagnostic (Backward inference)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#application-2-identifying-populations-with-positive-expected-lift-in-profit-elp-and-targeting"><i class="fa fa-check"></i><b>4.3</b> Application 2: Identifying populations with Positive Expected Lift in Profit (ELP) and targeting</a></li>
<li class="chapter" data-level="4.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#application-3-product-recommendation-using-probabilistic-models-bn"><i class="fa fa-check"></i><b>4.4</b> Application 3: Product Recommendation using Probabilistic Models (BN)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#method-1-learn-the-probabilistic-relationships-using-a-bayesian-network-learning"><i class="fa fa-check"></i><b>4.4.1</b> Method 1: Learn the probabilistic relationships using a Bayesian network learning</a></li>
<li class="chapter" data-level="4.4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#method-2-finding-latent-segments"><i class="fa fa-check"></i><b>4.4.2</b> Method 2: Finding latent segments</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#latent-models-for-cross-selling-and-acquisition-sequence"><i class="fa fa-check"></i><b>4.5</b> Latent models for cross selling and acquisition sequence</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#latent-trait-model---applying-the-ltm-package-in-r"><i class="fa fa-check"></i><b>4.5.1</b> Latent Trait Model - Applying the LTM Package in R</a></li>
<li class="chapter" data-level="4.5.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#the-latent-hidden-markov-model"><i class="fa fa-check"></i><b>4.5.2</b> The latent (hidden) Markov model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="customer-behavior.html"><a href="customer-behavior.html"><i class="fa fa-check"></i><b>5</b> Customer behavior</a>
<ul>
<li class="chapter" data-level="5.1" data-path="customer-behavior.html"><a href="customer-behavior.html#characteristics-of-cliskstream"><i class="fa fa-check"></i><b>5.1</b> Characteristics of cliskstream</a></li>
<li class="chapter" data-level="5.2" data-path="customer-behavior.html"><a href="customer-behavior.html#applications-with-clickstream-data"><i class="fa fa-check"></i><b>5.2</b> Applications with clickstream data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="customer-behavior.html"><a href="customer-behavior.html#a-motivating-example"><i class="fa fa-check"></i><b>5.2.1</b> A motivating example</a>
<ul>
<li class="chapter" data-level="5.2.1.1" data-path="customer-behavior.html"><a href="customer-behavior.html#i-predict-either-the-next-click-or-the-ï¬nal-click-state-of-a-customer."><i class="fa fa-check"></i><b>5.2.1.1</b> i) Predict either the next click or the ï¬nal click (state) of a customer.</a></li>
<li class="chapter" data-level="5.2.1.2" data-path="customer-behavior.html"><a href="customer-behavior.html#ii-clustering-and-generalizing-upon-clickstreams"><i class="fa fa-check"></i><b>5.2.1.2</b> ii) Clustering and generalizing upon clickstreams</a></li>
</ul></li>
<li class="chapter" data-level="5.2.2" data-path="customer-behavior.html"><a href="customer-behavior.html#second-exercise-clickstream-more-extensive"><i class="fa fa-check"></i><b>5.2.2</b> Second exercise (clickstream) more extensive</a></li>
<li class="chapter" data-level="5.2.3" data-path="customer-behavior.html"><a href="customer-behavior.html#a-concrete-eaxmple-with-real-data"><i class="fa fa-check"></i><b>5.2.3</b> A concrete eaxmple with real data</a>
<ul>
<li class="chapter" data-level="5.2.3.1" data-path="customer-behavior.html"><a href="customer-behavior.html#markov-chain"><i class="fa fa-check"></i><b>5.2.3.1</b> (1) Markov Chain</a></li>
<li class="chapter" data-level="5.2.3.2" data-path="customer-behavior.html"><a href="customer-behavior.html#using-association-rule-mining"><i class="fa fa-check"></i><b>5.2.3.2</b> (2) Using association rule mining</a></li>
<li class="chapter" data-level="5.2.3.3" data-path="customer-behavior.html"><a href="customer-behavior.html#use-frequencies-instead-of-the-sequence"><i class="fa fa-check"></i><b>5.2.3.3</b> (3) Use frequencies instead of the sequence</a></li>
<li class="chapter" data-level="5.2.3.4" data-path="customer-behavior.html"><a href="customer-behavior.html#neural-networks"><i class="fa fa-check"></i><b>5.2.3.4</b> (4) Neural networks</a></li>
</ul></li>
<li class="chapter" data-level="5.2.4" data-path="customer-behavior.html"><a href="customer-behavior.html#optional-exercise"><i class="fa fa-check"></i><b>5.2.4</b> Optional exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="customer-behavior.html"><a href="customer-behavior.html#ab-testing"><i class="fa fa-check"></i><b>5.3</b> AB Testing</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="customer-behavior.html"><a href="customer-behavior.html#what-is-it-and-when-to-apply-it"><i class="fa fa-check"></i><b>5.3.1</b> (1 + 2): What is it and when to apply it</a></li>
<li class="chapter" data-level="5.3.2" data-path="customer-behavior.html"><a href="customer-behavior.html#how-to-perform-an-ab-test"><i class="fa fa-check"></i><b>5.3.2</b> (3): How to perform an A/B test</a></li>
<li class="chapter" data-level="5.3.3" data-path="customer-behavior.html"><a href="customer-behavior.html#pitfalls-and-challenges."><i class="fa fa-check"></i><b>5.3.3</b> (4): Pitfalls and challenges.</a></li>
<li class="chapter" data-level="5.3.4" data-path="customer-behavior.html"><a href="customer-behavior.html#ab-tests-and-bandits."><i class="fa fa-check"></i><b>5.3.4</b> (5): A/B tests and bandits.</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Customer Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="recommender-systems-and-customer-targeting" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Recommender Systems and Customer Targeting</h1>
<p>This group of lectures cover three different approaches to mining associations.</p>
<ol style="list-style-type: decimal">
<li>Association rules</li>
<li>Collaborative filtering</li>
<li>Latent factor models</li>
</ol>
<p><strong><em>Association rules</em></strong></p>
<p>We see that association rules looks at transactions and assess what products there appear to be on the same transaction, and thus creates association rules based on these.</p>
<p>With these rules you can start making recommendations or generate ideas of what products should be marketed together. For instance one of the fun examples is where you see that beers and diapers often comes together. When you think about it, it is very logical, because people with small kids cant go out, but they might still enjoy a beer, thus they have to do it at home.</p>
<p><strong><em>Collaborative filtering</em></strong></p>
<p>Then we have collaborative filtering. Here we will work on two different approaches, item-based and user-based.</p>
<ul>
<li><p>User-based: we want to predict one users ratings of a given product/service based on similarity with other users.</p></li>
<li><p>item-based: we want to predict one users ratings of a given product/service based on its similarity with other products, e.g., if one consistenly rate thai food high, then he may also like other thai food, this is in principle also what I have explored with the recommender system on the DSP.</p></li>
</ul>
<p>This is very much used for making recommender system. This was also very much applied in the Netflix competition.</p>
<p>With this, we have the term cold start, that is when you have a new user, you must make some recommendations before you can use the contents, e.g., what you are doing at Netflix, so it starts knowing your preferences.</p>
<p><strong><em>Latent factor models</em></strong></p>
<p>The last approach is the latent factor model, this is just an extension of the user-based and item-based, where both scenarios are considered. This method assumes that we make some constructs, e.g., as in SEM, where the constructs are explained by different items (movies). Then it would be obvious to make constructs based on different genres. These constructs are not directly observable, hence the name latent.</p>
<p>Within LFM cold start also applies.</p>
<p>In general we see that this model gives the best predictions. That is also due to the possibility of regularizing user ratings, hence accounting for user specific biases.</p>
<p>Notice that in the very end of this chapter a comparison between IBCF, UBCF, latent factor models and latent factor models accounting for user bias is shown.</p>
<div id="association-rule" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Association rule</h2>
<p>Basically the method looks at what products that appear in the same transaction and the finds pairs, or items that come together.</p>
<p>Terms:</p>
<ul>
<li>Items: these are the different products that can be bought, can also be a product group</li>
<li>Itemset: this is the dataset containing a list of all of the items</li>
<li>Syntatic Constrains: constraints involving restrictions on items that can appear in a rule. E.g., one may say, that we only want to evaluate one item (product) or an itemrange.</li>
<li>Support Constraints: constraints the number of transactions in T that support a rule. Notice that in R there are default values for this.</li>
<li>Minsupport: This is the threshold assigned to item pairs, used in procedure 1.
+ Large itemssets: Item combinations that meets the minsupport. This is denoted with I1,I2,â¦Ik.
+ Small itemssets: Item combinations that does not meet the minsupport</li>
</ul>
<p>Procedure:</p>
<pre><code>1. Generate all combinations of items that have fractional transactinos support. Perhaps above a certain threshold.
    a. We group all combinations in two groups:
        i. Large itemsets. Examples: 1) Diaper and beer, 2) Milk, Bread --&gt; Eggs, Coke.
        ii. Small itemsets.
        </code></pre>
<p>For a large itemset generate all rules, that use items from the large itemsets (I1,I2,â¦Ik). We call all of these rules subsets (X) of Y.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="recommender-systems-and-customer-targeting.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.datacamp.com/community/tutorials/market-basket-analysis-r</span></span>
<span id="cb391-2"><a href="recommender-systems-and-customer-targeting.html#cb391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-3"><a href="recommender-systems-and-customer-targeting.html#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install and load package arules</span></span>
<span id="cb391-4"><a href="recommender-systems-and-customer-targeting.html#cb391-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arules)</span>
<span id="cb391-5"><a href="recommender-systems-and-customer-targeting.html#cb391-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arulesViz)</span>
<span id="cb391-6"><a href="recommender-systems-and-customer-targeting.html#cb391-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb391-7"><a href="recommender-systems-and-customer-targeting.html#cb391-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb391-8"><a href="recommender-systems-and-customer-targeting.html#cb391-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb391-9"><a href="recommender-systems-and-customer-targeting.html#cb391-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb391-10"><a href="recommender-systems-and-customer-targeting.html#cb391-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb391-11"><a href="recommender-systems-and-customer-targeting.html#cb391-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb391-12"><a href="recommender-systems-and-customer-targeting.html#cb391-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb391-13"><a href="recommender-systems-and-customer-targeting.html#cb391-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span></code></pre></div>
<div id="loading-and-data-exploration" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Loading and data exploration</h3>
<p>First we load it</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="recommender-systems-and-customer-targeting.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read excel into R dataframe</span></span>
<span id="cb392-2"><a href="recommender-systems-and-customer-targeting.html#cb392-2" aria-hidden="true" tabindex="-1"></a>retail <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&#39;Data/Recommender Systems/Online_Retail.xlsx&#39;</span>)</span>
<span id="cb392-3"><a href="recommender-systems-and-customer-targeting.html#cb392-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(retail)</span></code></pre></div>
<p>The data frame has rows with granularity of items, hence one item pr. line. Where one invoice may occur several times.</p>
<p>We also have some other information. notice that stock code is an ID for the product.</p>
<p>We see that some have some odd quantities, these are just plotted to see what is going on.</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="recommender-systems-and-customer-targeting.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Quantity[StockCode <span class="sc">==</span> <span class="dv">23843</span>])</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/QuantityAssessment-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="recommender-systems-and-customer-targeting.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Quantity[StockCode <span class="sc">==</span> <span class="dv">23166</span>])</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/QuantityAssessment-2.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="data-preprocessing" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Data preprocessing</h3>
<p>complete.cases(data) will return a logical vector indicating which rows have no missing values. Then use the vector to get only rows that are complete using retail[,]. That is because we have NAâs.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="recommender-systems-and-customer-targeting.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(retail)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/PlotMissing%20Retail-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the customer ID is only there 75% of the time, also the description appear to be missing in some examples. Now we are going to remove these.</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="recommender-systems-and-customer-targeting.html#cb396-1" aria-hidden="true" tabindex="-1"></a>retail <span class="ot">&lt;-</span> retail[<span class="fu">complete.cases</span>(retail), ]</span>
<span id="cb396-2"><a href="recommender-systems-and-customer-targeting.html#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(retail)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-170-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we see that we remove approx. 140.000 observations, where we had 541.909 observations before and 406.829 observations after removing NAâs, corresponding with approx. 25% of the observations.</p>
<div id="encoding-to-correct-data-types" class="section level4" number="3.1.2.1">
<h4><span class="header-section-number">3.1.2.1</span> Encoding to correct data types</h4>
<p>Now we want to make the description a factor instead of character.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="recommender-systems-and-customer-targeting.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The following prints whole tables, although I just show the first couple of rows in a following chunk</span></span>
<span id="cb397-2"><a href="recommender-systems-and-customer-targeting.html#cb397-2" aria-hidden="true" tabindex="-1"></a>retail <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Description =</span> <span class="fu">as.factor</span>(Description))</span>
<span id="cb397-3"><a href="recommender-systems-and-customer-targeting.html#cb397-3" aria-hidden="true" tabindex="-1"></a>retail <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Country =</span> <span class="fu">as.factor</span>(Country))</span></code></pre></div>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="recommender-systems-and-customer-targeting.html#cb398-1" aria-hidden="true" tabindex="-1"></a>retail<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(retail<span class="sc">$</span>InvoiceDate)</span></code></pre></div>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="recommender-systems-and-customer-targeting.html#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(retail)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="27%" />
<col width="6%" />
<col width="15%" />
<col width="7%" />
<col width="8%" />
<col width="11%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">InvoiceNo</th>
<th align="left">StockCode</th>
<th align="left">Description</th>
<th align="right">Quantity</th>
<th align="left">InvoiceDate</th>
<th align="right">UnitPrice</th>
<th align="right">CustomerID</th>
<th align="left">Country</th>
<th align="left">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">536365</td>
<td align="left">85123A</td>
<td align="left">WHITE HANGING HEART T-LIGHT HOLDER</td>
<td align="right">6</td>
<td align="left">2010-12-01 08:26:00</td>
<td align="right">2.55</td>
<td align="right">17850</td>
<td align="left">United Kingdom</td>
<td align="left">2010-12-01</td>
</tr>
<tr class="even">
<td align="left">536365</td>
<td align="left">71053</td>
<td align="left">WHITE METAL LANTERN</td>
<td align="right">6</td>
<td align="left">2010-12-01 08:26:00</td>
<td align="right">3.39</td>
<td align="right">17850</td>
<td align="left">United Kingdom</td>
<td align="left">2010-12-01</td>
</tr>
<tr class="odd">
<td align="left">536365</td>
<td align="left">84406B</td>
<td align="left">CREAM CUPID HEARTS COAT HANGER</td>
<td align="right">8</td>
<td align="left">2010-12-01 08:26:00</td>
<td align="right">2.75</td>
<td align="right">17850</td>
<td align="left">United Kingdom</td>
<td align="left">2010-12-01</td>
</tr>
<tr class="even">
<td align="left">536365</td>
<td align="left">84029G</td>
<td align="left">KNITTED UNION FLAG HOT WATER BOTTLE</td>
<td align="right">6</td>
<td align="left">2010-12-01 08:26:00</td>
<td align="right">3.39</td>
<td align="right">17850</td>
<td align="left">United Kingdom</td>
<td align="left">2010-12-01</td>
</tr>
<tr class="odd">
<td align="left">536365</td>
<td align="left">84029E</td>
<td align="left">RED WOOLLY HOTTIE WHITE HEART.</td>
<td align="right">6</td>
<td align="left">2010-12-01 08:26:00</td>
<td align="right">3.39</td>
<td align="right">17850</td>
<td align="left">United Kingdom</td>
<td align="left">2010-12-01</td>
</tr>
<tr class="even">
<td align="left">536365</td>
<td align="left">22752</td>
<td align="left">SET 7 BABUSHKA NESTING BOXES</td>
<td align="right">2</td>
<td align="left">2010-12-01 08:26:00</td>
<td align="right">7.65</td>
<td align="right">17850</td>
<td align="left">United Kingdom</td>
<td align="left">2010-12-01</td>
</tr>
</tbody>
</table>
</div>
<p>We also want a column with the date and one with the transaction time.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="recommender-systems-and-customer-targeting.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract time from InvoiceDate and store in another variable</span></span>
<span id="cb400-2"><a href="recommender-systems-and-customer-targeting.html#cb400-2" aria-hidden="true" tabindex="-1"></a>TransTime <span class="ot">&lt;-</span> <span class="fu">format</span>(retail<span class="sc">$</span>InvoiceDate,<span class="st">&quot;%H:%M:%S&quot;</span>)</span>
<span id="cb400-3"><a href="recommender-systems-and-customer-targeting.html#cb400-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert and edit InvoiceNo into numeric</span></span>
<span id="cb400-4"><a href="recommender-systems-and-customer-targeting.html#cb400-4" aria-hidden="true" tabindex="-1"></a>InvoiceNo <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(retail<span class="sc">$</span>InvoiceNo))</span>
<span id="cb400-5"><a href="recommender-systems-and-customer-targeting.html#cb400-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-6"><a href="recommender-systems-and-customer-targeting.html#cb400-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Bind new columns TransTime and InvoiceNo into dataframe retail</span></span>
<span id="cb400-7"><a href="recommender-systems-and-customer-targeting.html#cb400-7" aria-hidden="true" tabindex="-1"></a>retail <span class="ot">&lt;-</span> <span class="fu">cbind</span>(retail,TransTime)</span></code></pre></div>
<p>Now we can glimpse</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="recommender-systems-and-customer-targeting.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(retail)</span></code></pre></div>
<pre><code>## Rows: 406,829
## Columns: 10
## $ InvoiceNo   &lt;chr&gt; &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;, &quot;536365&quot;â¦
## $ StockCode   &lt;chr&gt; &quot;85123A&quot;, &quot;71053&quot;, &quot;84406B&quot;, &quot;84029G&quot;, &quot;84029E&quot;, &quot;22752&quot;, â¦
## $ Description &lt;chr&gt; &quot;WHITE HANGING HEART T-LIGHT HOLDER&quot;, &quot;WHITE METAL LANTERNâ¦
## $ Quantity    &lt;dbl&gt; 6, 6, 8, 6, 6, 2, 6, 6, 6, 32, 6, 6, 8, 6, 6, 3, 2, 3, 3, â¦
## $ InvoiceDate &lt;dttm&gt; 2010-12-01 08:26:00, 2010-12-01 08:26:00, 2010-12-01 08:2â¦
## $ UnitPrice   &lt;dbl&gt; 2.55, 3.39, 2.75, 3.39, 3.39, 7.65, 4.25, 1.85, 1.85, 1.69â¦
## $ CustomerID  &lt;dbl&gt; 17850, 17850, 17850, 17850, 17850, 17850, 17850, 17850, 17â¦
## $ Country     &lt;chr&gt; &quot;United Kingdom&quot;, &quot;United Kingdom&quot;, &quot;United Kingdom&quot;, &quot;Uniâ¦
## $ Date        &lt;date&gt; 2010-12-01, 2010-12-01, 2010-12-01, 2010-12-01, 2010-12-0â¦
## $ TransTime   &lt;chr&gt; &quot;08:26:00&quot;, &quot;08:26:00&quot;, &quot;08:26:00&quot;, &quot;08:26:00&quot;, &quot;08:26:00&quot;â¦</code></pre>
</div>
<div id="create-a-data-frame-with-one-row-pr.-invoice" class="section level4" number="3.1.2.2">
<h4><span class="header-section-number">3.1.2.2</span> Create a data frame with one row pr. invoice</h4>
<p>What you need to do is group data in the retail dataframe either by CustomerID, CustomerID, and Date or you can also group data using InvoiceNo and Date. We need this grouping and apply a function on it and store the output in another dataframe.</p>
<p>This can be done by ddply.</p>
<p>The following lines of code will combine all products from one InvoiceNo and date and combine all products from that InvoiceNo and date as one row, with each item, separated by â,â.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="recommender-systems-and-customer-targeting.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb403-2"><a href="recommender-systems-and-customer-targeting.html#cb403-2" aria-hidden="true" tabindex="-1"></a>transactionData <span class="ot">&lt;-</span> <span class="fu">ddply</span>(<span class="at">.data =</span> retail</span>
<span id="cb403-3"><a href="recommender-systems-and-customer-targeting.html#cb403-3" aria-hidden="true" tabindex="-1"></a>                         ,<span class="at">.variables =</span> <span class="fu">c</span>(<span class="st">&quot;InvoiceNo&quot;</span>,<span class="st">&quot;Date&quot;</span>) <span class="co">#Group by</span></span>
<span id="cb403-4"><a href="recommender-systems-and-customer-targeting.html#cb403-4" aria-hidden="true" tabindex="-1"></a>                         ,<span class="at">.fun =</span> <span class="cf">function</span>(df1)<span class="fu">paste</span>(df1<span class="sc">$</span>Description <span class="co">#This concatenates the items</span></span>
<span id="cb403-5"><a href="recommender-systems-and-customer-targeting.html#cb403-5" aria-hidden="true" tabindex="-1"></a>                                                    ,<span class="at">collapse =</span> <span class="st">&quot;,&quot;</span>))</span>
<span id="cb403-6"><a href="recommender-systems-and-customer-targeting.html#cb403-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(transactionData)</span></code></pre></div>
<div class="kable-table">
<table>
<colgroup>
<col width="1%" />
<col width="2%" />
<col width="96%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">InvoiceNo</th>
<th align="left">Date</th>
<th align="left">V1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">536365</td>
<td align="left">2010-12-01</td>
<td align="left">WHITE HANGING HEART T-LIGHT HOLDER,WHITE METAL LANTERN,CREAM CUPID HEARTS COAT HANGER,KNITTED UNION FLAG HOT WATER BOTTLE,RED WOOLLY HOTTIE WHITE HEART.,SET 7 BABUSHKA NESTING BOXES,GLASS STAR FROSTED T-LIGHT HOLDER</td>
</tr>
<tr class="even">
<td align="left">536366</td>
<td align="left">2010-12-01</td>
<td align="left">HAND WARMER UNION JACK,HAND WARMER RED POLKA DOT</td>
</tr>
<tr class="odd">
<td align="left">536367</td>
<td align="left">2010-12-01</td>
<td align="left">ASSORTED COLOUR BIRD ORNAMENT,POPPYâS PLAYHOUSE BEDROOM,POPPYâS PLAYHOUSE KITCHEN,FELTCRAFT PRINCESS CHARLOTTE DOLL,IVORY KNITTED MUG COSY,BOX OF 6 ASSORTED COLOUR TEASPOONS,BOX OF VINTAGE JIGSAW BLOCKS,BOX OF VINTAGE ALPHABET BLOCKS,HOME BUILDING BLOCK WORD,LOVE BUILDING BLOCK WORD,RECIPE BOX WITH METAL HEART,DOORMAT NEW ENGLAND</td>
</tr>
<tr class="even">
<td align="left">536368</td>
<td align="left">2010-12-01</td>
<td align="left">JAM MAKING SET WITH JARS,RED COAT RACK PARIS FASHION,YELLOW COAT RACK PARIS FASHION,BLUE COAT RACK PARIS FASHION</td>
</tr>
<tr class="odd">
<td align="left">536369</td>
<td align="left">2010-12-01</td>
<td align="left">BATH BUILDING BLOCK WORD</td>
</tr>
<tr class="even">
<td align="left">536370</td>
<td align="left">2010-12-01</td>
<td align="left">ALARM CLOCK BAKELIKE PINK,ALARM CLOCK BAKELIKE RED,ALARM CLOCK BAKELIKE GREEN,PANDA AND BUNNIES STICKER SHEET,STARS GIFT TAPE,INFLATABLE POLITICAL GLOBE,VINTAGE HEADS AND TAILS CARD GAME,SET/2 RED RETROSPOT TEA TOWELS,ROUND SNACK BOXES SET OF4 WOODLAND,SPACEBOY LUNCH BOX,LUNCH BOX I LOVE LONDON,CIRCUS PARADE LUNCH BOX,CHARLOTTE BAG DOLLY GIRL DESIGN,RED TOADSTOOL LED NIGHT LIGHT,SET 2 TEA TOWELS I LOVE LONDON,VINTAGE SEASIDE JIGSAW PUZZLES,MINI JIGSAW CIRCUS PARADE,MINI JIGSAW SPACEBOY,MINI PAINT SET VINTAGE,POSTAGE</td>
</tr>
</tbody>
</table>
</div>
<p>So we see that now we have granularity on invoiceNo, and the the date and lastly the items are listed, where they are separated with a comma.</p>
<p>Now we only want the items pr. invoice (basket), hence we remove the invoice InvoiceNo and Date.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="recommender-systems-and-customer-targeting.html#cb404-1" aria-hidden="true" tabindex="-1"></a>transactionData <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(transactionData<span class="sc">$</span>V1)</span>
<span id="cb404-2"><a href="recommender-systems-and-customer-targeting.html#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(transactionData) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;items&quot;</span>) <span class="co">#Rename column to items</span></span>
<span id="cb404-3"><a href="recommender-systems-and-customer-targeting.html#cb404-3" aria-hidden="true" tabindex="-1"></a>transactionData[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>## [1] &quot;WHITE HANGING HEART T-LIGHT HOLDER,WHITE METAL LANTERN,CREAM CUPID HEARTS COAT HANGER,KNITTED UNION FLAG HOT WATER BOTTLE,RED WOOLLY HOTTIE WHITE HEART.,SET 7 BABUSHKA NESTING BOXES,GLASS STAR FROSTED T-LIGHT HOLDER&quot;</code></pre>
<p>We see that the dataframe now consists of only on column with all items separated with a comma. Now we are going to save it, and load it back into the environment.</p>
<p><strong>Saving the data</strong></p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="recommender-systems-and-customer-targeting.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(transactionData,<span class="st">&quot;Data/Recommender Systems/market_basket_transactions.csv&quot;</span>, <span class="at">quote =</span> <span class="cn">FALSE</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="loading-transactions" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Loading transactions</h3>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="recommender-systems-and-customer-targeting.html#cb407-1" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">&lt;-</span> <span class="fu">read.transactions</span>(<span class="st">&#39;market_basket_transactions.csv&#39;</span>, <span class="at">format =</span> <span class="st">&#39;basket&#39;</span>, <span class="at">sep=</span><span class="st">&#39;,&#39;</span>)</span>
<span id="cb407-2"><a href="recommender-systems-and-customer-targeting.html#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tr)</span></code></pre></div>
<pre><code>## transactions as itemMatrix in sparse format with
##  22191 rows (elements/itemsets/transactions) and
##  7876 columns (items) and a density of 0.001930725 
## 
## most frequent items:
## WHITE HANGING HEART T-LIGHT HOLDER           REGENCY CAKESTAND 3 TIER 
##                               1803                               1709 
##            JUMBO BAG RED RETROSPOT                      PARTY BUNTING 
##                               1460                               1285 
##      ASSORTED COLOUR BIRD ORNAMENT                            (Other) 
##                               1250                             329938 
## 
## element (itemset/transaction) length distribution:
## sizes
##    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 
## 3598 1594 1141  908  861  758  696  676  663  593  624  537  516  531  551  522 
##   17   18   19   20   21   22   23   24   25   26   27   28   29   30   31   32 
##  464  441  483  419  395  315  306  272  238  253  229  213  222  215  170  159 
##   33   34   35   36   37   38   39   40   41   42   43   44   45   46   47   48 
##  138  142  134  109  111   90  113   94   93   87   88   65   63   67   63   60 
##   49   50   51   52   53   54   55   56   57   58   59   60   61   62   63   64 
##   59   49   64   40   41   49   43   36   29   39   30   27   28   17   25   25 
##   65   66   67   68   69   70   71   72   73   74   75   76   77   78   79   80 
##   20   27   24   22   15   20   19   13   16   16   11   15   12    7    9   14 
##   81   82   83   84   85   86   87   88   89   90   91   92   93   94   95   96 
##   15   12    8    9   11   11   14    8    6    5    6   11    6    4    4    3 
##   97   98   99  100  101  102  103  104  105  106  107  108  109  110  111  112 
##    6    5    2    4    2    4    4    3    2    2    6    3    4    3    2    1 
##  113  114  116  117  118  120  121  122  123  125  126  127  131  132  133  134 
##    3    1    3    3    3    1    2    2    1    3    2    2    1    1    2    1 
##  140  141  142  143  145  146  147  150  154  157  168  171  177  178  180  202 
##    1    2    2    1    1    2    1    1    3    2    2    2    1    1    1    1 
##  204  228  236  249  250  285  320  400  419 
##    1    1    1    1    1    1    1    1    1 
## 
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    3.00   10.00   15.21   21.00  419.00 
## 
## includes extended item information - examples:
##                       labels
## 1                   1 HANGER
## 2     10 COLOUR SPACEBOY PEN
## 3 12 COLOURED PARTY BALLOONS</code></pre>
<p>We see that when we load it back into the environment using <code>read.transactions()</code> we create something similar to a data term matrix, this is merely a sparse matrix, where we see that we have 7.876 items and 22.191 baskets/invoices. Hence each row is just âticked-offâ if the basket contains the product.</p>
<p>We see the summary specify that we have 22.191 transactions and 7.876 items, the most frequent is âwhite hanging heeart t-light holderâ. We see that the largest basket has 419 units. Where basket sizes of 1 unit is the most typical.</p>
<p>Then the mean = 15 products and the median 10 products.</p>
</div>
<div id="plotting" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Plotting</h3>
<p>Now we want to plot the most frequent products.</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="recommender-systems-and-customer-targeting.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an item frequency plot for the top 20 items</span></span>
<span id="cb409-2"><a href="recommender-systems-and-customer-targeting.html#cb409-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb409-3"><a href="recommender-systems-and-customer-targeting.html#cb409-3" aria-hidden="true" tabindex="-1"></a><span class="fu">itemFrequencyPlot</span>(tr</span>
<span id="cb409-4"><a href="recommender-systems-and-customer-targeting.html#cb409-4" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">topN =</span> <span class="dv">20</span></span>
<span id="cb409-5"><a href="recommender-systems-and-customer-targeting.html#cb409-5" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">type =</span> <span class="st">&quot;absolute&quot;</span></span>
<span id="cb409-6"><a href="recommender-systems-and-customer-targeting.html#cb409-6" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">col =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&#39;Pastel2&#39;</span>)</span>
<span id="cb409-7"><a href="recommender-systems-and-customer-targeting.html#cb409-7" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">main =</span> <span class="st">&quot;Absolute Item Frequency Plot&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-180-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that top combinations. E.g., more than 1.500 baskets where the top combination occurs. Now we can look at it in a relative way instead.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="recommender-systems-and-customer-targeting.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">itemFrequencyPlot</span>(tr</span>
<span id="cb410-2"><a href="recommender-systems-and-customer-targeting.html#cb410-2" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">topN =</span> <span class="dv">20</span></span>
<span id="cb410-3"><a href="recommender-systems-and-customer-targeting.html#cb410-3" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">type =</span> <span class="st">&quot;relative&quot;</span></span>
<span id="cb410-4"><a href="recommender-systems-and-customer-targeting.html#cb410-4" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">col =</span> <span class="fu">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&#39;Pastel2&#39;</span>)</span>
<span id="cb410-5"><a href="recommender-systems-and-customer-targeting.html#cb410-5" aria-hidden="true" tabindex="-1"></a>                  ,<span class="at">main =</span> <span class="st">&quot;Relative Item Frequency Plot&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-181-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>This is basically the same, just written in percentage.</p>
</div>
<div id="apriori-calculation" class="section level3" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> Apriori calculation</h3>
<p>We will now start looking at association rules. To do so, we apply the apriori principle.</p>
<p>We set the following:</p>
<ul>
<li>supp = minimum support, where we see that the combinations must occur in at least 0.1% of the baskets</li>
<li>conf = the describes the conditional relationship between the left-hand and right-hand side. Hence we want a relationship that is greater than 80%, as we want to avoid random pairs.</li>
<li>maxlen = the maximum length of items in a basket.</li>
</ul>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="recommender-systems-and-customer-targeting.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Min Support as 0.001, confidence as 0.8.</span></span>
<span id="cb411-2"><a href="recommender-systems-and-customer-targeting.html#cb411-2" aria-hidden="true" tabindex="-1"></a>association.rules <span class="ot">&lt;-</span> <span class="fu">apriori</span>(<span class="at">data =</span> tr</span>
<span id="cb411-3"><a href="recommender-systems-and-customer-targeting.html#cb411-3" aria-hidden="true" tabindex="-1"></a>                             ,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">supp =</span> <span class="fl">0.001</span> <span class="co">#we only see rules where the support is at least 0.001</span></span>
<span id="cb411-4"><a href="recommender-systems-and-customer-targeting.html#cb411-4" aria-hidden="true" tabindex="-1"></a>                                               ,<span class="at">conf =</span> <span class="fl">0.8</span> <span class="co">#The confidence should be at least 0.8</span></span>
<span id="cb411-5"><a href="recommender-systems-and-customer-targeting.html#cb411-5" aria-hidden="true" tabindex="-1"></a>                                               ,<span class="at">maxlen =</span> <span class="dv">10</span> <span class="co">#We only want ot look at a max length of 10 items pr. basket</span></span>
<span id="cb411-6"><a href="recommender-systems-and-customer-targeting.html#cb411-6" aria-hidden="true" tabindex="-1"></a>                                               )</span>
<span id="cb411-7"><a href="recommender-systems-and-customer-targeting.html#cb411-7" aria-hidden="true" tabindex="-1"></a>                             )</span></code></pre></div>
<pre><code>## Apriori
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport maxtime support minlen
##         0.8    0.1    1 none FALSE            TRUE       5   0.001      1
##  maxlen target  ext
##      10  rules TRUE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## Absolute minimum support count: 22 
## 
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[7876 item(s), 22191 transaction(s)] done [0.10s].
## sorting and recoding items ... [2324 item(s)] done [0.01s].
## creating transaction tree ... done [0.01s].
## checking subsets of size 1 2 3 4 5 6 7 8 9 10 done [0.26s].
## writing ... [49122 rule(s)] done [0.04s].
## creating S4 object  ... done [0.03s].</code></pre>
<p><em>The parameters can be seen as constraints, to lower the amount of rules that we are going to make</em></p>
<p>Extra note on support. We only want to see combinations that occurs 1 out of 1000 times, hence <code>supp = 0.001</code></p>
<p>Now we have calculated association rules lets call the summary.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="recommender-systems-and-customer-targeting.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(association.rules)</span></code></pre></div>
<pre><code>## set of 49122 rules
## 
## rule length distribution (lhs + rhs):sizes
##     2     3     4     5     6     7     8     9    10 
##   105  2111  6854 16424 14855  6102  1937   613   121 
## 
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.000   5.000   5.000   5.499   6.000  10.000 
## 
## summary of quality measures:
##     support           confidence        coverage             lift        
##  Min.   :0.001036   Min.   :0.8000   Min.   :0.001036   Min.   :  9.846  
##  1st Qu.:0.001082   1st Qu.:0.8333   1st Qu.:0.001262   1st Qu.: 22.237  
##  Median :0.001262   Median :0.8788   Median :0.001442   Median : 28.760  
##  Mean   :0.001417   Mean   :0.8849   Mean   :0.001609   Mean   : 64.589  
##  3rd Qu.:0.001532   3rd Qu.:0.9259   3rd Qu.:0.001712   3rd Qu.: 69.200  
##  Max.   :0.015997   Max.   :1.0000   Max.   :0.019107   Max.   :715.839  
##      count       
##  Min.   : 23.00  
##  1st Qu.: 24.00  
##  Median : 28.00  
##  Mean   : 31.45  
##  3rd Qu.: 34.00  
##  Max.   :355.00  
## 
## mining info:
##  data ntransactions support confidence
##    tr         22191   0.001        0.8</code></pre>
<p>We see some basic descriptions, e.g., we have the most combinations around 5 and 6. We see that the lower end and upper end has very few. My guess would be that for a basket combination of 10 to not be random, there are only few things that are naturally there.</p>
<p>In the other end (e.g., with length of 2), then there are many products that comes in pairs, but it is also influenced by a lot of randomness. Hence we are ruling out a lot of combinations with the confidence = 80%, if we were to decrease the confidence, then we could have found more association rules.</p>
<p>Now we can <strong>inspect the first 10 combinations</strong></p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="recommender-systems-and-customer-targeting.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(association.rules[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span></code></pre></div>
<pre><code>##      lhs                            rhs                                support confidence    coverage     lift count
## [1]  {WOBBLY CHICKEN}            =&gt; {DECORATION}                   0.001261773  1.0000000 0.001261773 443.8200    28
## [2]  {WOBBLY CHICKEN}            =&gt; {METAL}                        0.001261773  1.0000000 0.001261773 443.8200    28
## [3]  {DECOUPAGE}                 =&gt; {GREETING CARD}                0.001036456  1.0000000 0.001036456 389.3158    23
## [4]  {BILLBOARD FONTS DESIGN}    =&gt; {WRAP}                         0.001306836  1.0000000 0.001306836 715.8387    29
## [5]  {WRAP}                      =&gt; {BILLBOARD FONTS DESIGN}       0.001306836  0.9354839 0.001396963 715.8387    29
## [6]  {ENAMEL PINK TEA CONTAINER} =&gt; {ENAMEL PINK COFFEE CONTAINER} 0.001396963  0.8157895 0.001712406 385.1741    31
## [7]  {WOBBLY RABBIT}             =&gt; {DECORATION}                   0.001532153  1.0000000 0.001532153 443.8200    34
## [8]  {WOBBLY RABBIT}             =&gt; {METAL}                        0.001532153  1.0000000 0.001532153 443.8200    34
## [9]  {ART LIGHTS}                =&gt; {FUNK MONKEY}                  0.001712406  1.0000000 0.001712406 583.9737    38
## [10] {FUNK MONKEY}               =&gt; {ART LIGHTS}                   0.001712406  1.0000000 0.001712406 583.9737    38</code></pre>
<p>We see that the confidence is one in many examples, that is for instance because when you have bought wobbly chicken, the you also buy decoration and for this pair it also goes the other way around.</p>
<p>We see an example where the coverage is not one, that is because when you buy one, then you do not always buy the other. That is calculated by:</p>
<p><span class="math display">\[\frac{support}{coverage} = confidence\]</span></p>
<p>We see that:</p>
<ul>
<li>Support = <span class="math inline">\(\frac{TotalInvoices}{AbsoluteNo.OfTransactions} = Support\)</span></li>
<li>Coverage = <span class="math inline">\(\frac{Support}{Confidence} = Coverage\)</span></li>
<li>Lift = <span class="math inline">\(\frac{P(A|B)}{P(A)} = Lift\)</span>, we see with lift, that we actually need to find out how the pairs appear. See an example in the following.</li>
</ul>
<div class="figure">
<img src="images/LiftExample.png" alt="" />
<p class="caption">Lift example</p>
</div>
<p><strong>Manual calculation of support, coverage and confidence</strong></p>
<p>We are going to do three things:</p>
<ol style="list-style-type: decimal">
<li>Count no. of transactions with the left hand side combination</li>
<li>Count the no. of transactions where the right hand side combination is within the transactions found in step 1.</li>
<li>Divide support by coverage to find confidence. If 1 = the right hand side combination is always in the basket when the left hand side is, when e.g., 0.5 instead, then the right hand side is only half of the time in the basket when the left hand side is.</li>
</ol>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="recommender-systems-and-customer-targeting.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We are going to look at the pair woobly chicken and decoration</span></span>
<span id="cb417-2"><a href="recommender-systems-and-customer-targeting.html#cb417-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-3"><a href="recommender-systems-and-customer-targeting.html#cb417-3" aria-hidden="true" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="st">&quot;SUNSET CHECK HAMMOCK&quot;</span></span>
<span id="cb417-4"><a href="recommender-systems-and-customer-targeting.html#cb417-4" aria-hidden="true" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="st">&quot;UNION STRIPE WITH FRINGE  HAMMOCK&quot;</span></span>
<span id="cb417-5"><a href="recommender-systems-and-customer-targeting.html#cb417-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb417-6"><a href="recommender-systems-and-customer-targeting.html#cb417-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Find row number of a given item</span></span>
<span id="cb417-7"><a href="recommender-systems-and-customer-targeting.html#cb417-7" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">as.vector</span>(tr<span class="sc">@</span>itemInfo))) <span class="sc">==</span> left)</span>
<span id="cb417-8"><a href="recommender-systems-and-customer-targeting.html#cb417-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tr<span class="sc">@</span>data[idx,])</span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
## 22152    39</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="recommender-systems-and-customer-targeting.html#cb419-1" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(tr<span class="sc">@</span>data[idx,])[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">ncol</span>(tr<span class="sc">@</span>data))</span>
<span id="cb419-2"><a href="recommender-systems-and-customer-targeting.html#cb419-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3"><a href="recommender-systems-and-customer-targeting.html#cb419-3" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">as.vector</span>(tr<span class="sc">@</span>itemInfo))) <span class="sc">==</span> left)</span>
<span id="cb419-4"><a href="recommender-systems-and-customer-targeting.html#cb419-4" aria-hidden="true" tabindex="-1"></a>idx_right <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">t</span>(<span class="fu">t</span>(<span class="fu">as.vector</span>(tr<span class="sc">@</span>itemInfo))) <span class="sc">==</span> right)</span>
<span id="cb419-5"><a href="recommender-systems-and-customer-targeting.html#cb419-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6"><a href="recommender-systems-and-customer-targeting.html#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="co">#which(tr@data[idx,] == TRUE)</span></span>
<span id="cb419-7"><a href="recommender-systems-and-customer-targeting.html#cb419-7" aria-hidden="true" tabindex="-1"></a><span class="co">#which(tr@data[idx_right,] == TRUE)</span></span>
<span id="cb419-8"><a href="recommender-systems-and-customer-targeting.html#cb419-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-9"><a href="recommender-systems-and-customer-targeting.html#cb419-9" aria-hidden="true" tabindex="-1"></a>right_side <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">which</span>(tr<span class="sc">@</span>data[idx,] <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%in%</span> <span class="fu">which</span>(tr<span class="sc">@</span>data[idx_right,] <span class="sc">==</span> <span class="cn">TRUE</span>))</span>
<span id="cb419-10"><a href="recommender-systems-and-customer-targeting.html#cb419-10" aria-hidden="true" tabindex="-1"></a>right_side <span class="co">#Inteprete to see if there are only T, F or both.</span></span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##    14    25</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="recommender-systems-and-customer-targeting.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We see that decoration is always in the basket when wobbly chicken is.</span></span>
<span id="cb421-2"><a href="recommender-systems-and-customer-targeting.html#cb421-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-3"><a href="recommender-systems-and-customer-targeting.html#cb421-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb421-4"><a href="recommender-systems-and-customer-targeting.html#cb421-4" aria-hidden="true" tabindex="-1"></a>support <span class="ot">=</span> <span class="fu">as.vector</span>(right_side[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">ncol</span>(tr<span class="sc">@</span>data))</span>
<span id="cb421-5"><a href="recommender-systems-and-customer-targeting.html#cb421-5" aria-hidden="true" tabindex="-1"></a>support</span></code></pre></div>
<pre><code>## [1] 0.001126583</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="recommender-systems-and-customer-targeting.html#cb423-1" aria-hidden="true" tabindex="-1"></a>confidence <span class="ot">=</span> support <span class="sc">/</span> coverage </span>
<span id="cb423-2"><a href="recommender-systems-and-customer-targeting.html#cb423-2" aria-hidden="true" tabindex="-1"></a>confidence <span class="co">#Hence a very stron relationship from woobly chicken to decoration</span></span></code></pre></div>
<pre><code>## [1] 0.6410256</code></pre>
<p><strong>Now we can inspect the rules after they are sorted</strong></p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="recommender-systems-and-customer-targeting.html#cb425-1" aria-hidden="true" tabindex="-1"></a>sortedRules <span class="ot">&lt;-</span> <span class="fu">sort</span>(association.rules,<span class="at">by=</span><span class="st">&quot;lift&quot;</span>,<span class="at">decreasing=</span><span class="cn">TRUE</span>)</span>
<span id="cb425-2"><a href="recommender-systems-and-customer-targeting.html#cb425-2" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(sortedRules[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)])</span></code></pre></div>
<p><em>Notice that bookdown gave an error so I just manually inserted the output</em></p>
<div class="figure">
<img src="images/sortedRulesOutput.png" alt="" />
<p class="caption">Sorted Rules Output</p>
</div>
<p>The conclusions are the same, it is just sorted now.</p>
<p>The LIFT reflects how often the LHS is bought given the RHS is in the basket.</p>
<div id="another-example-where-maxlen-3" class="section level4" number="3.1.5.1">
<h4><span class="header-section-number">3.1.5.1</span> Another example where maxlen = 3</h4>
<p>Here we only want to look at combinations with up to three items.</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="recommender-systems-and-customer-targeting.html#cb426-1" aria-hidden="true" tabindex="-1"></a>shorter.association.rules <span class="ot">&lt;-</span> <span class="fu">apriori</span>(tr, <span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">supp=</span><span class="fl">0.001</span> <span class="co">#must occur in 1 in 1000</span></span>
<span id="cb426-2"><a href="recommender-systems-and-customer-targeting.html#cb426-2" aria-hidden="true" tabindex="-1"></a>                                                          ,<span class="at">conf=</span><span class="fl">0.8</span> <span class="co">#We need to pairs to be at least 80% of the time together</span></span>
<span id="cb426-3"><a href="recommender-systems-and-customer-targeting.html#cb426-3" aria-hidden="true" tabindex="-1"></a>                                                          ,<span class="at">maxlen=</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Apriori
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport maxtime support minlen
##         0.8    0.1    1 none FALSE            TRUE       5   0.001      1
##  maxlen target  ext
##       3  rules TRUE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## Absolute minimum support count: 22 
## 
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[7876 item(s), 22191 transaction(s)] done [0.14s].
## sorting and recoding items ... [2324 item(s)] done [0.01s].
## creating transaction tree ... done [0.01s].
## checking subsets of size 1 2 3 done [0.15s].
## writing ... [2216 rule(s)] done [0.02s].
## creating S4 object  ... done [0.01s].</code></pre>
<p>Notice that the RHS and LHS summarize up to 3, where before it could go all the way up to 10.</p>
</div>
<div id="filtering-on-right-hand-side.-an-example-with-the-item-metal" class="section level4" number="3.1.5.2">
<h4><span class="header-section-number">3.1.5.2</span> Filtering on right hand side. An example with the item {METAL}</h4>
<p>We want to see what is purchased before buying metal.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="recommender-systems-and-customer-targeting.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co">#For example, to find what customers buy before buying &#39;METAL&#39; run the following line of code</span></span>
<span id="cb428-2"><a href="recommender-systems-and-customer-targeting.html#cb428-2" aria-hidden="true" tabindex="-1"></a>metal.association.rules <span class="ot">&lt;-</span> <span class="fu">apriori</span>(<span class="at">data =</span> tr</span>
<span id="cb428-3"><a href="recommender-systems-and-customer-targeting.html#cb428-3" aria-hidden="true" tabindex="-1"></a>                                   ,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">supp=</span><span class="fl">0.001</span>, <span class="at">conf=</span><span class="fl">0.8</span>)</span>
<span id="cb428-4"><a href="recommender-systems-and-customer-targeting.html#cb428-4" aria-hidden="true" tabindex="-1"></a>                                   ,<span class="at">appearance =</span> <span class="fu">list</span>(<span class="at">default=</span><span class="st">&quot;lhs&quot;</span>,<span class="at">rhs=</span><span class="st">&quot;METAL&quot;</span>))</span></code></pre></div>
<pre><code>## Apriori
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport maxtime support minlen
##         0.8    0.1    1 none FALSE            TRUE       5   0.001      1
##  maxlen target  ext
##      10  rules TRUE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## Absolute minimum support count: 22 
## 
## set item appearances ...[1 item(s)] done [0.00s].
## set transactions ...[7876 item(s), 22191 transaction(s)] done [0.16s].
## sorting and recoding items ... [2324 item(s)] done [0.01s].
## creating transaction tree ... done [0.01s].
## checking subsets of size 1 2 3 4 5 6 7 8 9 10 done [0.22s].
## writing ... [5 rule(s)] done [0.03s].
## creating S4 object  ... done [0.01s].</code></pre>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="recommender-systems-and-customer-targeting.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(metal.association.rules)</span></code></pre></div>
<pre><code>##     lhs                            rhs     support     confidence coverage   
## [1] {WOBBLY CHICKEN}            =&gt; {METAL} 0.001261773 1          0.001261773
## [2] {WOBBLY RABBIT}             =&gt; {METAL} 0.001532153 1          0.001532153
## [3] {DECORATION}                =&gt; {METAL} 0.002253166 1          0.002253166
## [4] {DECORATION,WOBBLY CHICKEN} =&gt; {METAL} 0.001261773 1          0.001261773
## [5] {DECORATION,WOBBLY RABBIT}  =&gt; {METAL} 0.001532153 1          0.001532153
##     lift   count
## [1] 443.82 28   
## [2] 443.82 34   
## [3] 443.82 50   
## [4] 443.82 28   
## [5] 443.82 34</code></pre>
<p>Now we see the combinations where the metal is the right hand side. Where we which products that leads to purchase of metal.</p>
</div>
<div id="filtering-on-left-hand-side.-an-example-with-the-item-metal" class="section level4" number="3.1.5.3">
<h4><span class="header-section-number">3.1.5.3</span> Filtering on left hand side. An example with the item {METAL}</h4>
<p>We can do the same for the left hand side.</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="recommender-systems-and-customer-targeting.html#cb432-1" aria-hidden="true" tabindex="-1"></a>metal.association.rules <span class="ot">&lt;-</span> <span class="fu">apriori</span>(<span class="at">data =</span> tr</span>
<span id="cb432-2"><a href="recommender-systems-and-customer-targeting.html#cb432-2" aria-hidden="true" tabindex="-1"></a>                                   ,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">supp=</span><span class="fl">0.001</span>, <span class="at">conf=</span><span class="fl">0.8</span>)</span>
<span id="cb432-3"><a href="recommender-systems-and-customer-targeting.html#cb432-3" aria-hidden="true" tabindex="-1"></a>                                   ,<span class="at">appearance =</span> <span class="fu">list</span>(<span class="at">lhs=</span><span class="st">&quot;METAL&quot;</span>,<span class="at">default=</span><span class="st">&quot;rhs&quot;</span>))</span></code></pre></div>
<pre><code>## Apriori
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport maxtime support minlen
##         0.8    0.1    1 none FALSE            TRUE       5   0.001      1
##  maxlen target  ext
##      10  rules TRUE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## Absolute minimum support count: 22 
## 
## set item appearances ...[1 item(s)] done [0.00s].
## set transactions ...[7876 item(s), 22191 transaction(s)] done [0.17s].
## sorting and recoding items ... [2324 item(s)] done [0.01s].
## creating transaction tree ... done [0.01s].
## checking subsets of size 1 2 done [0.00s].
## writing ... [1 rule(s)] done [0.00s].
## creating S4 object  ... done [0.01s].</code></pre>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="recommender-systems-and-customer-targeting.html#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect</span>(<span class="fu">head</span>(metal.association.rules))</span></code></pre></div>
<pre><code>##     lhs        rhs          support     confidence coverage    lift   count
## [1] {METAL} =&gt; {DECORATION} 0.002253166 1          0.002253166 443.82 50</code></pre>
<p>Where this is showing what products metal leads to buying.</p>
<p>We see only one item that is followed by buying metal.</p>
</div>
</div>
<div id="plotting-association-rules" class="section level3" number="3.1.6">
<h3><span class="header-section-number">3.1.6</span> Plotting association rules</h3>
<p>We want to get all where the confidence is greater than 40%.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="recommender-systems-and-customer-targeting.html#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This is just showed as an example, so we can do the filtering</span></span>
<span id="cb436-2"><a href="recommender-systems-and-customer-targeting.html#cb436-2" aria-hidden="true" tabindex="-1"></a>association.rules <span class="ot">&lt;-</span> <span class="fu">apriori</span>(<span class="at">data =</span> tr</span>
<span id="cb436-3"><a href="recommender-systems-and-customer-targeting.html#cb436-3" aria-hidden="true" tabindex="-1"></a>                             ,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">supp=</span><span class="fl">0.001</span>, <span class="at">conf=</span><span class="fl">0.3</span>,<span class="at">maxlen=</span><span class="dv">10</span>))</span></code></pre></div>
<pre><code>## Apriori
## 
## Parameter specification:
##  confidence minval smax arem  aval originalSupport maxtime support minlen
##         0.3    0.1    1 none FALSE            TRUE       5   0.001      1
##  maxlen target  ext
##      10  rules TRUE
## 
## Algorithmic control:
##  filter tree heap memopt load sort verbose
##     0.1 TRUE TRUE  FALSE TRUE    2    TRUE
## 
## Absolute minimum support count: 22 
## 
## set item appearances ...[0 item(s)] done [0.00s].
## set transactions ...[7876 item(s), 22191 transaction(s)] done [0.16s].
## sorting and recoding items ... [2324 item(s)] done [0.01s].
## creating transaction tree ... done [0.01s].
## checking subsets of size 1 2 3 4 5 6 7 8 9 10 done [0.30s].
## writing ... [180603 rule(s)] done [0.06s].
## creating S4 object  ... done [0.07s].</code></pre>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="recommender-systems-and-customer-targeting.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting</span></span>
<span id="cb438-2"><a href="recommender-systems-and-customer-targeting.html#cb438-2" aria-hidden="true" tabindex="-1"></a>subRules <span class="ot">&lt;-</span> association.rules[<span class="fu">quality</span>(association.rules)<span class="sc">$</span>confidence<span class="sc">&gt;</span><span class="fl">0.4</span>]</span></code></pre></div>
<p>We see that the higher the confidence the higher the lift, so there appears to be a strong relationship between these.</p>
<p>We can also show it in the following.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="recommender-systems-and-customer-targeting.html#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot SubRules</span></span>
<span id="cb439-2"><a href="recommender-systems-and-customer-targeting.html#cb439-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(subRules)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-190-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that usually the lift is the greatest in the top left corner, where the confidence is high and support is low.</p>
<p>This makes sense, as you cannot lift (boost) the sales of another product, if their relationship is already rather high.</p>
<p>Now we can plot the length of the rule with respect to confidence</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="recommender-systems-and-customer-targeting.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The order is the number of items in the rule</span></span>
<span id="cb440-2"><a href="recommender-systems-and-customer-targeting.html#cb440-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(subRules,<span class="at">method=</span><span class="st">&quot;two-key plot&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-191-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>The following is supposed to be an interactive plot. But does not appear to work, missing a library.</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="recommender-systems-and-customer-targeting.html#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotly_arules(subRules)</span></span></code></pre></div>
<p>Now we can plot some interactive plot, where one can explore the rules.</p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="recommender-systems-and-customer-targeting.html#cb442-1" aria-hidden="true" tabindex="-1"></a>top10subRules <span class="ot">&lt;-</span> <span class="fu">head</span>(subRules, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">by =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb442-2"><a href="recommender-systems-and-customer-targeting.html#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(top10subRules, <span class="at">method =</span> <span class="st">&quot;graph&quot;</span>,  <span class="at">engine =</span> <span class="st">&quot;htmlwidget&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-244938df9da821113a18" style="width:720px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-244938df9da821113a18">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"label":["WOBBLY CHICKEN","DECOUPAGE","BILLBOARD FONTS DESIGN","WOBBLY RABBIT","ART LIGHTS","FUNK MONKEY","BLACK TEA","DECORATION","METAL","GREETING CARD","WRAP","SUGAR JARS","COFFEE","rule 1","rule 2","rule 3","rule 4","rule 5","rule 6","rule 7","rule 8","rule 9","rule 10"],"group":["item","item","item","item","item","item","item","item","item","item","item","item","item","rule","rule","rule","rule","rule","rule","rule","rule","rule","rule"],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,22.5217391304348,22.5217391304348,1,26.8260869565217,48.3478260869565,48.3478260869565,65.5652173913044,65.5652173913044,100,100],"color":["#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#CBD2FC","#EE8484","#EE8484","#EE9797","#EE1B1B","#EE8484","#EE8484","#EE5050","#EE5050","#EEB8B8","#EEDCDC"],"title":["WOBBLY CHICKEN","DECOUPAGE","BILLBOARD FONTS DESIGN","WOBBLY RABBIT","ART LIGHTS","FUNK MONKEY","BLACK TEA","DECORATION","METAL","GREETING CARD","WRAP","SUGAR JARS","COFFEE","<B>[1]<\/B><BR><B>{WOBBLY CHICKEN}<\/B><BR>&nbsp;&nbsp; => <B>{DECORATION}<\/B><BR><BR>support = 0.00126<BR>confidence = 1<BR>coverage = 0.00126<BR>lift = 444<BR>count = 28<BR>order = 2","<B>[2]<\/B><BR><B>{WOBBLY CHICKEN}<\/B><BR>&nbsp;&nbsp; => <B>{METAL}<\/B><BR><BR>support = 0.00126<BR>confidence = 1<BR>coverage = 0.00126<BR>lift = 444<BR>count = 28<BR>order = 2","<B>[3]<\/B><BR><B>{DECOUPAGE}<\/B><BR>&nbsp;&nbsp; => <B>{GREETING CARD}<\/B><BR><BR>support = 0.00104<BR>confidence = 1<BR>coverage = 0.00104<BR>lift = 389<BR>count = 23<BR>order = 2","<B>[4]<\/B><BR><B>{BILLBOARD FONTS DESIGN}<\/B><BR>&nbsp;&nbsp; => <B>{WRAP}<\/B><BR><BR>support = 0.00131<BR>confidence = 1<BR>coverage = 0.00131<BR>lift = 716<BR>count = 29<BR>order = 2","<B>[5]<\/B><BR><B>{WOBBLY RABBIT}<\/B><BR>&nbsp;&nbsp; => <B>{DECORATION}<\/B><BR><BR>support = 0.00153<BR>confidence = 1<BR>coverage = 0.00153<BR>lift = 444<BR>count = 34<BR>order = 2","<B>[6]<\/B><BR><B>{WOBBLY RABBIT}<\/B><BR>&nbsp;&nbsp; => <B>{METAL}<\/B><BR><BR>support = 0.00153<BR>confidence = 1<BR>coverage = 0.00153<BR>lift = 444<BR>count = 34<BR>order = 2","<B>[7]<\/B><BR><B>{ART LIGHTS}<\/B><BR>&nbsp;&nbsp; => <B>{FUNK MONKEY}<\/B><BR><BR>support = 0.00171<BR>confidence = 1<BR>coverage = 0.00171<BR>lift = 584<BR>count = 38<BR>order = 2","<B>[8]<\/B><BR><B>{FUNK MONKEY}<\/B><BR>&nbsp;&nbsp; => <B>{ART LIGHTS}<\/B><BR><BR>support = 0.00171<BR>confidence = 1<BR>coverage = 0.00171<BR>lift = 584<BR>count = 38<BR>order = 2","<B>[9]<\/B><BR><B>{BLACK TEA}<\/B><BR>&nbsp;&nbsp; => <B>{SUGAR JARS}<\/B><BR><BR>support = 0.00207<BR>confidence = 1<BR>coverage = 0.00207<BR>lift = 239<BR>count = 46<BR>order = 2","<B>[10]<\/B><BR><B>{BLACK TEA}<\/B><BR>&nbsp;&nbsp; => <B>{COFFEE}<\/B><BR><BR>support = 0.00207<BR>confidence = 1<BR>coverage = 0.00207<BR>lift = 69.3<BR>count = 46<BR>order = 2"],"shape":["box","box","box","box","box","box","box","box","box","box","box","box","box","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"x":[0.668920237681522,-0.320411217215932,1,0.238612061749243,-0.870905658431672,-0.541240980206201,-0.67811210618543,0.0943731126118859,0.837166148948968,0.234296885875382,0.578286811166204,-1,-0.140709073445363,0.380755686910226,0.863121372931853,-0.0377266978130534,0.808248670612366,0.0793667245287841,0.539373609371534,-0.818758290523715,-0.584782719883501,-0.964608534020099,-0.417868341087654],"y":[-0.83880408962753,0.995275227635468,0.346535261988181,-0.257488472396744,-0.488832656310422,-0.827682931054995,0.223513712547011,-0.90248119616094,-0.252050633126836,1,0.668441242845922,0.501945075496856,0.399923425383007,-1,-0.569175656845108,0.997293596504212,0.537560020987206,-0.564407575807868,-0.127291880020746,-0.780412566010676,-0.521703121100904,0.2202994981935,0.363030525631226]},"edges":{"from":[1,1,2,3,4,4,5,6,7,7,14,15,16,17,18,19,20,21,22,23],"to":[14,15,16,17,18,19,20,21,22,23,8,9,10,11,8,9,6,5,12,13],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","scaling":{"label":{"enabled":true}},"physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false},"interaction":{"hover":true}},"groups":["item","rule"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);","highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="recommender-systems-and-customer-targeting.html#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="colaborative-filtering" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Colaborative filtering</h2>
<p>As mentioned in the beginning of the chapter, we see that one can make recommendations based on similarity with other users and or similarity between products.</p>
<div id="loading-and-formatting-data" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Loading and formatting data</h3>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="recommender-systems-and-customer-targeting.html#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recommenderlab)</span>
<span id="cb444-2"><a href="recommender-systems-and-customer-targeting.html#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="recommender-systems-and-customer-targeting.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;MovieLense&quot;</span>)</span>
<span id="cb445-2"><a href="recommender-systems-and-customer-targeting.html#cb445-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-3"><a href="recommender-systems-and-customer-targeting.html#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Data is given in realRatingMatrix format  ; Optimized to store sparse matrices</span></span>
<span id="cb445-4"><a href="recommender-systems-and-customer-targeting.html#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(MovieLense)</span>
<span id="cb445-5"><a href="recommender-systems-and-customer-targeting.html#cb445-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(MovieLense,<span class="at">vec.len=</span><span class="dv">2</span>) <span class="co">#not as we normally reference list elements by \\$ but \\@</span></span></code></pre></div>
<pre><code>## [1] &quot;realRatingMatrix&quot;
## attr(,&quot;package&quot;)
## [1] &quot;recommenderlab&quot;
## Formal class &#39;realRatingMatrix&#39; [package &quot;recommenderlab&quot;] with 2 slots
##   ..@ data     :Formal class &#39;dgCMatrix&#39; [package &quot;Matrix&quot;] with 6 slots
##   .. .. ..@ i       : int [1:99392] 0 1 4 5 9 ...
##   .. .. ..@ p       : int [1:1665] 0 452 583 673 882 ...
##   .. .. ..@ Dim     : int [1:2] 943 1664
##   .. .. ..@ Dimnames:List of 2
##   .. .. .. ..$ : chr [1:943] &quot;1&quot; &quot;2&quot; ...
##   .. .. .. ..$ : chr [1:1664] &quot;Toy Story (1995)&quot; &quot;GoldenEye (1995)&quot; ...
##   .. .. ..@ x       : num [1:99392] 5 4 4 4 4 ...
##   .. .. ..@ factors : list()
##   ..@ normalize: NULL</code></pre>
<p>the following are the different methods that we can use.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="recommender-systems-and-customer-targeting.html#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">methods</span>(<span class="at">class =</span> <span class="fu">class</span>(MovieLense)) <span class="co"># methods applicable to this class</span></span></code></pre></div>
<pre><code>##  [1] [                      [&lt;-                    binarize              
##  [4] calcPredictionAccuracy coerce                 colCounts             
##  [7] colMeans               colSds                 colSums               
## [10] denormalize            dim                    dimnames              
## [13] dimnames&lt;-             dissimilarity          evaluationScheme      
## [16] getData.frame          getList                getNormalize          
## [19] getRatingMatrix        getRatings             getTopNLists          
## [22] hasRating              image                  nratings              
## [25] Recommender            removeKnownRatings     rowCounts             
## [28] rowMeans               rowSds                 rowSums               
## [31] sample                 show                   similarity            
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>We see the dimensions of our matrix with users and the movies.</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="recommender-systems-and-customer-targeting.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MovieLense)</span></code></pre></div>
<pre><code>## [1]  943 1664</code></pre>
<p>We see that there 1.664 movies and 943 users.</p>
<div id="loading-metadata-that-gets-loaded-with-main-dataset" class="section level4" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Loading metadata that gets loaded with main dataset</h4>
<p><strong><em>This is not applied in the exercise, but just shown</em></strong></p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="recommender-systems-and-customer-targeting.html#cb451-1" aria-hidden="true" tabindex="-1"></a>moviemeta <span class="ot">&lt;-</span> MovieLenseMeta</span>
<span id="cb451-2"><a href="recommender-systems-and-customer-targeting.html#cb451-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(moviemeta)</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<p>We see that it is a data.frame. It has the following column names:</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="recommender-systems-and-customer-targeting.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(moviemeta)</span></code></pre></div>
<pre><code>##  [1] &quot;title&quot;       &quot;year&quot;        &quot;url&quot;         &quot;unknown&quot;     &quot;Action&quot;     
##  [6] &quot;Adventure&quot;   &quot;Animation&quot;   &quot;Children&#39;s&quot;  &quot;Comedy&quot;      &quot;Crime&quot;      
## [11] &quot;Documentary&quot; &quot;Drama&quot;       &quot;Fantasy&quot;     &quot;Film-Noir&quot;   &quot;Horror&quot;     
## [16] &quot;Musical&quot;     &quot;Mystery&quot;     &quot;Romance&quot;     &quot;Sci-Fi&quot;      &quot;Thriller&quot;   
## [21] &quot;War&quot;         &quot;Western&quot;</code></pre>
<p>We see that the genre for each movie is presented.</p>
</div>
</div>
<div id="data-exploration" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Data Exploration</h3>
<p>We can see the topics for each movie. Only used for exploration purposes.</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="recommender-systems-and-customer-targeting.html#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co">#What do we know about the films?</span></span>
<span id="cb455-2"><a href="recommender-systems-and-customer-targeting.html#cb455-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb455-3"><a href="recommender-systems-and-customer-targeting.html#cb455-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">head</span>(moviemeta,<span class="dv">2</span>),<span class="at">caption =</span> <span class="st">&quot;First few Rows within Movie Meta Data &quot;</span>)</span></code></pre></div>
<table style="width:36%;">
<caption>First few Rows within Movie Meta Data (continued below)</caption>
<colgroup>
<col width="26%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">title</th>
<th align="center">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Toy Story (1995)</td>
<td align="center">1995</td>
</tr>
<tr class="even">
<td align="center">GoldenEye (1995)</td>
<td align="center">1995</td>
</tr>
</tbody>
</table>
<table style="width:100%;">
<caption>Table continues below</caption>
<colgroup>
<col width="73%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">url</th>
<th align="center">unknown</th>
<th align="center">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><a href="http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)" class="uri">http://us.imdb.com/M/title-exact?Toy%20Story%20(1995)</a></td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><a href="http://us.imdb.com/M/title-exact?GoldenEye%20(1995)" class="uri">http://us.imdb.com/M/title-exact?GoldenEye%20(1995)</a></td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<table>
<caption>Table continues below</caption>
<colgroup>
<col width="15%" />
<col width="15%" />
<col width="17%" />
<col width="11%" />
<col width="10%" />
<col width="18%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Adventure</th>
<th align="center">Animation</th>
<th align="center">Childrenâs</th>
<th align="center">Comedy</th>
<th align="center">Crime</th>
<th align="center">Documentary</th>
<th align="center">Drama</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table>
<caption>Table continues below</caption>
<colgroup>
<col width="12%" />
<col width="14%" />
<col width="11%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="11%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Fantasy</th>
<th align="center">Film-Noir</th>
<th align="center">Horror</th>
<th align="center">Musical</th>
<th align="center">Mystery</th>
<th align="center">Romance</th>
<th align="center">Sci-Fi</th>
<th align="center">Thriller</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<table style="width:22%;">
<colgroup>
<col width="8%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">War</th>
<th align="center">Western</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>We can also interpret the ratings for a given customer</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="recommender-systems-and-customer-targeting.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="do">## look at the first few ratings of the first user</span></span>
<span id="cb456-2"><a href="recommender-systems-and-customer-targeting.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">as</span>(MovieLense[<span class="dv">1</span>,], <span class="st">&quot;list&quot;</span>)[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>##                                     Toy Story (1995) 
##                                                    5 
##                                     GoldenEye (1995) 
##                                                    3 
##                                    Four Rooms (1995) 
##                                                    4 
##                                    Get Shorty (1995) 
##                                                    3 
##                                       Copycat (1995) 
##                                                    3 
## Shanghai Triad (Yao a yao yao dao waipo qiao) (1995) 
##                                                    5</code></pre>
<div id="plotting-1" class="section level4" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Plotting</h4>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="recommender-systems-and-customer-targeting.html#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="do">## number of ratings per user</span></span>
<span id="cb458-2"><a href="recommender-systems-and-customer-targeting.html#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">rowCounts</span>(MovieLense))</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-203-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that most has reviewed less than 100 movies. Therefore we also see in the following plot, that most movies have less than 100 reviews, where we have a long tail with some movies that have very few ratings.</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="recommender-systems-and-customer-targeting.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="do">## number of ratings per movie</span></span>
<span id="cb459-2"><a href="recommender-systems-and-customer-targeting.html#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">colCounts</span>(MovieLense))</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-204-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we can look at which movies that are top 10, based on number of times watched.</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="recommender-systems-and-customer-targeting.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Top 10 movies</span></span>
<span id="cb460-2"><a href="recommender-systems-and-customer-targeting.html#cb460-2" aria-hidden="true" tabindex="-1"></a>movie_watched <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb460-3"><a href="recommender-systems-and-customer-targeting.html#cb460-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">movie_name =</span> <span class="fu">names</span>(<span class="fu">colCounts</span>(MovieLense)),</span>
<span id="cb460-4"><a href="recommender-systems-and-customer-targeting.html#cb460-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">watched_times =</span> <span class="fu">colCounts</span>(MovieLense)</span>
<span id="cb460-5"><a href="recommender-systems-and-customer-targeting.html#cb460-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb460-6"><a href="recommender-systems-and-customer-targeting.html#cb460-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-7"><a href="recommender-systems-and-customer-targeting.html#cb460-7" aria-hidden="true" tabindex="-1"></a>top_ten_movies <span class="ot">&lt;-</span> movie_watched[<span class="fu">order</span>(movie_watched<span class="sc">$</span>watched_times, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ] </span>
<span id="cb460-8"><a href="recommender-systems-and-customer-targeting.html#cb460-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-9"><a href="recommender-systems-and-customer-targeting.html#cb460-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top_ten_movies) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>movie_name, <span class="at">y=</span>watched_times) <span class="sc">+</span> </span>
<span id="cb460-10"><a href="recommender-systems-and-customer-targeting.html#cb460-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;firebrick4&quot;</span>, <span class="at">color =</span> <span class="st">&quot;dodgerblue2&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Movie Tile&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Count&quot;</span>) <span class="sc">+</span></span>
<span id="cb460-11"><a href="recommender-systems-and-customer-targeting.html#cb460-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-205-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Looking at the overall data, we see that the mean rating is 3.5 where the median is actually 4, which seem pretty high.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="recommender-systems-and-customer-targeting.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">getRatings</span>(MovieLense))</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00    3.00    4.00    3.53    4.00    5.00</code></pre>
<p>This we can also plot.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="recommender-systems-and-customer-targeting.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">ratings =</span> <span class="fu">getRatings</span>(MovieLense)) <span class="sc">%&gt;%</span></span>
<span id="cb463-2"><a href="recommender-systems-and-customer-targeting.html#cb463-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(ratings)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.75</span>)<span class="sc">+</span></span>
<span id="cb463-3"><a href="recommender-systems-and-customer-targeting.html#cb463-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;MovieLense Ratings Distribution&#39;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-207-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="what-models-can-we-use" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> What models can we use?</h3>
<p>Here we can see some of the recommender models that are available.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="recommender-systems-and-customer-targeting.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Different recommender models</span></span>
<span id="cb464-2"><a href="recommender-systems-and-customer-targeting.html#cb464-2" aria-hidden="true" tabindex="-1"></a>recommender_models <span class="ot">&lt;-</span>  recommenderRegistry<span class="sc">$</span><span class="fu">get_entries</span>(<span class="at">dataType=</span><span class="st">&quot;realRatingMatrix&quot;</span>)</span>
<span id="cb464-3"><a href="recommender-systems-and-customer-targeting.html#cb464-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(recommender_models)</span></code></pre></div>
<pre><code>##  [1] &quot;HYBRID_realRatingMatrix&quot;       &quot;ALS_realRatingMatrix&quot;         
##  [3] &quot;ALS_implicit_realRatingMatrix&quot; &quot;IBCF_realRatingMatrix&quot;        
##  [5] &quot;LIBMF_realRatingMatrix&quot;        &quot;POPULAR_realRatingMatrix&quot;     
##  [7] &quot;RANDOM_realRatingMatrix&quot;       &quot;RERECOMMEND_realRatingMatrix&quot; 
##  [9] &quot;SVD_realRatingMatrix&quot;          &quot;SVDF_realRatingMatrix&quot;        
## [11] &quot;UBCF_realRatingMatrix&quot;</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="recommender-systems-and-customer-targeting.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co">#recommenderRegistry$get_entries(dataType=&quot;realRatingMatrix&quot;) #If run, you will see the parameters</span></span></code></pre></div>
<p>We will focus on:</p>
<ul>
<li>UBCF</li>
<li>IBCF</li>
<li>SVD</li>
<li>ALS</li>
<li>SVDF</li>
</ul>
</div>
<div id="training-and-test-set" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Training and test set</h3>
<p>We want movies with at least 30 ratings and at least 100 users for each items. We see that the following approach is actually pretty clever, where we see that we filter on rows and columns by making the logical directly in the subsetting.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="recommender-systems-and-customer-targeting.html#cb467-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Training and test set At least 30 items evaluated or at least 100 users for each item</span></span>
<span id="cb467-2"><a href="recommender-systems-and-customer-targeting.html#cb467-2" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">&lt;-</span> MovieLense[<span class="fu">rowCounts</span>(MovieLense) <span class="sc">&gt;</span> <span class="dv">30</span></span>
<span id="cb467-3"><a href="recommender-systems-and-customer-targeting.html#cb467-3" aria-hidden="true" tabindex="-1"></a>                    ,<span class="fu">colCounts</span>(MovieLense) <span class="sc">&gt;</span> <span class="dv">100</span>]</span>
<span id="cb467-4"><a href="recommender-systems-and-customer-targeting.html#cb467-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb467-5"><a href="recommender-systems-and-customer-targeting.html#cb467-5" aria-hidden="true" tabindex="-1"></a>rates1 <span class="ot">&lt;-</span> rates[<span class="fu">rowCounts</span>(rates) <span class="sc">&gt;</span> <span class="dv">30</span>,] <span class="co">#This is included again, to make sure that we have accounted for both</span></span></code></pre></div>
<p>Now we can split the data into train and test data.</p>
<p>We randomly define the which_train vector that is <code>TRUE</code> for users in the training set and <code>FALSE</code> for the others. Will set the probability in the training set as 80%</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="recommender-systems-and-customer-targeting.html#cb468-1" aria-hidden="true" tabindex="-1"></a>which_train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">size =</span> <span class="fu">nrow</span>(rates1), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.2</span>)) <span class="co">#Random sampling</span></span>
<span id="cb468-2"><a href="recommender-systems-and-customer-targeting.html#cb468-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb468-3"><a href="recommender-systems-and-customer-targeting.html#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the training and the test sets</span></span>
<span id="cb468-4"><a href="recommender-systems-and-customer-targeting.html#cb468-4" aria-hidden="true" tabindex="-1"></a>recc_data_train <span class="ot">&lt;-</span> rates1[which_train, ]</span>
<span id="cb468-5"><a href="recommender-systems-and-customer-targeting.html#cb468-5" aria-hidden="true" tabindex="-1"></a>recc_data_test <span class="ot">&lt;-</span> rates1[<span class="sc">!</span>which_train, ]</span></code></pre></div>
<p>My guess is that <code>recc</code> is for recommender.</p>
</div>
<div id="a-small-example-with-ibcf-item-based" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> A small example with IBCF (item based)</h3>
<p><strong>Fitting the model</strong></p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="recommender-systems-and-customer-targeting.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s build the recommender IBCF - cosine:</span></span>
<span id="cb469-2"><a href="recommender-systems-and-customer-targeting.html#cb469-2" aria-hidden="true" tabindex="-1"></a>recc_model <span class="ot">&lt;-</span> <span class="fu">Recommender</span>(<span class="at">data =</span> recc_data_train <span class="co">#On the train data</span></span>
<span id="cb469-3"><a href="recommender-systems-and-customer-targeting.html#cb469-3" aria-hidden="true" tabindex="-1"></a>                          ,<span class="at">method =</span> <span class="st">&quot;IBCF&quot;</span> <span class="co">#The col. filt. model</span></span>
<span id="cb469-4"><a href="recommender-systems-and-customer-targeting.html#cb469-4" aria-hidden="true" tabindex="-1"></a>                          ,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">k =</span> <span class="dv">30</span>) <span class="co">#No. of neighbors</span></span>
<span id="cb469-5"><a href="recommender-systems-and-customer-targeting.html#cb469-5" aria-hidden="true" tabindex="-1"></a>                          )</span></code></pre></div>
<p>We have now created a IBCF Recommender Model</p>
<p><strong>Predicting recommendations on test data</strong></p>
<p>We want 5 recommendations for each user, based on the test data set.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="recommender-systems-and-customer-targeting.html#cb470-1" aria-hidden="true" tabindex="-1"></a>n_recommended <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb470-2"><a href="recommender-systems-and-customer-targeting.html#cb470-2" aria-hidden="true" tabindex="-1"></a>recc_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> recc_model</span>
<span id="cb470-3"><a href="recommender-systems-and-customer-targeting.html#cb470-3" aria-hidden="true" tabindex="-1"></a>                          ,<span class="at">newdata =</span> recc_data_test</span>
<span id="cb470-4"><a href="recommender-systems-and-customer-targeting.html#cb470-4" aria-hidden="true" tabindex="-1"></a>                          ,<span class="at">n =</span> n_recommended)</span>
<span id="cb470-5"><a href="recommender-systems-and-customer-targeting.html#cb470-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb470-6"><a href="recommender-systems-and-customer-targeting.html#cb470-6" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the recommendation for the first user</span></span>
<span id="cb470-7"><a href="recommender-systems-and-customer-targeting.html#cb470-7" aria-hidden="true" tabindex="-1"></a>recc_predicted<span class="sc">@</span>items[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## [1]  5 27 39 33 49</code></pre>
<p>These are the recommendations for the given user. Now we can look for the movei name, which we are recommending. Now we want to convert the numbers into the actual movie names.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="recommender-systems-and-customer-targeting.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s define a list with the recommendations for each user</span></span>
<span id="cb472-2"><a href="recommender-systems-and-customer-targeting.html#cb472-2" aria-hidden="true" tabindex="-1"></a>recc_matrix <span class="ot">&lt;-</span> <span class="fu">lapply</span>(recc_predicted<span class="sc">@</span>items, <span class="cf">function</span>(x){</span>
<span id="cb472-3"><a href="recommender-systems-and-customer-targeting.html#cb472-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(rates)[x]</span>
<span id="cb472-4"><a href="recommender-systems-and-customer-targeting.html#cb472-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb472-5"><a href="recommender-systems-and-customer-targeting.html#cb472-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb472-6"><a href="recommender-systems-and-customer-targeting.html#cb472-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s take a look the recommendations for the first four users:</span></span>
<span id="cb472-7"><a href="recommender-systems-and-customer-targeting.html#cb472-7" aria-hidden="true" tabindex="-1"></a>recc_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<pre><code>## $`5`
## [1] &quot;Babe (1995)&quot;                           
## [2] &quot;Pulp Fiction (1994)&quot;                   
## [3] &quot;Maverick (1994)&quot;                       
## [4] &quot;Ace Ventura: Pet Detective (1994)&quot;     
## [5] &quot;Nightmare Before Christmas, The (1993)&quot;
## 
## $`7`
## [1] &quot;Fifth Element, The (1997)&quot;                                 
## [2] &quot;Like Water For Chocolate (Como agua para chocolate) (1992)&quot;
## [3] &quot;Happy Gilmore (1996)&quot;                                      
## [4] &quot;Face/Off (1997)&quot;                                           
## [5] &quot;Wag the Dog (1997)&quot;                                        
## 
## $`26`
## [1] &quot;Welcome to the Dollhouse (1995)&quot; &quot;True Lies (1994)&quot;               
## [3] &quot;Ghost (1990)&quot;                    &quot;Star Trek: Generations (1994)&quot;  
## [5] &quot;Abyss, The (1989)&quot;              
## 
## $`41`
## [1] &quot;Twelve Monkeys (1995)&quot;          &quot;Taxi Driver (1976)&quot;            
## [3] &quot;While You Were Sleeping (1995)&quot; &quot;Blade Runner (1982)&quot;           
## [5] &quot;Lone Star (1996)&quot;</code></pre>
<p>Then we see recommendations for four persons.</p>
</div>
<div id="ubcf---user-based-collaborative-based" class="section level3" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> UBCF - User based collaborative based</h3>
<p>The method computes the similarity between users with cosine</p>
<div id="fitting-the-model" class="section level4" number="3.2.6.1">
<h4><span class="header-section-number">3.2.6.1</span> Fitting the model</h4>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="recommender-systems-and-customer-targeting.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s build a recommender model leaving the parameters to their defaults. </span></span>
<span id="cb474-2"><a href="recommender-systems-and-customer-targeting.html#cb474-2" aria-hidden="true" tabindex="-1"></a>recc_model <span class="ot">&lt;-</span> <span class="fu">Recommender</span>(<span class="at">data =</span> recc_data_train</span>
<span id="cb474-3"><a href="recommender-systems-and-customer-targeting.html#cb474-3" aria-hidden="true" tabindex="-1"></a>                          ,<span class="at">method =</span> <span class="st">&quot;UBCF&quot;</span>)</span></code></pre></div>
<p>A UBCF recommender has now been created</p>
</div>
<div id="predicting-making-recommendations" class="section level4" number="3.2.6.2">
<h4><span class="header-section-number">3.2.6.2</span> Predicting (making) recommendations</h4>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="recommender-systems-and-customer-targeting.html#cb475-1" aria-hidden="true" tabindex="-1"></a>n_recommended <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb475-2"><a href="recommender-systems-and-customer-targeting.html#cb475-2" aria-hidden="true" tabindex="-1"></a>recc_predicted <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> recc_model</span>
<span id="cb475-3"><a href="recommender-systems-and-customer-targeting.html#cb475-3" aria-hidden="true" tabindex="-1"></a>                          ,<span class="at">newdata =</span> recc_data_test</span>
<span id="cb475-4"><a href="recommender-systems-and-customer-targeting.html#cb475-4" aria-hidden="true" tabindex="-1"></a>                          ,<span class="at">n =</span> n_recommended)</span>
<span id="cb475-5"><a href="recommender-systems-and-customer-targeting.html#cb475-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-6"><a href="recommender-systems-and-customer-targeting.html#cb475-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s define a list with the recommendations to the test set users.</span></span>
<span id="cb475-7"><a href="recommender-systems-and-customer-targeting.html#cb475-7" aria-hidden="true" tabindex="-1"></a>recc_matrix <span class="ot">&lt;-</span> <span class="fu">sapply</span>(recc_predicted<span class="sc">@</span>items, <span class="cf">function</span>(x) {</span>
<span id="cb475-8"><a href="recommender-systems-and-customer-targeting.html#cb475-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(rates)[x]</span>
<span id="cb475-9"><a href="recommender-systems-and-customer-targeting.html#cb475-9" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb475-10"><a href="recommender-systems-and-customer-targeting.html#cb475-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-11"><a href="recommender-systems-and-customer-targeting.html#cb475-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Again, let&#39;s look at the first four users</span></span>
<span id="cb475-12"><a href="recommender-systems-and-customer-targeting.html#cb475-12" aria-hidden="true" tabindex="-1"></a>recc_matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Gone with the Wind (1939)&quot; &quot;Lawrence of Arabia (1962)&quot;
## [3] &quot;Annie Hall (1977)&quot;         &quot;Beautiful Girls (1996)&quot;</code></pre>
<p>Now we get recommendations based on user based filtering.</p>
</div>
</div>
<div id="cross-validation" class="section level3" number="3.2.7">
<h3><span class="header-section-number">3.2.7</span> Cross validation</h3>
<p><em>The purpose is to make a more stable model through cross validation.</em></p>
<p><strong><em>The cross validation, that we set up here, is going to be used in the following code, for estimating models.</em></strong></p>
<p>We can split the data into some chunks, take a chunk out as the test set, and evaluate the accuracy. Then we can do the same with each other chunk and compute the average accuracy. Here we construct the evaluation model</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="recommender-systems-and-customer-targeting.html#cb477-1" aria-hidden="true" tabindex="-1"></a>n_fold <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb477-2"><a href="recommender-systems-and-customer-targeting.html#cb477-2" aria-hidden="true" tabindex="-1"></a>rating_threshold <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># threshold at which we consider the item to be good</span></span>
<span id="cb477-3"><a href="recommender-systems-and-customer-targeting.html#cb477-3" aria-hidden="true" tabindex="-1"></a>items_to_keep <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># given=20 means that while testing the model use only 20 randomly picked ratings from every user to predict the unknown ratings</span></span>
<span id="cb477-4"><a href="recommender-systems-and-customer-targeting.html#cb477-4" aria-hidden="true" tabindex="-1"></a><span class="co"># in the test set the known data set has the ratings specified by given and the unknown data set the remaining ratings used for validation  </span></span>
<span id="cb477-5"><a href="recommender-systems-and-customer-targeting.html#cb477-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-6"><a href="recommender-systems-and-customer-targeting.html#cb477-6" aria-hidden="true" tabindex="-1"></a>eval_sets <span class="ot">&lt;-</span> <span class="fu">evaluationScheme</span>(<span class="at">data =</span> rates1</span>
<span id="cb477-7"><a href="recommender-systems-and-customer-targeting.html#cb477-7" aria-hidden="true" tabindex="-1"></a>                              ,<span class="at">method =</span> <span class="st">&quot;cross-validation&quot;</span></span>
<span id="cb477-8"><a href="recommender-systems-and-customer-targeting.html#cb477-8" aria-hidden="true" tabindex="-1"></a>                              ,<span class="at">k =</span> n_fold, </span>
<span id="cb477-9"><a href="recommender-systems-and-customer-targeting.html#cb477-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">given =</span> items_to_keep</span>
<span id="cb477-10"><a href="recommender-systems-and-customer-targeting.html#cb477-10" aria-hidden="true" tabindex="-1"></a>                              ,<span class="at">goodRating =</span> rating_threshold)</span>
<span id="cb477-11"><a href="recommender-systems-and-customer-targeting.html#cb477-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb477-12"><a href="recommender-systems-and-customer-targeting.html#cb477-12" aria-hidden="true" tabindex="-1"></a>size_sets <span class="ot">&lt;-</span><span class="fu">sapply</span>(eval_sets<span class="sc">@</span>runsTrain, length)</span>
<span id="cb477-13"><a href="recommender-systems-and-customer-targeting.html#cb477-13" aria-hidden="true" tabindex="-1"></a>size_sets</span></code></pre></div>
<pre><code>## [1] 459 459 459 459</code></pre>
</div>
<div id="ibcf---item-based-collaborative-based" class="section level3" number="3.2.8">
<h3><span class="header-section-number">3.2.8</span> IBCF - Item based collaborative based</h3>
<div id="fitting-the-model-using-cv" class="section level4" number="3.2.8.1">
<h4><span class="header-section-number">3.2.8.1</span> Fitting the model (using CV)</h4>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="recommender-systems-and-customer-targeting.html#cb479-1" aria-hidden="true" tabindex="-1"></a>model_to_evaluate <span class="ot">&lt;-</span> <span class="st">&quot;IBCF&quot;</span></span>
<span id="cb479-2"><a href="recommender-systems-and-customer-targeting.html#cb479-2" aria-hidden="true" tabindex="-1"></a>model_parameters <span class="ot">&lt;-</span> <span class="cn">NULL</span>  <span class="co"># we use the standard settings</span></span>
<span id="cb479-3"><a href="recommender-systems-and-customer-targeting.html#cb479-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-4"><a href="recommender-systems-and-customer-targeting.html#cb479-4" aria-hidden="true" tabindex="-1"></a>eval_recommender <span class="ot">&lt;-</span><span class="fu">Recommender</span>(<span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;train&quot;</span>)</span>
<span id="cb479-5"><a href="recommender-systems-and-customer-targeting.html#cb479-5" aria-hidden="true" tabindex="-1"></a>                               ,<span class="at">method =</span> model_to_evaluate</span>
<span id="cb479-6"><a href="recommender-systems-and-customer-targeting.html#cb479-6" aria-hidden="true" tabindex="-1"></a>                               ,<span class="at">parameter =</span> model_parameters)</span></code></pre></div>
</div>
<div id="making-predictions" class="section level4" number="3.2.8.2">
<h4><span class="header-section-number">3.2.8.2</span> Making predictions</h4>
<p>The IBCF can recommend new items and predict their ratings. In order to build the model, we need to specify how many items we want to recommend, for example, 5.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="recommender-systems-and-customer-targeting.html#cb480-1" aria-hidden="true" tabindex="-1"></a>items_to_recommend <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb480-2"><a href="recommender-systems-and-customer-targeting.html#cb480-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb480-3"><a href="recommender-systems-and-customer-targeting.html#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We can build the matrix with the predicted ratings using the predict function:</span></span>
<span id="cb480-4"><a href="recommender-systems-and-customer-targeting.html#cb480-4" aria-hidden="true" tabindex="-1"></a>eval_prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> eval_recommender</span>
<span id="cb480-5"><a href="recommender-systems-and-customer-targeting.html#cb480-5" aria-hidden="true" tabindex="-1"></a>                           ,<span class="at">newdata =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;known&quot;</span>)</span>
<span id="cb480-6"><a href="recommender-systems-and-customer-targeting.html#cb480-6" aria-hidden="true" tabindex="-1"></a>                           ,<span class="at">n =</span> items_to_recommend</span>
<span id="cb480-7"><a href="recommender-systems-and-customer-targeting.html#cb480-7" aria-hidden="true" tabindex="-1"></a>                           ,<span class="at">type =</span> <span class="st">&quot;ratings&quot;</span>)</span></code></pre></div>
</div>
<div id="performance-metrics" class="section level4" number="3.2.8.3">
<h4><span class="header-section-number">3.2.8.3</span> Performance metrics</h4>
<p><strong>Per user</strong></p>
<p>By using the <code>calcPredictionAccuracy</code>, we can calculate:</p>
<ul>
<li>the Root mean square error <strong>(RMSE)</strong>,</li>
<li>Mean squared error <strong>(MSE)</strong>, and</li>
<li>the Mean absolute error <strong>(MAE)</strong>.</li>
</ul>
<p>We want to compare the results on each user, hence we take the head. In the following we are also plotting a histogram.</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="recommender-systems-and-customer-targeting.html#cb481-1" aria-hidden="true" tabindex="-1"></a>eval_accuracy <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb481-2"><a href="recommender-systems-and-customer-targeting.html#cb481-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction</span>
<span id="cb481-3"><a href="recommender-systems-and-customer-targeting.html#cb481-3" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>)</span>
<span id="cb481-4"><a href="recommender-systems-and-customer-targeting.html#cb481-4" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">byUser =</span> <span class="cn">TRUE</span> <span class="co">#Because, how good does the model work for each user</span></span>
<span id="cb481-5"><a href="recommender-systems-and-customer-targeting.html#cb481-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb481-6"><a href="recommender-systems-and-customer-targeting.html#cb481-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb481-7"><a href="recommender-systems-and-customer-targeting.html#cb481-7" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a small sample of the results for the Prediction and Accuracy</span></span>
<span id="cb481-8"><a href="recommender-systems-and-customer-targeting.html#cb481-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eval_accuracy)</span></code></pre></div>
<pre><code>##        RMSE      MSE       MAE
## 5  1.618733 2.620298 1.3540077
## 6  1.335989 1.784867 0.9377790
## 7  1.267880 1.607520 0.9272107
## 11 1.097127 1.203688 0.8608482
## 15 1.760519 3.099426 1.4578952
## 16 1.155948 1.336215 0.6713985</code></pre>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="recommender-systems-and-customer-targeting.html#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, let&#39;s take a look at the RMSE by each user</span></span>
<span id="cb483-2"><a href="recommender-systems-and-customer-targeting.html#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(eval_accuracy[,<span class="st">&quot;RMSE&quot;</span>]) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb483-3"><a href="recommender-systems-and-customer-targeting.html#cb483-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Distribution of the RMSE by user&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-220-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the typical RMSE is between 1 and 1.5.</p>
<p><strong>Overall</strong></p>
<p>The following is the average for all users</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="recommender-systems-and-customer-targeting.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># However, we need to evaluate the model as a whole, so we will set the byUser to False</span></span>
<span id="cb484-2"><a href="recommender-systems-and-customer-targeting.html#cb484-2" aria-hidden="true" tabindex="-1"></a>eval_accuracy <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb484-3"><a href="recommender-systems-and-customer-targeting.html#cb484-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction</span>
<span id="cb484-4"><a href="recommender-systems-and-customer-targeting.html#cb484-4" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>)</span>
<span id="cb484-5"><a href="recommender-systems-and-customer-targeting.html#cb484-5" aria-hidden="true" tabindex="-1"></a>  ,<span class="at">byUser =</span> <span class="cn">FALSE</span> <span class="co">#We want it for the whole model</span></span>
<span id="cb484-6"><a href="recommender-systems-and-customer-targeting.html#cb484-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb484-7"><a href="recommender-systems-and-customer-targeting.html#cb484-7" aria-hidden="true" tabindex="-1"></a>eval_accuracy <span class="co">#for IBCF</span></span></code></pre></div>
<pre><code>##     RMSE      MSE      MAE 
## 1.366885 1.868374 1.046393</code></pre>
<p>The mean absolute error is just above 1, hence one rating off. Lets us take a look at the confusionmatrix to see how it looks there.</p>
<p>Notice that we specificy n, that is because we want predictions for different number of predictions.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="recommender-systems-and-customer-targeting.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix good threshold =4</span></span>
<span id="cb486-2"><a href="recommender-systems-and-customer-targeting.html#cb486-2" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">evaluate</span>(<span class="at">x =</span> eval_sets <span class="co">#Using the Cross validation</span></span>
<span id="cb486-3"><a href="recommender-systems-and-customer-targeting.html#cb486-3" aria-hidden="true" tabindex="-1"></a>                    ,<span class="at">method =</span> model_to_evaluate</span>
<span id="cb486-4"><a href="recommender-systems-and-customer-targeting.html#cb486-4" aria-hidden="true" tabindex="-1"></a>                    ,<span class="at">n =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>)) <span class="co">#We make from 10 to 100 recommendations</span></span></code></pre></div>
<pre><code>## IBCF run fold/sample [model time/prediction time]
##   1  [0.144sec/0.037sec] 
##   2  [0.147sec/0.147sec] 
##   3  [0.142sec/0.044sec] 
##   4  [0.149sec/0.036sec]</code></pre>
<p>results object is an evaluationResults object containing the results of the evaluation.
Each element of the list corresponds to a different split of the k-fold.
Letâs look at the first element</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="recommender-systems-and-customer-targeting.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Results for each CV</span></span>
<span id="cb488-2"><a href="recommender-systems-and-customer-targeting.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="fu">getConfusionMatrix</span>(results)[[<span class="dv">1</span>]] <span class="co">#the first cross validation, 2 would be the second CV etc.</span></span></code></pre></div>
<pre><code>##              TP       FP       FN       TN   N precision     recall        TPR
##  [1,]  1.743590  8.25641 43.11538 258.8846 312 0.1743590 0.04006280 0.04006280
##  [2,]  3.314103 16.68590 41.54487 250.4551 312 0.1657051 0.07731537 0.07731537
##  [3,]  4.955128 25.03205 39.90385 242.1090 312 0.1652778 0.11629358 0.11629358
##  [4,]  6.326923 33.59615 38.53205 233.5449 312 0.1586538 0.14898650 0.14898650
##  [5,]  7.634615 42.22436 37.22436 224.9167 312 0.1533974 0.18148772 0.18148772
##  [6,]  9.000000 50.79487 35.85897 216.3462 312 0.1508547 0.21260538 0.21260538
##  [7,] 10.442308 59.28846 34.41667 207.8526 312 0.1501374 0.25034654 0.25034654
##  [8,] 11.628205 68.03846 33.23077 199.1026 312 0.1463942 0.27633480 0.27633480
##  [9,] 12.724359 76.87821 32.13462 190.2628 312 0.1424858 0.29713798 0.29713798
## [10,] 14.038462 85.50000 30.82051 181.6410 312 0.1415385 0.32788012 0.32788012
##              FPR   n
##  [1,] 0.03081865  10
##  [2,] 0.06240341  20
##  [3,] 0.09363603  30
##  [4,] 0.12571313  40
##  [5,] 0.15821967  50
##  [6,] 0.19033215  60
##  [7,] 0.22226847  70
##  [8,] 0.25506440  80
##  [9,] 0.28819483  90
## [10,] 0.32053667 100</code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="recommender-systems-and-customer-targeting.html#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="co">#getConfusionMatrix(results)[[2]] #the first cross validation, 2 would be the second CV etc.</span></span>
<span id="cb490-2"><a href="recommender-systems-and-customer-targeting.html#cb490-2" aria-hidden="true" tabindex="-1"></a><span class="co">#getConfusionMatrix(results)[[3]] #the first cross validation, 2 would be the second CV etc.</span></span>
<span id="cb490-3"><a href="recommender-systems-and-customer-targeting.html#cb490-3" aria-hidden="true" tabindex="-1"></a><span class="co">#getConfusionMatrix(results)[[4]] #the first cross validation, 2 would be the second CV etc.</span></span></code></pre></div>
<p>We see that the more recommendations we make, the âbetterâ does the results get, although making 100 recommendations also means that the FP is also increasing, hence we start recommending something, where it did not turn out to be purchased. Hence it is a trade-off.</p>
<p>In this case, look at the first four columns</p>
<ul>
<li>True Positives (TP): These are recommended items that have been purchased.</li>
<li>False Positives (FP): These are recommended items that havenât been purchased</li>
<li>False Negatives (FN): These are not recommended items that have been purchased.</li>
<li>True Negatives (TN): These are not recommended items that havenât been purchased.</li>
</ul>
<p><strong>Manually making the ROC curve</strong></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="recommender-systems-and-customer-targeting.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If we want to take account of all the splits at the same time, we can just sum up the indices:</span></span>
<span id="cb491-2"><a href="recommender-systems-and-customer-targeting.html#cb491-2" aria-hidden="true" tabindex="-1"></a>columns_to_sum <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;TP&quot;</span>, <span class="st">&quot;FP&quot;</span>, <span class="st">&quot;FN&quot;</span>, <span class="st">&quot;TN&quot;</span>)</span>
<span id="cb491-3"><a href="recommender-systems-and-customer-targeting.html#cb491-3" aria-hidden="true" tabindex="-1"></a>indices_summed <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(<span class="st">&quot;+&quot;</span>, <span class="fu">getConfusionMatrix</span>(results))[, columns_to_sum]</span>
<span id="cb491-4"><a href="recommender-systems-and-customer-targeting.html#cb491-4" aria-hidden="true" tabindex="-1"></a>TPR <span class="ot">&lt;-</span> indices_summed[,<span class="st">&quot;TP&quot;</span>]<span class="sc">/</span>(indices_summed[,<span class="st">&quot;TP&quot;</span>] <span class="sc">+</span> indices_summed[,<span class="st">&quot;FN&quot;</span>])</span>
<span id="cb491-5"><a href="recommender-systems-and-customer-targeting.html#cb491-5" aria-hidden="true" tabindex="-1"></a>FPR <span class="ot">&lt;-</span> indices_summed[,<span class="st">&quot;FP&quot;</span>]<span class="sc">/</span>(indices_summed[,<span class="st">&quot;FP&quot;</span>] <span class="sc">+</span> indices_summed[,<span class="st">&quot;TN&quot;</span>])</span>
<span id="cb491-6"><a href="recommender-systems-and-customer-targeting.html#cb491-6" aria-hidden="true" tabindex="-1"></a>indices_summed <span class="ot">&lt;-</span> <span class="fu">cbind</span>(indices_summed,TPR,FPR)</span>
<span id="cb491-7"><a href="recommender-systems-and-customer-targeting.html#cb491-7" aria-hidden="true" tabindex="-1"></a>indices_summed</span></code></pre></div>
<pre><code>##              TP        FP       FN        TN        TPR        FPR
##  [1,]  7.173077  32.82692 173.9679 1034.0321 0.03959941 0.03076969
##  [2,] 13.660256  66.33974 167.4808 1000.5192 0.07541227 0.06218230
##  [3,] 19.794872 100.19231 161.3462  966.6667 0.10927879 0.09391336
##  [4,] 25.653846 134.26923 155.4872  932.5897 0.14162361 0.12585471
##  [5,] 31.057692 168.80128 150.0833  898.0577 0.17145587 0.15822268
##  [6,] 36.679487 203.11538 144.4615  863.7436 0.20249133 0.19038635
##  [7,] 42.057692 237.67308 139.0833  829.1859 0.23218204 0.22277835
##  [8,] 47.288462 272.37821 133.8526  794.4808 0.26105882 0.25530854
##  [9,] 52.294872 307.29487 128.8462  759.5641 0.28869701 0.28803701
## [10,] 57.794872 341.66667 123.3462  725.1923 0.31906009 0.32025476</code></pre>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="recommender-systems-and-customer-targeting.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> TPR <span class="ot">&lt;-</span> indices_summed[,<span class="st">&quot;FPR&quot;</span>],<span class="at">y =</span> TPR <span class="ot">&lt;-</span> indices_summed[,<span class="st">&quot;TPR&quot;</span>],<span class="at">type =</span> <span class="st">&quot;b&quot;</span></span>
<span id="cb493-2"><a href="recommender-systems-and-customer-targeting.html#cb493-2" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">cex =</span> <span class="dv">0</span> <span class="co">#To remove dots.</span></span>
<span id="cb493-3"><a href="recommender-systems-and-customer-targeting.html#cb493-3" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlab =</span> <span class="st">&quot;FPR&quot;</span></span>
<span id="cb493-4"><a href="recommender-systems-and-customer-targeting.html#cb493-4" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylab =</span> <span class="st">&quot;TPR&quot;</span></span>
<span id="cb493-5"><a href="recommender-systems-and-customer-targeting.html#cb493-5" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb493-6"><a href="recommender-systems-and-customer-targeting.html#cb493-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> TPR <span class="ot">&lt;-</span> indices_summed[,<span class="st">&quot;FPR&quot;</span>],<span class="at">y =</span> TPR <span class="ot">&lt;-</span> indices_summed[,<span class="st">&quot;TPR&quot;</span>],<span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb493-7"><a href="recommender-systems-and-customer-targeting.html#cb493-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;ROC&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-224-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="building-roc-curve-and-precision-recall-rate" class="section level3" number="3.2.9">
<h3><span class="header-section-number">3.2.9</span> Building ROC curve and precision / recall rate</h3>
<p>Building an ROC curve. Will need these factors</p>
<ol style="list-style-type: decimal">
<li>True Positive Rate (TPR): Percentage of purchased items that have been recommended. TP/(TP + FN)</li>
<li>False Positive Rate (FPR): Percentage of not purchased items that have been recommended. FP/(FP + TN)</li>
</ol>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="recommender-systems-and-customer-targeting.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(results, <span class="at">annotate =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;ROC curve&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-225-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Now we can also make a precision / recall rate</p>
<p>We can also look at the accuracy metrics as well:</p>
<ul>
<li>Precision: Percentage of recommended items that have been purchased. FP/(TP + FP)</li>
<li>Recall: Percentage of purchased items that have been recommended. TP/(TP + FN) = True Positive Rate</li>
</ul>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="recommender-systems-and-customer-targeting.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(results, <span class="st">&quot;prec/rec&quot;</span>, <span class="at">annotate =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Precision-Recall&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-226-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>The plots above gives an indication of how many recommendations to make. Notice that it is based upon the results object that we are making, there we specify the intervals for which we are going to recommend.</p>
</div>
<div id="comparing-ubcf-and-ibcf" class="section level3" number="3.2.10">
<h3><span class="header-section-number">3.2.10</span> Comparing UBCF and IBCF</h3>
<p>let us see how the models compare</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="recommender-systems-and-customer-targeting.html#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Comparing models</span></span>
<span id="cb496-2"><a href="recommender-systems-and-customer-targeting.html#cb496-2" aria-hidden="true" tabindex="-1"></a>models_to_evaluate <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">IBCF_cos =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;IBCF&quot;</span>, <span class="at">param =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;cosine&quot;</span>)),  <span class="co">#Cosine correl. coef.</span></span>
<span id="cb496-3"><a href="recommender-systems-and-customer-targeting.html#cb496-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">IBCF_cor =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;IBCF&quot;</span>, <span class="at">param =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)), <span class="co">#Pearson correl. coef.</span></span>
<span id="cb496-4"><a href="recommender-systems-and-customer-targeting.html#cb496-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">UBCF_cos =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;UBCF&quot;</span>, <span class="at">param =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;cosine&quot;</span>)), </span>
<span id="cb496-5"><a href="recommender-systems-and-customer-targeting.html#cb496-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">UBCF_cor =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;UBCF&quot;</span>, <span class="at">param =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)), </span>
<span id="cb496-6"><a href="recommender-systems-and-customer-targeting.html#cb496-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">random =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;RANDOM&quot;</span>, <span class="at">param =</span> <span class="cn">NULL</span>))</span>
<span id="cb496-7"><a href="recommender-systems-and-customer-targeting.html#cb496-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-8"><a href="recommender-systems-and-customer-targeting.html#cb496-8" aria-hidden="true" tabindex="-1"></a><span class="co"># In order to evaluate the models, we need to test them, varying the number of items.</span></span>
<span id="cb496-9"><a href="recommender-systems-and-customer-targeting.html#cb496-9" aria-hidden="true" tabindex="-1"></a>n_recommendations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb496-10"><a href="recommender-systems-and-customer-targeting.html#cb496-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-11"><a href="recommender-systems-and-customer-targeting.html#cb496-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now let&#39;s run and evaluate the models</span></span>
<span id="cb496-12"><a href="recommender-systems-and-customer-targeting.html#cb496-12" aria-hidden="true" tabindex="-1"></a>list_results <span class="ot">&lt;-</span> <span class="fu">evaluate</span>(<span class="at">x =</span> eval_sets, <span class="at">method =</span> models_to_evaluate, <span class="at">n =</span> n_recommendations)</span></code></pre></div>
<pre><code>## IBCF run fold/sample [model time/prediction time]
##   1  [0.15sec/0.036sec] 
##   2  [0.146sec/0.041sec] 
##   3  [0.142sec/0.036sec] 
##   4  [0.145sec/0.037sec] 
## IBCF run fold/sample [model time/prediction time]
##   1  [0.234sec/0.037sec] 
##   2  [0.23sec/0.037sec] 
##   3  [0.222sec/0.037sec] 
##   4  [0.228sec/0.036sec] 
## UBCF run fold/sample [model time/prediction time]
##   1  [0.004sec/0.394sec] 
##   2  [0.003sec/0.234sec] 
##   3  [0.004sec/0.388sec] 
##   4  [0.006sec/0.243sec] 
## UBCF run fold/sample [model time/prediction time]
##   1  [0.004sec/0.422sec] 
##   2  [0.004sec/0.267sec] 
##   3  [0.003sec/0.283sec] 
##   4  [0.005sec/0.284sec] 
## RANDOM run fold/sample [model time/prediction time]
##   1  [0.001sec/0.043sec] 
##   2  [0.001sec/0.04sec] 
##   3  [0.001sec/0.039sec] 
##   4  [0.001sec/0.046sec]</code></pre>
<p>Now we can plot the roc curves and the and the precision - recall rate.</p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="recommender-systems-and-customer-targeting.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(list_results, <span class="at">annotate =</span> <span class="dv">1</span>, <span class="at">legend =</span> <span class="st">&quot;topleft&quot;</span>)</span>
<span id="cb498-2"><a href="recommender-systems-and-customer-targeting.html#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;ROC curve&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-228-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="recommender-systems-and-customer-targeting.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(list_results, <span class="st">&quot;prec/rec&quot;</span>, <span class="at">annotate =</span> <span class="dv">1</span>, <span class="at">legend =</span> <span class="st">&quot;bottomright&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>))</span>
<span id="cb499-2"><a href="recommender-systems-and-customer-targeting.html#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Precision-recall&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-228-2.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the IBCF Pearson correlation coefficient gets the best result. We also see that the random recommendations is almost as good as some of the other methods.</p>
<p><strong>Other evaluation criteria</strong></p>
<ol style="list-style-type: decimal">
<li>Coverage - what we have seen earlier</li>
<li>Diversity and novelty - To avoid monotone lists, discover new families of items</li>
<li>Serendipity - Unexpected and surprisng items might be valuable</li>
<li>Familiarity - GIve the user the impression of understanding his/her needs</li>
<li>Biases - Do we just end up recommended the best movies? hence there is a great bias.</li>
</ol>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="recommender-systems-and-customer-targeting.html#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
</div>
<div id="latent-factor-models" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Latent Factor Models</h2>
<p>This is a snippet from the introduction in the chapter:</p>
<p><em>The last approach is the latent factor model, this is just an extension of the user-based and item-based, where both scenarios are considered. This method assumes that we make some constructs, e.g., as in SEM, where the constructs are explained by different items (movies). Then it would be obvious to make constructs based on different genres. These constructs are not directly observable, hence the name latent.</em></p>
<p><em>Within LFM cold start also applies</em></p>
<p><strong>How is correlation measured?</strong></p>
<p>We see that the dot product (inner product) between items and users, here we are able to interpret the projection of these from the center to see how similar/dissimilar they are. From the image we can see that Gus and the guy in the top right is more or less perpendicular, so they do not share much interest on the y axis, although on the x axis they appear to be equally far out, hence the dot product appears to be able to reflect similarity between perople.</p>
<p><img src="images/DotProduct.png" alt="Dot product example" />.</p>
<p>Hence to make these projections we need to find to matrices - namely U and V. To estimate the values for these to matrices, we have used one approach, the <strong>Signular Value Decomposition (SVD)</strong>. Notice that this approach demands that we have a full matrix, as we often have sparse matrices, is that it replace missing values with the column means. This introduce a lot of bias, but makes the model work. For this method we cannot really avoid it, because each movie is never reviewed by all users.</p>
<p>Notice that for this method we are able to account for bias for ratings, e.g., one person may often give relatively higher ratings than other, hence we can regularize this to get rid of some bias.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="recommender-systems-and-customer-targeting.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(recommenderlab)</span>
<span id="cb501-2"><a href="recommender-systems-and-customer-targeting.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="recommender-systems-and-customer-targeting.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(MovieLense)</span>
<span id="cb502-2"><a href="recommender-systems-and-customer-targeting.html#cb502-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(MovieLense)</span></code></pre></div>
<pre><code>## [1] &quot;realRatingMatrix&quot;
## attr(,&quot;package&quot;)
## [1] &quot;recommenderlab&quot;</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="recommender-systems-and-customer-targeting.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(MovieLense)</span>
<span id="cb504-2"><a href="recommender-systems-and-customer-targeting.html#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(MovieLense)</span></code></pre></div>
<pre><code>## [1]  943 1664</code></pre>
<p>Select only the users who have rated at least 50 movies or movies that had been rated more than 100 times. As if they did not rate more than this it starts getting difficult recommeding movies for them.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="recommender-systems-and-customer-targeting.html#cb506-1" aria-hidden="true" tabindex="-1"></a>(ratings_movies <span class="ot">&lt;-</span> MovieLense[<span class="fu">rowCounts</span>(MovieLense) <span class="sc">&gt;</span> <span class="dv">50</span>,</span>
<span id="cb506-2"><a href="recommender-systems-and-customer-targeting.html#cb506-2" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">colCounts</span>(MovieLense) <span class="sc">&gt;</span> <span class="dv">100</span>])</span></code></pre></div>
<pre><code>## 560 x 332 rating matrix of class &#39;realRatingMatrix&#39; with 55298 ratings.</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="recommender-systems-and-customer-targeting.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use the minimum number of items purchased by any user to decide item number to keep</span></span>
<span id="cb508-2"><a href="recommender-systems-and-customer-targeting.html#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">rowCounts</span>(ratings_movies))</span>
<span id="cb508-3"><a href="recommender-systems-and-customer-targeting.html#cb508-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-4"><a href="recommender-systems-and-customer-targeting.html#cb508-4" aria-hidden="true" tabindex="-1"></a>n_fold <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb508-5"><a href="recommender-systems-and-customer-targeting.html#cb508-5" aria-hidden="true" tabindex="-1"></a>items_to_keep <span class="ot">&lt;-</span> <span class="dv">15</span> <span class="co">#randomly chosen items from a given responded</span></span>
<span id="cb508-6"><a href="recommender-systems-and-customer-targeting.html#cb508-6" aria-hidden="true" tabindex="-1"></a>rating_threshold <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#A good rating is three or higher</span></span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<p>In the following we include SVD-Funk, there is a bunch of tuning parameters, these are:</p>
<ul>
<li>k = number of topics</li>
<li>gamma = Learning parameter / learning rate</li>
<li>lambda = The regularization</li>
</ul>
<p><em>Notice that there are default values, although we choose to set k to 50.</em></p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="recommender-systems-and-customer-targeting.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Use k-fold to validate models</span></span>
<span id="cb510-2"><a href="recommender-systems-and-customer-targeting.html#cb510-2" aria-hidden="true" tabindex="-1"></a>eval_sets <span class="ot">&lt;-</span> <span class="fu">evaluationScheme</span>(<span class="at">data =</span> ratings_movies</span>
<span id="cb510-3"><a href="recommender-systems-and-customer-targeting.html#cb510-3" aria-hidden="true" tabindex="-1"></a>                              ,<span class="at">method =</span> <span class="st">&quot;cross-validation&quot;</span></span>
<span id="cb510-4"><a href="recommender-systems-and-customer-targeting.html#cb510-4" aria-hidden="true" tabindex="-1"></a>                              ,<span class="at">k =</span> n_fold</span>
<span id="cb510-5"><a href="recommender-systems-and-customer-targeting.html#cb510-5" aria-hidden="true" tabindex="-1"></a>                              ,<span class="at">given =</span> items_to_keep</span>
<span id="cb510-6"><a href="recommender-systems-and-customer-targeting.html#cb510-6" aria-hidden="true" tabindex="-1"></a>                              ,<span class="at">goodRating =</span> rating_threshold)</span>
<span id="cb510-7"><a href="recommender-systems-and-customer-targeting.html#cb510-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-8"><a href="recommender-systems-and-customer-targeting.html#cb510-8" aria-hidden="true" tabindex="-1"></a><span class="co">#We want to comapre different approaches</span></span>
<span id="cb510-9"><a href="recommender-systems-and-customer-targeting.html#cb510-9" aria-hidden="true" tabindex="-1"></a>models  <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb510-10"><a href="recommender-systems-and-customer-targeting.html#cb510-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">IBCF =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;IBCF&quot;</span>,<span class="at">param =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;cosine&quot;</span>)),</span>
<span id="cb510-11"><a href="recommender-systems-and-customer-targeting.html#cb510-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">UBCF =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;UBCF&quot;</span>, <span class="at">param =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)),</span>
<span id="cb510-12"><a href="recommender-systems-and-customer-targeting.html#cb510-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">SVD =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;SVD&quot;</span>, <span class="at">param =</span> <span class="fu">list</span>(<span class="at">k =</span> <span class="dv">50</span>)), <span class="co">#50 concepts included</span></span>
<span id="cb510-13"><a href="recommender-systems-and-customer-targeting.html#cb510-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">SVDF =</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;SVDF&quot;</span>, <span class="at">param =</span> <span class="fu">list</span>(<span class="at">k =</span> <span class="dv">50</span>)) <span class="co">#50 concepts included</span></span>
<span id="cb510-14"><a href="recommender-systems-and-customer-targeting.html#cb510-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>notice that the SVDF takes some time to compute. That is beacuse it has to go through all the known ratings and construct the U and V matrix.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="recommender-systems-and-customer-targeting.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># varying the number of items we want to recommend to users</span></span>
<span id="cb511-2"><a href="recommender-systems-and-customer-targeting.html#cb511-2" aria-hidden="true" tabindex="-1"></a>n_rec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span>
<span id="cb511-3"><a href="recommender-systems-and-customer-targeting.html#cb511-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-4"><a href="recommender-systems-and-customer-targeting.html#cb511-4" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluating the recommendations</span></span>
<span id="cb511-5"><a href="recommender-systems-and-customer-targeting.html#cb511-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">evaluate</span>(<span class="at">x =</span> eval_sets, <span class="at">method =</span> models, <span class="at">n=</span> n_rec)</span></code></pre></div>
<pre><code>## IBCF run fold/sample [model time/prediction time]
##   1  [0.165sec/0.051sec] 
##   2  [0.183sec/0.063sec] 
##   3  [0.167sec/0.05sec] 
##   4  [0.153sec/0.054sec] 
## UBCF run fold/sample [model time/prediction time]
##   1  [0.005sec/0.407sec] 
##   2  [0.005sec/0.287sec] 
##   3  [0.004sec/0.457sec] 
##   4  [0.005sec/0.284sec] 
## SVD run fold/sample [model time/prediction time]
##   1  [0.142sec/0.042sec] 
##   2  [0.13sec/0.039sec] 
##   3  [0.143sec/0.054sec] 
##   4  [0.125sec/0.04sec] 
## SVDF run fold/sample [model time/prediction time]
##   1  [60.501sec/16.491sec] 
##   2  [54.563sec/12.613sec] 
##   3  [54.591sec/14.75sec] 
##   4  [49.285sec/13.928sec]</code></pre>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="recommender-systems-and-customer-targeting.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the related average confusion matrices</span></span>
<span id="cb513-2"><a href="recommender-systems-and-customer-targeting.html#cb513-2" aria-hidden="true" tabindex="-1"></a>(avg_matrices <span class="ot">&lt;-</span> <span class="fu">lapply</span>(results, avg))</span>
<span id="cb513-3"><a href="recommender-systems-and-customer-targeting.html#cb513-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-4"><a href="recommender-systems-and-customer-targeting.html#cb513-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(results, <span class="at">annotate=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-236-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="recommender-systems-and-customer-targeting.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(results, <span class="st">&quot;prec/rec&quot;</span>, <span class="at">annotate =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Precision-Recall&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-236-2.png" width="720" style="display: block; margin: auto;" /></p>
<pre><code>## $IBCF
##               TP         FP       FN       TN   N precision     recall
##  [1,]  0.3482143  0.6517857 72.71429 243.2857 317 0.3482143 0.00491590
##  [2,]  1.4589286  3.5410714 71.60357 240.3964 317 0.2917857 0.01967898
##  [3,]  2.7857143  7.2142857 70.27679 236.7232 317 0.2785714 0.03835957
##  [4,]  5.3392857 14.6607143 67.72321 229.2768 317 0.2669643 0.07391105
##  [5,]  7.7035714 22.2964286 65.35893 221.6411 317 0.2567857 0.10613546
##  [6,] 10.0750000 29.9250000 62.98750 214.0125 317 0.2518750 0.13979789
##  [7,] 12.2553571 37.7428571 60.80714 206.1946 317 0.2451152 0.16961429
##  [8,] 14.4553571 45.5250000 58.60714 198.4125 317 0.2409961 0.20003095
##  [9,] 16.6071429 53.3553571 56.45536 190.5821 317 0.2373652 0.22866781
## [10,] 18.7482143 61.1732143 54.31429 182.7643 317 0.2345848 0.25801586
## [11,] 20.9392857 68.8928571 52.12321 175.0446 317 0.2330842 0.28861480
## [12,] 23.0375000 76.6875000 50.02500 167.2500 317 0.2310267 0.31799055
##              TPR         FPR   n
##  [1,] 0.00491590 0.002640127   1
##  [2,] 0.01967898 0.014389413   5
##  [3,] 0.03835957 0.029322262  10
##  [4,] 0.07391105 0.059713549  20
##  [5,] 0.10613546 0.091065483  30
##  [6,] 0.13979789 0.122509370  40
##  [7,] 0.16961429 0.154798067  50
##  [8,] 0.20003095 0.186763693  60
##  [9,] 0.22866781 0.218875612  70
## [10,] 0.25801586 0.251033210  80
## [11,] 0.28861480 0.282693419  90
## [12,] 0.31799055 0.314755874 100
## 
## $UBCF
##               TP         FP       FN       TN   N precision     recall
##  [1,]  0.2053571  0.7946429 72.85714 243.1429 317 0.2053571 0.00301467
##  [2,]  1.0625000  3.9375000 72.00000 240.0000 317 0.2125000 0.01514849
##  [3,]  2.2696429  7.7303571 70.79286 236.2071 317 0.2269643 0.03186838
##  [4,]  4.9678571 15.0321429 68.09464 228.9054 317 0.2483929 0.06896208
##  [5,]  7.7321429 22.2678571 65.33036 221.6696 317 0.2577381 0.10845983
##  [6,] 10.5892857 29.4107143 62.47321 214.5268 317 0.2647321 0.14770760
##  [7,] 13.4589286 36.5410714 59.60357 207.3964 317 0.2691786 0.18683732
##  [8,] 16.2428571 43.7571429 56.81964 200.1804 317 0.2707143 0.22412311
##  [9,] 19.0303571 50.9696429 54.03214 192.9679 317 0.2718622 0.26086940
## [10,] 21.7964286 58.2035714 51.26607 185.7339 317 0.2724554 0.29756155
## [11,] 24.4553571 65.5446429 48.60714 178.3929 317 0.2717262 0.33315249
## [12,] 27.1000000 72.9000000 45.96250 171.0375 317 0.2710000 0.37003899
##              TPR         FPR   n
##  [1,] 0.00301467 0.003266251   1
##  [2,] 0.01514849 0.016205094   5
##  [3,] 0.03186838 0.031743009  10
##  [4,] 0.06896208 0.061402265  20
##  [5,] 0.10845983 0.090847621  30
##  [6,] 0.14770760 0.119839234  40
##  [7,] 0.18683732 0.148698202  50
##  [8,] 0.22412311 0.177921239  60
##  [9,] 0.26086940 0.207113400  70
## [10,] 0.29756155 0.236446368  80
## [11,] 0.33315249 0.266269698  90
## [12,] 0.37003899 0.296255963 100
## 
## $SVD
##               TP         FP       FN       TN   N precision     recall
##  [1,]  0.4714286  0.5285714 72.59107 243.4089 317 0.4714286 0.00749966
##  [2,]  2.0964286  2.9035714 70.96607 241.0339 317 0.4192857 0.03213059
##  [3,]  3.8482143  6.1517857 69.21429 237.7857 317 0.3848214 0.05815476
##  [4,]  7.1160714 12.8839286 65.94643 231.0536 317 0.3558036 0.10586948
##  [5,] 10.1357143 19.8642857 62.92679 224.0732 317 0.3378571 0.14745252
##  [6,] 12.8875000 27.1125000 60.17500 216.8250 317 0.3221875 0.18598032
##  [7,] 15.4196429 34.5803571 57.64286 209.3571 317 0.3083929 0.22077686
##  [8,] 17.8428571 42.1571429 55.21964 201.7804 317 0.2973810 0.25306744
##  [9,] 20.2589286 49.7410714 52.80357 194.1964 317 0.2894133 0.28552879
## [10,] 22.6625000 57.3375000 50.40000 186.6000 317 0.2832812 0.31851925
## [11,] 24.9589286 65.0410714 48.10357 178.8964 317 0.2773214 0.34946212
## [12,] 27.2017857 72.7982143 45.86071 171.1393 317 0.2720179 0.38052596
##              TPR        FPR   n
##  [1,] 0.00749966 0.00208126   1
##  [2,] 0.03213059 0.01156953   5
##  [3,] 0.05815476 0.02460278  10
##  [4,] 0.10586948 0.05164570  20
##  [5,] 0.14745252 0.07978709  30
##  [6,] 0.18598032 0.10932347  40
##  [7,] 0.22077686 0.13985131  50
##  [8,] 0.25306744 0.17067767  60
##  [9,] 0.28552879 0.20165965  70
## [10,] 0.31851925 0.23273640  80
## [11,] 0.34946212 0.26425240  90
## [12,] 0.38052596 0.29612846 100
## 
## $SVDF
##               TP         FP       FN       TN   N precision      recall
##  [1,]  0.4857143  0.5142857 72.57679 243.4232 317 0.4857143 0.007201657
##  [2,]  2.1357143  2.8642857 70.92679 241.0732 317 0.4271429 0.031113969
##  [3,]  4.0178571  5.9821429 69.04464 237.9554 317 0.4017857 0.058556427
##  [4,]  7.3375000 12.6625000 65.72500 231.2750 317 0.3668750 0.103916994
##  [5,] 10.2642857 19.7357143 62.79821 224.2018 317 0.3421429 0.144022419
##  [6,] 13.2089286 26.7910714 59.85357 217.1464 317 0.3302232 0.184240962
##  [7,] 16.0589286 33.9410714 57.00357 209.9964 317 0.3211786 0.223408405
##  [8,] 18.7839286 41.2160714 54.27857 202.7214 317 0.3130655 0.259535975
##  [9,] 21.4767857 48.5232143 51.58571 195.4143 317 0.3068112 0.295299340
## [10,] 24.2982143 55.7017857 48.76429 188.2357 317 0.3037277 0.333443455
## [11,] 27.1339286 62.8660714 45.92857 181.0714 317 0.3014881 0.371935689
## [12,] 29.8232143 70.1767857 43.23929 173.7607 317 0.2982321 0.407457253
##               TPR         FPR   n
##  [1,] 0.007201657 0.002025358   1
##  [2,] 0.031113969 0.011331845   5
##  [3,] 0.058556427 0.023791598  10
##  [4,] 0.103916994 0.050589340  20
##  [5,] 0.144022419 0.079231513  30
##  [6,] 0.184240962 0.107775329  40
##  [7,] 0.223408405 0.136781000  50
##  [8,] 0.259535975 0.166279278  60
##  [9,] 0.295299340 0.196006663  70
## [10,] 0.333443455 0.224961977  80
## [11,] 0.371935689 0.253965717  90
## [12,] 0.407457253 0.283543368 100</code></pre>
<p>We will see from the plot how the different models perform. We see that the SVDF appear to have the best performance.</p>
<div id="fitting-the-model-1" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Fitting the model</h3>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="recommender-systems-and-customer-targeting.html#cb516-1" aria-hidden="true" tabindex="-1"></a>recommender_ibcf <span class="ot">&lt;-</span> <span class="fu">Recommender</span>(<span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;train&quot;</span>),</span>
<span id="cb516-2"><a href="recommender-systems-and-customer-targeting.html#cb516-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">&quot;IBCF&quot;</span>,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;cosine&quot;</span>))</span>
<span id="cb516-3"><a href="recommender-systems-and-customer-targeting.html#cb516-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-4"><a href="recommender-systems-and-customer-targeting.html#cb516-4" aria-hidden="true" tabindex="-1"></a>recommender_ubcf <span class="ot">&lt;-</span> <span class="fu">Recommender</span>(<span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;train&quot;</span>),</span>
<span id="cb516-5"><a href="recommender-systems-and-customer-targeting.html#cb516-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">&quot;UBCF&quot;</span>,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>))</span>
<span id="cb516-6"><a href="recommender-systems-and-customer-targeting.html#cb516-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-7"><a href="recommender-systems-and-customer-targeting.html#cb516-7" aria-hidden="true" tabindex="-1"></a>recommender_svd <span class="ot">&lt;-</span> <span class="fu">Recommender</span>(<span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;train&quot;</span>),</span>
<span id="cb516-8"><a href="recommender-systems-and-customer-targeting.html#cb516-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">method =</span> <span class="st">&quot;SVD&quot;</span>,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">k=</span><span class="dv">50</span>))</span>
<span id="cb516-9"><a href="recommender-systems-and-customer-targeting.html#cb516-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-10"><a href="recommender-systems-and-customer-targeting.html#cb516-10" aria-hidden="true" tabindex="-1"></a>recommender_svdf <span class="ot">&lt;-</span> <span class="fu">Recommender</span>(<span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;train&quot;</span>),</span>
<span id="cb516-11"><a href="recommender-systems-and-customer-targeting.html#cb516-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">method =</span> <span class="st">&quot;SVDF&quot;</span>,<span class="at">parameter =</span> <span class="fu">list</span>(<span class="at">k=</span><span class="dv">50</span>))</span>
<span id="cb516-12"><a href="recommender-systems-and-customer-targeting.html#cb516-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb516-13"><a href="recommender-systems-and-customer-targeting.html#cb516-13" aria-hidden="true" tabindex="-1"></a>items_to_recommend <span class="ot">&lt;-</span> <span class="dv">10</span></span></code></pre></div>
</div>
<div id="making-predictions-1" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Making predictions</h3>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="recommender-systems-and-customer-targeting.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Produce predictions based upon the known dataset</span></span>
<span id="cb517-2"><a href="recommender-systems-and-customer-targeting.html#cb517-2" aria-hidden="true" tabindex="-1"></a>eval_prediction_ibcf <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> recommender_ibcf</span>
<span id="cb517-3"><a href="recommender-systems-and-customer-targeting.html#cb517-3" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">newdata =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;known&quot;</span>)</span>
<span id="cb517-4"><a href="recommender-systems-and-customer-targeting.html#cb517-4" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">n =</span> items_to_recommend</span>
<span id="cb517-5"><a href="recommender-systems-and-customer-targeting.html#cb517-5" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">type =</span> <span class="st">&quot;ratings&quot;</span>)</span>
<span id="cb517-6"><a href="recommender-systems-and-customer-targeting.html#cb517-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-7"><a href="recommender-systems-and-customer-targeting.html#cb517-7" aria-hidden="true" tabindex="-1"></a>eval_prediction_ubcf <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> recommender_ubcf</span>
<span id="cb517-8"><a href="recommender-systems-and-customer-targeting.html#cb517-8" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">newdata =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;known&quot;</span>)</span>
<span id="cb517-9"><a href="recommender-systems-and-customer-targeting.html#cb517-9" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">n =</span> items_to_recommend</span>
<span id="cb517-10"><a href="recommender-systems-and-customer-targeting.html#cb517-10" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">type =</span> <span class="st">&quot;ratings&quot;</span>)</span>
<span id="cb517-11"><a href="recommender-systems-and-customer-targeting.html#cb517-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-12"><a href="recommender-systems-and-customer-targeting.html#cb517-12" aria-hidden="true" tabindex="-1"></a>eval_prediction_svd <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> recommender_svd</span>
<span id="cb517-13"><a href="recommender-systems-and-customer-targeting.html#cb517-13" aria-hidden="true" tabindex="-1"></a>                               ,<span class="at">newdata =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;known&quot;</span>)</span>
<span id="cb517-14"><a href="recommender-systems-and-customer-targeting.html#cb517-14" aria-hidden="true" tabindex="-1"></a>                               ,<span class="at">n =</span> items_to_recommend</span>
<span id="cb517-15"><a href="recommender-systems-and-customer-targeting.html#cb517-15" aria-hidden="true" tabindex="-1"></a>                               ,<span class="at">type =</span> <span class="st">&quot;ratings&quot;</span>)</span>
<span id="cb517-16"><a href="recommender-systems-and-customer-targeting.html#cb517-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-17"><a href="recommender-systems-and-customer-targeting.html#cb517-17" aria-hidden="true" tabindex="-1"></a>eval_prediction_svdf <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> recommender_svdf</span>
<span id="cb517-18"><a href="recommender-systems-and-customer-targeting.html#cb517-18" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">newdata =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;known&quot;</span>)</span>
<span id="cb517-19"><a href="recommender-systems-and-customer-targeting.html#cb517-19" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">n =</span> items_to_recommend</span>
<span id="cb517-20"><a href="recommender-systems-and-customer-targeting.html#cb517-20" aria-hidden="true" tabindex="-1"></a>                                ,<span class="at">type =</span> <span class="st">&quot;ratings&quot;</span>)</span></code></pre></div>
<p>Now we want to compare the different models on the unknown data.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="recommender-systems-and-customer-targeting.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="do">######################RANDOM######################</span></span>
<span id="cb518-2"><a href="recommender-systems-and-customer-targeting.html#cb518-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-3"><a href="recommender-systems-and-customer-targeting.html#cb518-3" aria-hidden="true" tabindex="-1"></a><span class="co">#UBCF</span></span>
<span id="cb518-4"><a href="recommender-systems-and-customer-targeting.html#cb518-4" aria-hidden="true" tabindex="-1"></a>eval_accuracy_ubcf <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-5"><a href="recommender-systems-and-customer-targeting.html#cb518-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_ubcf, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> F)</span>
<span id="cb518-6"><a href="recommender-systems-and-customer-targeting.html#cb518-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-7"><a href="recommender-systems-and-customer-targeting.html#cb518-7" aria-hidden="true" tabindex="-1"></a>eval_accuracy_ubcf_user <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-8"><a href="recommender-systems-and-customer-targeting.html#cb518-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_ubcf, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> <span class="cn">TRUE</span>)</span>
<span id="cb518-9"><a href="recommender-systems-and-customer-targeting.html#cb518-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-10"><a href="recommender-systems-and-customer-targeting.html#cb518-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;UBCF&quot;</span>)</span>
<span id="cb518-11"><a href="recommender-systems-and-customer-targeting.html#cb518-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eval_accuracy_ubcf_user)</span>
<span id="cb518-12"><a href="recommender-systems-and-customer-targeting.html#cb518-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-13"><a href="recommender-systems-and-customer-targeting.html#cb518-13" aria-hidden="true" tabindex="-1"></a><span class="co">#IBCF</span></span>
<span id="cb518-14"><a href="recommender-systems-and-customer-targeting.html#cb518-14" aria-hidden="true" tabindex="-1"></a>eval_accuracy_ibcf <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-15"><a href="recommender-systems-and-customer-targeting.html#cb518-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_ibcf, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> F)</span>
<span id="cb518-16"><a href="recommender-systems-and-customer-targeting.html#cb518-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-17"><a href="recommender-systems-and-customer-targeting.html#cb518-17" aria-hidden="true" tabindex="-1"></a>eval_accuracy_ibcf_user <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-18"><a href="recommender-systems-and-customer-targeting.html#cb518-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_ibcf, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> <span class="cn">TRUE</span>)</span>
<span id="cb518-19"><a href="recommender-systems-and-customer-targeting.html#cb518-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-20"><a href="recommender-systems-and-customer-targeting.html#cb518-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;IBCF&quot;</span>)</span>
<span id="cb518-21"><a href="recommender-systems-and-customer-targeting.html#cb518-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eval_accuracy_ibcf_user)</span>
<span id="cb518-22"><a href="recommender-systems-and-customer-targeting.html#cb518-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-23"><a href="recommender-systems-and-customer-targeting.html#cb518-23" aria-hidden="true" tabindex="-1"></a><span class="co">#SVD</span></span>
<span id="cb518-24"><a href="recommender-systems-and-customer-targeting.html#cb518-24" aria-hidden="true" tabindex="-1"></a>eval_accuracy_svd <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-25"><a href="recommender-systems-and-customer-targeting.html#cb518-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_svd, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> F)</span>
<span id="cb518-26"><a href="recommender-systems-and-customer-targeting.html#cb518-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-27"><a href="recommender-systems-and-customer-targeting.html#cb518-27" aria-hidden="true" tabindex="-1"></a>eval_accuracy_svd_user <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-28"><a href="recommender-systems-and-customer-targeting.html#cb518-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_svd, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> <span class="cn">TRUE</span>)</span>
<span id="cb518-29"><a href="recommender-systems-and-customer-targeting.html#cb518-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-30"><a href="recommender-systems-and-customer-targeting.html#cb518-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;SVD&quot;</span>)</span>
<span id="cb518-31"><a href="recommender-systems-and-customer-targeting.html#cb518-31" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eval_accuracy_svd_user)</span>
<span id="cb518-32"><a href="recommender-systems-and-customer-targeting.html#cb518-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-33"><a href="recommender-systems-and-customer-targeting.html#cb518-33" aria-hidden="true" tabindex="-1"></a><span class="co">#SVDF</span></span>
<span id="cb518-34"><a href="recommender-systems-and-customer-targeting.html#cb518-34" aria-hidden="true" tabindex="-1"></a>eval_accuracy_svdf <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-35"><a href="recommender-systems-and-customer-targeting.html#cb518-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_svdf, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> F)</span>
<span id="cb518-36"><a href="recommender-systems-and-customer-targeting.html#cb518-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-37"><a href="recommender-systems-and-customer-targeting.html#cb518-37" aria-hidden="true" tabindex="-1"></a>eval_accuracy_svdf_user <span class="ot">&lt;-</span> <span class="fu">calcPredictionAccuracy</span>(</span>
<span id="cb518-38"><a href="recommender-systems-and-customer-targeting.html#cb518-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> eval_prediction_svdf, <span class="at">data =</span> <span class="fu">getData</span>(eval_sets, <span class="st">&quot;unknown&quot;</span>), <span class="at">byUser =</span> <span class="cn">TRUE</span>)</span>
<span id="cb518-39"><a href="recommender-systems-and-customer-targeting.html#cb518-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-40"><a href="recommender-systems-and-customer-targeting.html#cb518-40" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;SVDF&quot;</span>)</span>
<span id="cb518-41"><a href="recommender-systems-and-customer-targeting.html#cb518-41" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(eval_accuracy_svdf_user)</span></code></pre></div>
<pre><code>## [1] &quot;UBCF&quot;
##         RMSE       MSE       MAE
## 6  1.0903114 1.1887789 0.9020429
## 10 0.6478319 0.4196862 0.4956284
## 14 1.6074909 2.5840271 1.2409350
## 18 0.9514405 0.9052391 0.7995348
## 28 0.8863502 0.7856166 0.7355511
## 37 0.8162697 0.6662963 0.6304372
## [1] &quot;IBCF&quot;
##         RMSE       MSE       MAE
## 6  1.4052207 1.9746452 1.0919266
## 10 0.7318435 0.5355949 0.5587116
## 14 1.4211250 2.0195963 0.9920766
## 18 1.1829320 1.3993280 0.9567777
## 28 1.2659009 1.6025052 1.0011266
## 37 1.4958532 2.2375768 1.1161399
## [1] &quot;SVD&quot;
##         RMSE       MSE       MAE
## 6  1.0528300 1.1084509 0.8102372
## 10 0.5864089 0.3438754 0.4807015
## 14 1.3151982 1.7297463 0.9978417
## 18 0.8516606 0.7253258 0.7415427
## 28 0.9625632 0.9265279 0.7596821
## 37 0.7845724 0.6155538 0.5981831
## [1] &quot;SVDF&quot;
##         RMSE       MSE       MAE
## 6  0.9054762 0.8198871 0.7159928
## 10 0.5111024 0.2612257 0.4266370
## 14 1.4040173 1.9712646 1.0372160
## 18 0.7968216 0.6349246 0.6966087
## 28 0.8546096 0.7303576 0.6960481
## 37 0.8371373 0.7007988 0.6414081</code></pre>
<p>We can then assess the RMSE for each model.</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="recommender-systems-and-customer-targeting.html#cb520-1" aria-hidden="true" tabindex="-1"></a>eval_accuracy_ubcf</span>
<span id="cb520-2"><a href="recommender-systems-and-customer-targeting.html#cb520-2" aria-hidden="true" tabindex="-1"></a>eval_accuracy_ibcf</span>
<span id="cb520-3"><a href="recommender-systems-and-customer-targeting.html#cb520-3" aria-hidden="true" tabindex="-1"></a>eval_accuracy_svd</span>
<span id="cb520-4"><a href="recommender-systems-and-customer-targeting.html#cb520-4" aria-hidden="true" tabindex="-1"></a>eval_accuracy_svdf</span></code></pre></div>
<pre><code>##      RMSE       MSE       MAE 
## 1.0380870 1.0776245 0.8154369 
##     RMSE      MSE      MAE 
## 1.335593 1.783809 1.020383 
##      RMSE       MSE       MAE 
## 0.9845277 0.9692949 0.7907637 
##      RMSE       MSE       MAE 
## 0.9063570 0.8214830 0.7075204</code></pre>
<p>We see that the SVDF appear to do the best.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="customer-satisfaction-and-loyalty.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="probabilistic-models-for-customer-analytics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
