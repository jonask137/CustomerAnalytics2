<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Customer Satisfaction and Loyalty | Customer Analytics</title>
  <meta name="description" content="2 Customer Satisfaction and Loyalty | Customer Analytics" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Customer Satisfaction and Loyalty | Customer Analytics" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Customer Satisfaction and Loyalty | Customer Analytics" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="customer-lifetime-value.html"/>
<link rel="next" href="recommender-systems-and-customer-targeting.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
<script src="libs/vis-4.20.1/vis.min.js"></script>
<script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>setup</a></li>
<li class="chapter" data-level="1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html"><i class="fa fa-check"></i><b>1</b> Customer Lifetime Value</a>
<ul>
<li class="chapter" data-level="1.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#non-contractual-the-matrix-formulation-migration-model"><i class="fa fa-check"></i><b>1.1</b> Non-contractual: The matrix formulation (Migration model)</a></li>
<li class="chapter" data-level="1.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#contractual-valuing-customer-base-residual-lifetime-value"><i class="fa fa-check"></i><b>1.2</b> Contractual: Valuing customer base + residual lifetime value</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#sbg-shifted-beta-geometric-model"><i class="fa fa-check"></i><b>1.2.1</b> sBG (Shifted Beta Geometric model)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#non-contractual-setting-probabilitic-models"><i class="fa fa-check"></i><b>1.3</b> Non-Contractual Setting: Probabilitic Models</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#paretonbd-vs.-bgnbd"><i class="fa fa-check"></i><b>1.3.1</b> Pareto/NBD vs. BG/NBD</a></li>
<li class="chapter" data-level="1.3.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#paretonbd"><i class="fa fa-check"></i><b>1.3.2</b> Pareto/NBD</a>
<ul>
<li class="chapter" data-level="1.3.2.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#data-preparation"><i class="fa fa-check"></i><b>1.3.2.1</b> Data preparation</a></li>
<li class="chapter" data-level="1.3.2.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#parameter-estimation"><i class="fa fa-check"></i><b>1.3.2.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="1.3.2.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#individual-level-estimations"><i class="fa fa-check"></i><b>1.3.2.3</b> Individual Level Estimations</a></li>
<li class="chapter" data-level="1.3.2.4" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#plotting-goodness-of-fit"><i class="fa fa-check"></i><b>1.3.2.4</b> Plotting / Goodness-of-fit</a></li>
</ul></li>
<li class="chapter" data-level="1.3.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#bgnbd"><i class="fa fa-check"></i><b>1.3.3</b> BG/NBD</a>
<ul>
<li class="chapter" data-level="1.3.3.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#data-preparation-1"><i class="fa fa-check"></i><b>1.3.3.1</b> Data Preparation</a></li>
<li class="chapter" data-level="1.3.3.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#parameter-estimation-1"><i class="fa fa-check"></i><b>1.3.3.2</b> Parameter Estimation</a></li>
<li class="chapter" data-level="1.3.3.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#individual-level-estimation"><i class="fa fa-check"></i><b>1.3.3.3</b> Individual Level Estimation</a></li>
<li class="chapter" data-level="1.3.3.4" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#plotting-goodness-of-fit-1"><i class="fa fa-check"></i><b>1.3.3.4</b> Plotting / Goodness-of-fit</a></li>
</ul></li>
<li class="chapter" data-level="1.3.4" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#bgbb---not-curicullum"><i class="fa fa-check"></i><b>1.3.4</b> BG/BB - Not curicullum</a></li>
<li class="chapter" data-level="1.3.5" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#examples-from-the-lecture"><i class="fa fa-check"></i><b>1.3.5</b> Examples from the lecture</a>
<ul>
<li class="chapter" data-level="1.3.5.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#paretonbd-1"><i class="fa fa-check"></i><b>1.3.5.1</b> Pareto/NBD</a>
<ul>
<li class="chapter" data-level="1.3.5.1.1" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#estimate-parameters-for-paretonbd-model-based-upon-calibration-data"><i class="fa fa-check"></i><b>1.3.5.1.1</b> Estimate parameters for Pareto/NBD model based upon calibration data</a></li>
</ul></li>
<li class="chapter" data-level="1.3.5.2" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#dert-calculation"><i class="fa fa-check"></i><b>1.3.5.2</b> DERT Calculation</a></li>
<li class="chapter" data-level="1.3.5.3" data-path="customer-lifetime-value.html"><a href="customer-lifetime-value.html#bgnbg-example"><i class="fa fa-check"></i><b>1.3.5.3</b> BG/NBG example</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html"><i class="fa fa-check"></i><b>2</b> Customer Satisfaction and Loyalty</a>
<ul>
<li class="chapter" data-level="2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#customer-surveys"><i class="fa fa-check"></i><b>2.1</b> Customer surveys</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#concepts-and-examples"><i class="fa fa-check"></i><b>2.1.1</b> (1) Concepts and examples</a></li>
<li class="chapter" data-level="2.1.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#sampling-and-response-rate"><i class="fa fa-check"></i><b>2.1.2</b> (2) Sampling and response rate</a></li>
<li class="chapter" data-level="2.1.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#pretesting-and-measurement-validity"><i class="fa fa-check"></i><b>2.1.3</b> (3) Pretesting and measurement validity</a></li>
<li class="chapter" data-level="2.1.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#questionnaire-design"><i class="fa fa-check"></i><b>2.1.4</b> (4) Questionnaire design</a></li>
<li class="chapter" data-level="2.1.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#simple-size"><i class="fa fa-check"></i><b>2.1.5</b> (5) Simple size</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#nps"><i class="fa fa-check"></i><b>2.2</b> NPS</a></li>
<li class="chapter" data-level="2.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#cfa-and-sem-application-lavann"><i class="fa fa-check"></i><b>2.3</b> CFA and SEM Application Lavann</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#business-problem-objectives"><i class="fa fa-check"></i><b>2.3.1</b> Business Problem &amp; Objectives</a></li>
<li class="chapter" data-level="2.3.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#data"><i class="fa fa-check"></i><b>2.3.2</b> Data</a>
<ul>
<li class="chapter" data-level="2.3.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#efa"><i class="fa fa-check"></i><b>2.3.2.1</b> EFA</a></li>
<li class="chapter" data-level="2.3.2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#cfa-model"><i class="fa fa-check"></i><b>2.3.2.2</b> CFA model</a>
<ul>
<li class="chapter" data-level="2.3.2.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#initial-model"><i class="fa fa-check"></i><b>2.3.2.2.1</b> Initial model</a></li>
<li class="chapter" data-level="2.3.2.2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#second-model"><i class="fa fa-check"></i><b>2.3.2.2.2</b> Second model</a>
<ul>
<li class="chapter" data-level="2.3.2.2.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#intepretation-of-the-model"><i class="fa fa-check"></i><b>2.3.2.2.2.1</b> Intepretation of the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.3.2.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#sem"><i class="fa fa-check"></i><b>2.3.2.3</b> SEM</a></li>
</ul></li>
<li class="chapter" data-level="2.3.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#plotting-the-model"><i class="fa fa-check"></i><b>2.3.3</b> Plotting the model</a></li>
<li class="chapter" data-level="2.3.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#consider-a-more-complex-sem-model-involving-a-mediating-effect."><i class="fa fa-check"></i><b>2.3.4</b> Consider a more complex SEM model involving a mediating effect.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#pls"><i class="fa fa-check"></i><b>2.4</b> PLS</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#definition-of-pls"><i class="fa fa-check"></i><b>2.4.1</b> Definition of PLS</a></li>
<li class="chapter" data-level="2.4.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#when-to-use-pls-and-when-to-use-sem"><i class="fa fa-check"></i><b>2.4.2</b> When to use PLS and when to use SEM</a></li>
<li class="chapter" data-level="2.4.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#model-construction"><i class="fa fa-check"></i><b>2.4.3</b> Model construction</a></li>
<li class="chapter" data-level="2.4.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#model-estimation"><i class="fa fa-check"></i><b>2.4.4</b> Model Estimation</a></li>
<li class="chapter" data-level="2.4.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#model-evaluation"><i class="fa fa-check"></i><b>2.4.5</b> Model evaluation</a></li>
<li class="chapter" data-level="2.4.6" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#example-for-the-lecture"><i class="fa fa-check"></i><b>2.4.6</b> Example for the lecture</a>
<ul>
<li class="chapter" data-level="2.4.6.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#making-structural--and-measurement-model"><i class="fa fa-check"></i><b>2.4.6.1</b> Making structural- and measurement model</a></li>
<li class="chapter" data-level="2.4.6.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#now-we-can-estimate-the-model"><i class="fa fa-check"></i><b>2.4.6.2</b> Now we can estimate the model</a></li>
<li class="chapter" data-level="2.4.6.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#measuring-quality-of-the-constructs"><i class="fa fa-check"></i><b>2.4.6.3</b> Measuring quality of the constructs</a></li>
<li class="chapter" data-level="2.4.6.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#are-the-coefficients-significant"><i class="fa fa-check"></i><b>2.4.6.4</b> Are the coefficients significant?</a></li>
</ul></li>
<li class="chapter" data-level="2.4.7" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#revised-code"><i class="fa fa-check"></i><b>2.4.7</b> Revised code</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#segmentation-clustering"><i class="fa fa-check"></i><b>2.5</b> Segmentation (Clustering)</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#what-is-clustering"><i class="fa fa-check"></i><b>2.5.1</b> What is clustering</a></li>
<li class="chapter" data-level="2.5.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#clustering-techniques"><i class="fa fa-check"></i><b>2.5.2</b> Clustering techniques</a></li>
<li class="chapter" data-level="2.5.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#an-example-with-hbat"><i class="fa fa-check"></i><b>2.5.3</b> An example with HBAT</a>
<ul>
<li class="chapter" data-level="2.5.3.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#background"><i class="fa fa-check"></i><b>2.5.3.1</b> 1. Background</a>
<ul>
<li class="chapter" data-level="2.5.3.1.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#the-primary-objective-is"><i class="fa fa-check"></i><b>2.5.3.1.1</b> 1.1. The primary objective is:</a></li>
</ul></li>
<li class="chapter" data-level="2.5.3.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#the-data-data-understanding-phase"><i class="fa fa-check"></i><b>2.5.3.2</b> 2. The data (Data Understanding Phase)</a>
<ul>
<li class="chapter" data-level="2.5.3.2.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#load-data-correctly"><i class="fa fa-check"></i><b>2.5.3.2.1</b> 2.1 Load data correctly</a></li>
<li class="chapter" data-level="2.5.3.2.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#check-if-the-data-is-numerical-or-categorical"><i class="fa fa-check"></i><b>2.5.3.2.2</b> 2.2 Check if the data is numerical or categorical</a></li>
<li class="chapter" data-level="2.5.3.2.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#missing-treatment"><i class="fa fa-check"></i><b>2.5.3.2.3</b> 2.3 Missing treatment</a></li>
<li class="chapter" data-level="2.5.3.2.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#select-relevant-variables"><i class="fa fa-check"></i><b>2.5.3.2.4</b> 2.4 Select relevant variables</a></li>
<li class="chapter" data-level="2.5.3.2.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#identify-extreme-outliers-the-most-dissimilar-customers"><i class="fa fa-check"></i><b>2.5.3.2.5</b> 2.5.Identify extreme outliers (the most dissimilar customers)</a></li>
<li class="chapter" data-level="2.5.3.2.6" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#standardize-the-variables-mean0-std.dev1"><i class="fa fa-check"></i><b>2.5.3.2.6</b> 2.6 Standardize the variables (mean=0, std.dev=1)</a></li>
</ul></li>
<li class="chapter" data-level="2.5.3.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#hierarchical-clustering-using-variables"><i class="fa fa-check"></i><b>2.5.3.3</b> 3. Hierarchical clustering (using variables)</a></li>
<li class="chapter" data-level="2.5.3.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#hierarchical-clustering-using-pcs-score-vectors"><i class="fa fa-check"></i><b>2.5.3.4</b> 4. Hierarchical clustering (using PCs score vectors)</a></li>
<li class="chapter" data-level="2.5.3.5" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#k-means"><i class="fa fa-check"></i><b>2.5.3.5</b> 5. K-means</a></li>
<li class="chapter" data-level="2.5.3.6" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#validation-and-profiling-the-clusters"><i class="fa fa-check"></i><b>2.5.3.6</b> 6. Validation and profiling the clusters</a>
<ul>
<li class="chapter" data-level="2.5.3.6.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#assessing-cluster-stability"><i class="fa fa-check"></i><b>2.5.3.6.1</b> 6.1. Assessing cluster stability</a></li>
<li class="chapter" data-level="2.5.3.6.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#assessing-criterion-predictive-validity"><i class="fa fa-check"></i><b>2.5.3.6.2</b> 6.2. Assessing criterion (predictive) validity</a></li>
<li class="chapter" data-level="2.5.3.6.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#profiling-the-final-cluster-solution"><i class="fa fa-check"></i><b>2.5.3.6.3</b> 6.3. Profiling the final cluster solution</a></li>
</ul></li>
<li class="chapter" data-level="2.5.3.7" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#final-remarks"><i class="fa fa-check"></i><b>2.5.3.7</b> 7. Final remarks</a></li>
</ul></li>
<li class="chapter" data-level="2.5.4" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#an-example-with-mcdonalds-data"><i class="fa fa-check"></i><b>2.5.4</b> An example with McDonalds data</a>
<ul>
<li class="chapter" data-level="2.5.4.1" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#loading-and-exploring-the-data"><i class="fa fa-check"></i><b>2.5.4.1</b> Loading and exploring the data</a></li>
<li class="chapter" data-level="2.5.4.2" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#k-means-clustering"><i class="fa fa-check"></i><b>2.5.4.2</b> k-Means clustering</a></li>
<li class="chapter" data-level="2.5.4.3" data-path="customer-satisfaction-and-loyalty.html"><a href="customer-satisfaction-and-loyalty.html#interpreting-the-clusters"><i class="fa fa-check"></i><b>2.5.4.3</b> Interpreting the clusters</a></li>
</ul></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html"><i class="fa fa-check"></i><b>3</b> Recommender Systems and Customer Targeting</a>
<ul>
<li class="chapter" data-level="3.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#association-rule"><i class="fa fa-check"></i><b>3.1</b> Association rule</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-and-data-exploration"><i class="fa fa-check"></i><b>3.1.1</b> Loading and data exploration</a></li>
<li class="chapter" data-level="3.1.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#data-preprocessing"><i class="fa fa-check"></i><b>3.1.2</b> Data preprocessing</a>
<ul>
<li class="chapter" data-level="3.1.2.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#encoding-to-correct-data-types"><i class="fa fa-check"></i><b>3.1.2.1</b> Encoding to correct data types</a></li>
<li class="chapter" data-level="3.1.2.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#create-a-data-frame-with-one-row-pr.-invoice"><i class="fa fa-check"></i><b>3.1.2.2</b> Create a data frame with one row pr. invoice</a></li>
</ul></li>
<li class="chapter" data-level="3.1.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-transactions"><i class="fa fa-check"></i><b>3.1.3</b> Loading transactions</a></li>
<li class="chapter" data-level="3.1.4" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#plotting"><i class="fa fa-check"></i><b>3.1.4</b> Plotting</a></li>
<li class="chapter" data-level="3.1.5" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#apriori-calculation"><i class="fa fa-check"></i><b>3.1.5</b> Apriori calculation</a>
<ul>
<li class="chapter" data-level="3.1.5.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#another-example-where-maxlen-3"><i class="fa fa-check"></i><b>3.1.5.1</b> Another example where maxlen = 3</a></li>
<li class="chapter" data-level="3.1.5.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#filtering-on-right-hand-side.-an-example-with-the-item-metal"><i class="fa fa-check"></i><b>3.1.5.2</b> Filtering on right hand side. An example with the item {METAL}</a></li>
<li class="chapter" data-level="3.1.5.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#filtering-on-left-hand-side.-an-example-with-the-item-metal"><i class="fa fa-check"></i><b>3.1.5.3</b> Filtering on left hand side. An example with the item {METAL}</a></li>
</ul></li>
<li class="chapter" data-level="3.1.6" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#plotting-association-rules"><i class="fa fa-check"></i><b>3.1.6</b> Plotting association rules</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#colaborative-filtering"><i class="fa fa-check"></i><b>3.2</b> Colaborative filtering</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-and-formatting-data"><i class="fa fa-check"></i><b>3.2.1</b> Loading and formatting data</a>
<ul>
<li class="chapter" data-level="3.2.1.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#loading-metadata-that-gets-loaded-with-main-dataset"><i class="fa fa-check"></i><b>3.2.1.1</b> Loading metadata that gets loaded with main dataset</a></li>
</ul></li>
<li class="chapter" data-level="3.2.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#data-exploration"><i class="fa fa-check"></i><b>3.2.2</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="3.2.2.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#plotting-1"><i class="fa fa-check"></i><b>3.2.2.1</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="3.2.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#what-models-can-we-use"><i class="fa fa-check"></i><b>3.2.3</b> What models can we use?</a></li>
<li class="chapter" data-level="3.2.4" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#training-and-test-set"><i class="fa fa-check"></i><b>3.2.4</b> Training and test set</a></li>
<li class="chapter" data-level="3.2.5" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#a-small-example-with-ibcf-item-based"><i class="fa fa-check"></i><b>3.2.5</b> A small example with IBCF (item based)</a></li>
<li class="chapter" data-level="3.2.6" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#ubcf---user-based-collaborative-based"><i class="fa fa-check"></i><b>3.2.6</b> UBCF - User based collaborative based</a>
<ul>
<li class="chapter" data-level="3.2.6.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#fitting-the-model"><i class="fa fa-check"></i><b>3.2.6.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.2.6.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#predicting-making-recommendations"><i class="fa fa-check"></i><b>3.2.6.2</b> Predicting (making) recommendations</a></li>
</ul></li>
<li class="chapter" data-level="3.2.7" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#cross-validation"><i class="fa fa-check"></i><b>3.2.7</b> Cross validation</a></li>
<li class="chapter" data-level="3.2.8" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#ibcf---item-based-collaborative-based"><i class="fa fa-check"></i><b>3.2.8</b> IBCF - Item based collaborative based</a>
<ul>
<li class="chapter" data-level="3.2.8.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#fitting-the-model-using-cv"><i class="fa fa-check"></i><b>3.2.8.1</b> Fitting the model (using CV)</a></li>
<li class="chapter" data-level="3.2.8.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#making-predictions"><i class="fa fa-check"></i><b>3.2.8.2</b> Making predictions</a></li>
<li class="chapter" data-level="3.2.8.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#performance-metrics"><i class="fa fa-check"></i><b>3.2.8.3</b> Performance metrics</a></li>
</ul></li>
<li class="chapter" data-level="3.2.9" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#building-roc-curve-and-precision-recall-rate"><i class="fa fa-check"></i><b>3.2.9</b> Building ROC curve and precision / recall rate</a></li>
<li class="chapter" data-level="3.2.10" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#comparing-ubcf-and-ibcf"><i class="fa fa-check"></i><b>3.2.10</b> Comparing UBCF and IBCF</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#latent-factor-models"><i class="fa fa-check"></i><b>3.3</b> Latent Factor Models</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#fitting-the-model-1"><i class="fa fa-check"></i><b>3.3.1</b> Fitting the model</a></li>
<li class="chapter" data-level="3.3.2" data-path="recommender-systems-and-customer-targeting.html"><a href="recommender-systems-and-customer-targeting.html#making-predictions-1"><i class="fa fa-check"></i><b>3.3.2</b> Making predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html"><i class="fa fa-check"></i><b>4</b> Probabilistic Models for Customer Analytics</a>
<ul>
<li class="chapter" data-level="4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#bayesian-networks"><i class="fa fa-check"></i><b>4.1</b> Bayesian Networks</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#why-bayesian"><i class="fa fa-check"></i><b>4.1.1</b> <strong><em>Why Bayesian?</em></strong></a>
<ul>
<li class="chapter" data-level="4.1.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#many-names-for-bayesian-networks"><i class="fa fa-check"></i><b>4.1.1.1</b> <strong>Many names for Bayesian Networks</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#terms-and-explanatory-examples"><i class="fa fa-check"></i><b>4.1.2</b> Terms and explanatory examples</a>
<ul>
<li class="chapter" data-level="4.1.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#types-of-connections"><i class="fa fa-check"></i><b>4.1.2.1</b> Types of connections</a></li>
<li class="chapter" data-level="4.1.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#variable-selection-based-on-a-bayesian-network"><i class="fa fa-check"></i><b>4.1.2.2</b> Variable selection based on a Bayesian Network</a></li>
</ul></li>
<li class="chapter" data-level="4.1.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#independence"><i class="fa fa-check"></i><b>4.1.3</b> Independence</a></li>
<li class="chapter" data-level="4.1.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#methods-for-identifying-the-network"><i class="fa fa-check"></i><b>4.1.4</b> Methods for identifying the network</a>
<ul>
<li class="chapter" data-level="4.1.4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#algorithms-focused-on-causality-discovery"><i class="fa fa-check"></i><b>4.1.4.1</b> 1. <strong><em>Algorithms focused on causality discovery</em></strong></a></li>
<li class="chapter" data-level="4.1.4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#algorithms-focused-on-prediction"><i class="fa fa-check"></i><b>4.1.4.2</b> 2. <strong><em>Algorithms focused on prediction</em></strong></a></li>
</ul></li>
<li class="chapter" data-level="4.1.5" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#real-life-application"><i class="fa fa-check"></i><b>4.1.5</b> <strong>Real life application</strong></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#application-1-explaining-and-predicting-customer-retention-in-a-virtual-community"><i class="fa fa-check"></i><b>4.2</b> Application 1: Explaining and Predicting Customer Retention in a Virtual Community</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#getting-the-structure"><i class="fa fa-check"></i><b>4.2.1</b> 1. Getting the structure</a>
<ul>
<li class="chapter" data-level="4.2.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#a.-building-the-structure-and-parameters-manually"><i class="fa fa-check"></i><b>4.2.1.1</b> A. Building the structure and parameters manually</a>
<ul>
<li class="chapter" data-level="4.2.1.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#approaches-to-make-the-network"><i class="fa fa-check"></i><b>4.2.1.1.1</b> Approaches to make the network</a>
<ul>
<li class="chapter" data-level="4.2.1.1.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#i-first-approach"><i class="fa fa-check"></i><b>4.2.1.1.1.1</b> (i) First approach</a></li>
<li class="chapter" data-level="4.2.1.1.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#ii-second-approach"><i class="fa fa-check"></i><b>4.2.1.1.1.2</b> (ii) Second approach</a></li>
<li class="chapter" data-level="4.2.1.1.1.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#iii-third-approach"><i class="fa fa-check"></i><b>4.2.1.1.1.3</b> (iii) Third approach</a></li>
</ul></li>
<li class="chapter" data-level="4.2.1.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#loadingentering-data"><i class="fa fa-check"></i><b>4.2.1.1.2</b> Loading/entering data</a></li>
<li class="chapter" data-level="4.2.1.1.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#conditional-probability-table-cpt"><i class="fa fa-check"></i><b>4.2.1.1.3</b> Conditional probability table (CPT)</a></li>
</ul></li>
<li class="chapter" data-level="4.2.1.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#b.-learning-the-structure-and-parameters-from-observational-data"><i class="fa fa-check"></i><b>4.2.1.2</b> B. Learning the structure and parameters from observational data</a>
<ul>
<li class="chapter" data-level="4.2.1.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#grow-shrink-gs---learning-a-structure-using-a-constrained-based-algorithm"><i class="fa fa-check"></i><b>4.2.1.2.1</b> Grow-shrink (gs) - Learning a structure using a constrained-based algorithm</a>
<ul>
<li class="chapter" data-level="4.2.1.2.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#identifying-undirectred-links"><i class="fa fa-check"></i><b>4.2.1.2.1.1</b> Identifying undirectred links</a></li>
</ul></li>
<li class="chapter" data-level="4.2.1.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#hill-climbing-hc---learning-the-structure-using-a-score-based-algorithm"><i class="fa fa-check"></i><b>4.2.1.2.2</b> Hill-Climbing (hc) - Learning the structure using a score-based algorithm</a></li>
<li class="chapter" data-level="4.2.1.2.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#fitting-the-model-to-the-data-learning-the-probabilities"><i class="fa fa-check"></i><b>4.2.1.2.3</b> Fitting the model to the data (learning the probabilities)</a></li>
<li class="chapter" data-level="4.2.1.2.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#alternatives-to-grow-shrink-and-hc"><i class="fa fa-check"></i><b>4.2.1.2.4</b> Alternatives to Grow-Shrink and HC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#model-evaluation-1"><i class="fa fa-check"></i><b>4.2.2</b> 2. Model evaluation</a>
<ul>
<li class="chapter" data-level="4.2.2.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#i.-metrics-of-model-complexity"><i class="fa fa-check"></i><b>4.2.2.1</b> I. Metrics of model complexity</a></li>
<li class="chapter" data-level="4.2.2.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#ii.-metrics-of-model-sensitivity"><i class="fa fa-check"></i><b>4.2.2.2</b> II. Metrics of model sensitivity</a></li>
<li class="chapter" data-level="4.2.2.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#iii.-evaluate-the-arc.strength"><i class="fa fa-check"></i><b>4.2.2.3</b> III. Evaluate the arc.strength()</a>
<ul>
<li class="chapter" data-level="4.2.2.3.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#for-the-growth-shrink"><i class="fa fa-check"></i><b>4.2.2.3.1</b> For the growth shrink</a></li>
<li class="chapter" data-level="4.2.2.3.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#for-the-hill-climbing-structure"><i class="fa fa-check"></i><b>4.2.2.3.2</b> For the hill-climbing structure</a></li>
<li class="chapter" data-level="4.2.2.3.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#different-information-criteria-evaluations"><i class="fa fa-check"></i><b>4.2.2.3.3</b> Different information criteria evaluations</a></li>
</ul></li>
<li class="chapter" data-level="4.2.2.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#iv.-metrics-of-predictive-accuracy-error-rate-confusion-matrix-auc"><i class="fa fa-check"></i><b>4.2.2.4</b> IV. Metrics of predictive accuracy (error rate, confusion matrix, AUC)</a>
<ul>
<li class="chapter" data-level="4.2.2.4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#cross-validation-1"><i class="fa fa-check"></i><b>4.2.2.4.1</b> Cross validation</a></li>
<li class="chapter" data-level="4.2.2.4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#alternative-approach-to-fit-and-predict-without-grain"><i class="fa fa-check"></i><b>4.2.2.4.2</b> Alternative approach to fit and predict (Without gRain)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.2.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#making-inference-and-queries-based-on-the-model"><i class="fa fa-check"></i><b>4.2.3</b> 3. Making inference and queries based on the model</a>
<ul>
<li class="chapter" data-level="4.2.3.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#diagnostics-forward-inference"><i class="fa fa-check"></i><b>4.2.3.1</b> Diagnostics (Forward inference)</a>
<ul>
<li class="chapter" data-level="4.2.3.1.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#let-us-repeat-the-same-analysis-by-setting-evidence-in-pleasure"><i class="fa fa-check"></i><b>4.2.3.1.1</b> <em>let us repeat the same analysis by setting evidence in Pleasure</em></a></li>
</ul></li>
<li class="chapter" data-level="4.2.3.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#diagnostic-backward-inference"><i class="fa fa-check"></i><b>4.2.3.2</b> Diagnostic (Backward inference)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#application-2-identifying-populations-with-positive-expected-lift-in-profit-elp-and-targeting"><i class="fa fa-check"></i><b>4.3</b> Application 2: Identifying populations with Positive Expected Lift in Profit (ELP) and targeting</a></li>
<li class="chapter" data-level="4.4" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#application-3-product-recommendation-using-probabilistic-models-bn"><i class="fa fa-check"></i><b>4.4</b> Application 3: Product Recommendation using Probabilistic Models (BN)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#method-1-learn-the-probabilistic-relationships-using-a-bayesian-network-learning"><i class="fa fa-check"></i><b>4.4.1</b> Method 1: Learn the probabilistic relationships using a Bayesian network learning</a></li>
<li class="chapter" data-level="4.4.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#method-2-finding-latent-segments"><i class="fa fa-check"></i><b>4.4.2</b> Method 2: Finding latent segments</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#latent-models-for-cross-selling-and-acquisition-sequence"><i class="fa fa-check"></i><b>4.5</b> Latent models for cross selling and acquisition sequence</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#latent-trait-model---applying-the-ltm-package-in-r"><i class="fa fa-check"></i><b>4.5.1</b> Latent Trait Model - Applying the LTM Package in R</a></li>
<li class="chapter" data-level="4.5.2" data-path="probabilistic-models-for-customer-analytics.html"><a href="probabilistic-models-for-customer-analytics.html#the-latent-hidden-markov-model"><i class="fa fa-check"></i><b>4.5.2</b> The latent (hidden) Markov model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="customer-behavior.html"><a href="customer-behavior.html"><i class="fa fa-check"></i><b>5</b> Customer behavior</a>
<ul>
<li class="chapter" data-level="5.1" data-path="customer-behavior.html"><a href="customer-behavior.html#characteristics-of-cliskstream"><i class="fa fa-check"></i><b>5.1</b> Characteristics of cliskstream</a></li>
<li class="chapter" data-level="5.2" data-path="customer-behavior.html"><a href="customer-behavior.html#applications-with-clickstream-data"><i class="fa fa-check"></i><b>5.2</b> Applications with clickstream data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="customer-behavior.html"><a href="customer-behavior.html#a-motivating-example"><i class="fa fa-check"></i><b>5.2.1</b> A motivating example</a>
<ul>
<li class="chapter" data-level="5.2.1.1" data-path="customer-behavior.html"><a href="customer-behavior.html#i-predict-either-the-next-click-or-the-ﬁnal-click-state-of-a-customer."><i class="fa fa-check"></i><b>5.2.1.1</b> i) Predict either the next click or the ﬁnal click (state) of a customer.</a></li>
<li class="chapter" data-level="5.2.1.2" data-path="customer-behavior.html"><a href="customer-behavior.html#ii-clustering-and-generalizing-upon-clickstreams"><i class="fa fa-check"></i><b>5.2.1.2</b> ii) Clustering and generalizing upon clickstreams</a></li>
</ul></li>
<li class="chapter" data-level="5.2.2" data-path="customer-behavior.html"><a href="customer-behavior.html#second-exercise-clickstream-more-extensive"><i class="fa fa-check"></i><b>5.2.2</b> Second exercise (clickstream) more extensive</a></li>
<li class="chapter" data-level="5.2.3" data-path="customer-behavior.html"><a href="customer-behavior.html#a-concrete-eaxmple-with-real-data"><i class="fa fa-check"></i><b>5.2.3</b> A concrete eaxmple with real data</a>
<ul>
<li class="chapter" data-level="5.2.3.1" data-path="customer-behavior.html"><a href="customer-behavior.html#markov-chain"><i class="fa fa-check"></i><b>5.2.3.1</b> (1) Markov Chain</a></li>
<li class="chapter" data-level="5.2.3.2" data-path="customer-behavior.html"><a href="customer-behavior.html#using-association-rule-mining"><i class="fa fa-check"></i><b>5.2.3.2</b> (2) Using association rule mining</a></li>
<li class="chapter" data-level="5.2.3.3" data-path="customer-behavior.html"><a href="customer-behavior.html#use-frequencies-instead-of-the-sequence"><i class="fa fa-check"></i><b>5.2.3.3</b> (3) Use frequencies instead of the sequence</a></li>
<li class="chapter" data-level="5.2.3.4" data-path="customer-behavior.html"><a href="customer-behavior.html#neural-networks"><i class="fa fa-check"></i><b>5.2.3.4</b> (4) Neural networks</a></li>
</ul></li>
<li class="chapter" data-level="5.2.4" data-path="customer-behavior.html"><a href="customer-behavior.html#optional-exercise"><i class="fa fa-check"></i><b>5.2.4</b> Optional exercise</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="customer-behavior.html"><a href="customer-behavior.html#ab-testing"><i class="fa fa-check"></i><b>5.3</b> AB Testing</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="customer-behavior.html"><a href="customer-behavior.html#what-is-it-and-when-to-apply-it"><i class="fa fa-check"></i><b>5.3.1</b> (1 + 2): What is it and when to apply it</a></li>
<li class="chapter" data-level="5.3.2" data-path="customer-behavior.html"><a href="customer-behavior.html#how-to-perform-an-ab-test"><i class="fa fa-check"></i><b>5.3.2</b> (3): How to perform an A/B test</a></li>
<li class="chapter" data-level="5.3.3" data-path="customer-behavior.html"><a href="customer-behavior.html#pitfalls-and-challenges."><i class="fa fa-check"></i><b>5.3.3</b> (4): Pitfalls and challenges.</a></li>
<li class="chapter" data-level="5.3.4" data-path="customer-behavior.html"><a href="customer-behavior.html#ab-tests-and-bandits."><i class="fa fa-check"></i><b>5.3.4</b> (5): A/B tests and bandits.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="privacy.html"><a href="privacy.html"><i class="fa fa-check"></i><b>6</b> Privacy</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Customer Analytics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="customer-satisfaction-and-loyalty" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Customer Satisfaction and Loyalty</h1>
<p>I’ll start of with some notes on constructing a survey.</p>
<div id="customer-surveys" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Customer surveys</h2>
<p>The following sections are separated into five subsections:</p>
<ol style="list-style-type: decimal">
<li>Concepts and examples</li>
<li>Sampling and response rate</li>
<li>Pretesting and measurement validity</li>
<li>Questionnaire design</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Question types</li>
<li>Scale labeling</li>
<li>Question style</li>
<li>Social desirability bias</li>
<li>Optimizing versus satisfaction</li>
</ol>
<ol start="5" style="list-style-type: decimal">
<li>Simple size</li>
</ol>
<div id="concepts-and-examples" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> (1) Concepts and examples</h3>
<p>We have six types of data:</p>
<ol style="list-style-type: decimal">
<li>Customer identification data - information on the customer and who they are.</li>
<li>Demographic data - information on a more macroscale, where they are from, ethnicities, age etc.</li>
<li>Psychographic or lifestyle data - psychological characteristics and traits such as values, desires, goals, interests, and lifestyle choices.</li>
<li>Transaction data - Do we have transactional information on the customer? What should it be used for and should it be preprocessed.</li>
<li>Marketing action data</li>
<li>Other types of data - e.g., financial and competitive data</li>
</ol>
<p>To get such data we can have three different sources.</p>
<ol style="list-style-type: decimal">
<li>Internal secondary data</li>
<li>External secondary data</li>
<li>Primary data - survey, focus groups, in depth-interviews, observational techniques. Notice that this is the most costly and time consuming, that is also why getting external secondary data can be extremely expensive.</li>
</ol>
<p>Another thing that one must be aware of is <strong>innovation in survey designs</strong>, for instance, are we able to ask about what a customer wants in the future and if they answer. If you could rely on such answers, then I guess it would be very easy to be running a business.</p>
<p>In addition of this, it is often experienced, that people are reluctant to answer honestly in surveys, this can be due to several things, for instance you are:</p>
<ul>
<li>Forced to answer - hence no motivation</li>
<li>You don’t care about the purpose - hence no motivation.</li>
</ul>
</div>
<div id="sampling-and-response-rate" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> (2) Sampling and response rate</h3>
<p>We need the sample to be representative of the population, e.g., equal amount of males and females to reflect real life. Naturally that comes down to what the purpose of the survey is.</p>
<p>We often get a problem with low response rate. And those that actually respond might share similarities, e.g., they are having a lot of free time, they need the rewards that you may get from answering etc. So you want to be cautous about how to get them to answer your survey.</p>
<p>We can overcome this by assigning statistical weigts to the <strong>underrepresented</strong> groups. Often we see that young and old adults, males and people with the highest income are underrepresented. Also there is a tendency to have few responses from busy people and those living in bigger cities.</p>
<p>On the other hand then people with low education and income is often <strong>overrepresented.</strong></p>
<p><strong>Then how to do the sampling?</strong></p>
<p>We have the following two approaches:</p>
<ol style="list-style-type: decimal">
<li>Non-probability sampling - this is pretty much taking whom ever you feel like, for instance sharing a questionnaire on facebook, hence it will be distributed to your friends etc. <em>This is not representative</em></li>
<li>Probability sampling - this is the go to approach. Here we have four approaches. This will be explained following the picture.</li>
</ol>
<div class="figure">
<img src="images/sampling1.png" alt="" />
<p class="caption">Sampling techniques</p>
</div>
<p>Probability sampling techniques</p>
<ol style="list-style-type: decimal">
<li>Simple random sampling: that is just a computer randomly selecting numbers. And then you select these observations.</li>
<li>Systematic sampling: we do 1) selecting a suitable sampling frame, 2) Each element is assigned a number from 1 to N (Population for instance Denmark), 3) Determine sampling interval, 4) Pcik every ith element in succession from the sampling frame.</li>
<li>Stratified sampling: where you group people in different stratas. They can be assigned on one or more parameters. <em>This is widely used.</em> See an illustration below</li>
<li>Cluster sampling.</li>
</ol>
<div class="figure">
<img src="images/SamplingStratas.png" alt="" />
<p class="caption">Stratified sampling</p>
</div>
<p><strong><em>Subconclusion</em></strong></p>
<p>In the end, you always ask youself, is it representative. When you have the probabilty sampling methods, you randomly select a number of people that should answer, e.g., you selesct 1000, but only 543 answers, then do you know what people that actually replied, hence, do you know who answered and is it still representative? If you don’t know, then the data is very <strong>likely to be representative</strong>.</p>
<p>Also often people will answer because you ‘forced’ them to answer, hence they are <strong>not really reliable</strong>, as we don’t know how honest and thorough they where. That is also elaborated in the following slide. So again, if you need 1000 responses, and you force all 1000 to respond, then they will often just rush through and thus they are not reliable. Hence that is not better than not letting them answer.</p>
</div>
<div id="pretesting-and-measurement-validity" class="section level3" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> (3) Pretesting and measurement validity</h3>
<p>We need to pretest the sampling, the tradition way, <em>conventional way</em>. How we do it, is just giving the test to a couple of people and see if they understand the questions. This is key, because if they do not understand then you cannot expect that the mass will understand the questions. In general there are two approaches:</p>
<ol style="list-style-type: decimal">
<li>Conventaional way: That is giving the questions to persons and they tell you their oppinion. One must be aware that this is very subjective and also a bit random.</li>
<li>Moden pretesting way: This has two alternatives</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Behavior coding: you have a third person, an observer, will take notes about the responends actions.</li>
<li>Cognitive pretesting: This is an alternative, the respondent must think out loud, hence verbalize whatever comes to mind when reading the questions.</li>
</ol>
<p><strong><em>Subconclusion</em></strong></p>
<p>Conventional way has low reliability. And the behavior coding is the most reliable.</p>
<p>An complete alternative can be to have <em>conversational interviews</em> although this is very time consuming and often not applied.</p>
</div>
<div id="questionnaire-design" class="section level3" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> (4) Questionnaire design</h3>
<p>The following subsections will cover this.</p>
<p><strong>(4a) Question types</strong></p>
<p>Are we going to make open or closed questions. It has the following advantages and disadvantages.</p>
<ul>
<li><p>Closed questions: Respondents answer what they are given, henve we need to cover the different outcomes to have their experience reflected correctly.</p></li>
<li><p>Open questions: Some respondents have difficulty of expressing their feelings or people just get lazy and not answer faithfully. Also you will have a ton of different answers.</p></li>
</ul>
<p>Hence they both have pros and cons, so one must be aware of when to choose what.</p>
<p>In general we must be cautious about how we use strong words, like very, extreme etc. because it can have several meanings to each individual.</p>
<p>To avoid mistakes, we can setup a questionnaire with questions that are essentially the same, but framed different, to get an idea of what the person intent to ask and also how consistent he is <em>(that being for instance a weak satisfier)</em>.</p>
<p><strong>(4b) Scale labeling</strong></p>
<p>It is very good to have both a range defined by words, e.g., going from very bad to very good.</p>
<p>Criticism of showing the numbers, let us say that it goes from -3 to 3, then the distance between -2 and -3 is one, but the numerical distance between two categories it not necessarily between -1 and -2. To solve this, people sometimes puts a line, e.g., between 0 and 100, then the repsonded is able to point out where he is on the range.</p>
<p>Also, even though we produce numbers, people tend to do quantitative regression, while it is in fact a categorical variable.</p>
<p>There are much criticism on using numbers. Also, the middle point, what does it mean, to the respondend it can be many many things.</p>
<p><strong>(4c) Question style</strong></p>
<p>Will it be an open or a closed question.</p>
<p><strong>(4d) Social desirability bias</strong></p>
<p>Imagine a questionnaire where you are asked about what happens in the past, for instance</p>
<blockquote>
<p>over the last year, how many times pr. month on average have you eaten a burger? 1 time, 2 - 3 times, 4 - 5 times, more than five times, 0 times</p>
</blockquote>
<p>This is often leading to over- and underreporting, as nobody can remember this.</p>
<p>Theory has lead to stages when answering questinons <em>(this should be taken with a grain of salt)</em>, see the following.</p>
<div class="figure">
<img src="images/QAnswerprocess.png" alt="" />
<p class="caption">Stages of answering questions</p>
</div>
<p>In short, one must look up what they have in their memory and then try to fit it into the boxes thzat you give them.</p>
<p>It is different how much effort a person is putting into the considerations, it can be generalized with:</p>
<ol style="list-style-type: decimal">
<li><strong>Optimizers</strong>: A thourough person really considering what to answer, these you want the most of.</li>
<li><strong>Weak satisfaction</strong>: This is just an optimizer which is less considerate.</li>
<li><strong>Strong satisficing</strong>: A person which will just select what he thinks is the most appropriate for the interviewer or researcher, these you do not want any of. This leads to the next section.</li>
</ol>
<p><strong>(4e) Optimizing versus satisfaction</strong></p>
<p>Conditions to foster satisfaction. We need to make the questions as short as possible and use common words. It must be easy for them to understand to avoid them not to understand. This can be cooked down to:</p>
<ol style="list-style-type: decimal">
<li>Task difficulty</li>
<li>Respondents inability</li>
<li>Respondents demotivation to optimize</li>
</ol>
<p>We now that the <em>order of questions does matter</em>: it creates the following effects.</p>
<ul>
<li>Primacy effects: That being prone to select the first question, <em>e.g., weak satisfiers seem to go for this one, because they are just not too considerate</em></li>
<li>Recency effects: Often when solutions is presented orally then they go for the last option.</li>
</ul>
<p>If we have a loooong list of questions, then people tend to either just agree or disagree. In general, people who want to save time, they tend to answer the same in each question, if they are similar.</p>
</div>
<div id="simple-size" class="section level3" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> (5) Simple size</h3>
<p>We can infer this statistically. Notice this example assume only one predictor variable.</p>
<div class="figure">
<img src="images/samplesizeestimate.png" alt="" />
<p class="caption">Sample size estimate</p>
</div>
<p>We see that:</p>
<ul>
<li>z = the confidence level, we go for 5% hence 1.96.</li>
<li>D = The interval you want to be within</li>
<li>sigma = Variance, notice that this must be estimated, as to get true sigma you need characteristics on the population, and we don’t really have that.</li>
</ul>
<p>And now we can plug it into the function</p>
<div class="figure">
<img src="images/samplesizeexample.png" alt="" />
<p class="caption">Sample size inference example</p>
</div>
<p><em>Conducting a survey to estimate the monthly amount invested in savings schemes so that the estimate will be within 5 EUR, what would the sample size be?</em></p>
<p>And we see that we need 496 respondents.</p>
<p><strong><em>Then what happens if we have multiple predictors?</em></strong></p>
<p>Then we can infer for each predictor and take the largest value. <em>A rule of thumb is that we need at least 5 observations for a predictor</em></p>
</div>
</div>
<div id="nps" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> NPS</h2>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="customer-satisfaction-and-loyalty.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x &lt;- ##The ratings go here</span></span>
<span id="cb212-2"><a href="customer-satisfaction-and-loyalty.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(NPS)</span></span>
<span id="cb212-3"><a href="customer-satisfaction-and-loyalty.html#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="co"># prop.table(table(x))</span></span>
<span id="cb212-4"><a href="customer-satisfaction-and-loyalty.html#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nps.se(x)</span></span>
<span id="cb212-5"><a href="customer-satisfaction-and-loyalty.html#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="co"># nps.var(x)</span></span></code></pre></div>
</div>
<div id="cfa-and-sem-application-lavann" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> CFA and SEM Application Lavann</h2>
<p><em>Data source: Hair et al., Multivariate Data Analysis, Pearson Education</em></p>
<div id="business-problem-objectives" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Business Problem &amp; Objectives</h3>
<p>HBAT is a manufacturer of paper products who sells products to two market segments: the newsprint industry and the magazine industry. The current market is very competitive, so the manufacturer wants to understand how its customers perceive the company and make purchasing decisions, in order to enforce customers loyalty. The manufacturer commissioned a study asking its customers to complete a questionnaire on a secure website. In total, 100 customers - purchasing managers from different firms - buying from HBAT completed the questionnaire. The data consist of three main pieces of information:</p>
<p>• A 1st type of information is available from HBAT ́s data warehouse and includes information on:</p>
<ul>
<li>customer type in terms of length of purchase relationship (X1)</li>
<li>industry type(X2)</li>
<li>size of the customer(X3)</li>
<li>region of the customer(X4)</li>
<li>distribution system(X5)</li>
</ul>
<p>• The 2nd type of information is collected based on the online questionnaire and includes consumers’ perceptions of HBAT ́s performance on 13 attributes using a continuous 0-10 (line) scale with 10 being “Excellent” and 0 being “Poor”. The 13 attributes are:</p>
<ul>
<li>X6 Product quality</li>
<li>X7 E-commerce</li>
<li>X8 Technical support</li>
<li>X9 Complaint resolution</li>
<li>X10 Advertising</li>
<li>X11 Product line</li>
<li>X12 Salesforce image</li>
<li>X13 Competitive pricing</li>
<li>X14 Warranty and claims</li>
<li>X15 Packaging</li>
<li>X16 Order and billing</li>
<li>X17 Price flexibility</li>
<li>X18 Delivery speed</li>
</ul>
<p>• The 3rd type of information relates to purchase outcomes and business relationships:</p>
<ul>
<li>satisfaction with HBAT, future purchase intention etc. (X19-X22)</li>
<li>whether the firm would consider a strategic alliance/partnership
with HBAT (X23).</li>
</ul>
</div>
<div id="data" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Data</h3>
<p>The dataset (HBAT.sav) consists of data for n = 100 customers. Each observation contains information on 23 variables described above. Consistent with the marketing theory, there is an underlying factor structure in the data. When designing the study, the company has clearly 4 types of factors in their mind. They expect that the customer satisfaction is determined by the following four type of perceptions: perceptions about the product value, perceptions about the marketing actions, perceptions about the customer service and perceptions about the technical support.These factors are abstract constructs that can be measured in a survey using multi-item scales. The following items define each construct:</p>
<ul>
<li><p>X18 Delivery Speed</p></li>
<li><p>X9 Complain resolution</p></li>
<li><p>X16 Order and Billing, to express “Customer service”</p></li>
<li><p>X11Product line</p></li>
<li><p>X6 Product quality</p></li>
<li><p>X13 Competing pricing, to express “Product value”</p></li>
<li><p>X12 Salesforce image</p></li>
<li><p>X7 E-commerce</p></li>
<li><p>X10 Advertising, to express “Marketing”</p></li>
<li><p>X8 Technical support</p></li>
<li><p>X14 Warranty and claims, to express “Technical support”</p></li>
</ul>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="customer-satisfaction-and-loyalty.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span></code></pre></div>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="customer-satisfaction-and-loyalty.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb214-2"><a href="customer-satisfaction-and-loyalty.html#cb214-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(<span class="st">&quot;Data/CFA and SEM/HBAT.sav&quot;</span>, <span class="at">to.data.frame=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div id="efa" class="section level4" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> EFA</h4>
<p>In the following we are going to identify the factors and what variables
that are related with the factors.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="customer-satisfaction-and-loyalty.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploratory factor analysis (EFA): explicitly assumes the existence of latent factors underlying the observed data. </span></span>
<span id="cb215-2"><a href="customer-satisfaction-and-loyalty.html#cb215-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-3"><a href="customer-satisfaction-and-loyalty.html#cb215-3" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(<span class="sc">~</span> x6 <span class="sc">+</span> x7 <span class="sc">+</span> x8 <span class="sc">+</span> x9 <span class="sc">+</span> x10 <span class="sc">+</span> x11 <span class="sc">+</span> x12 <span class="sc">+</span> x13 <span class="sc">+</span> x14 <span class="sc">+</span> x15 <span class="sc">+</span> x16 <span class="sc">+</span> x17 <span class="sc">+</span> x18</span>
<span id="cb215-4"><a href="customer-satisfaction-and-loyalty.html#cb215-4" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">factors =</span> <span class="dv">4</span></span>
<span id="cb215-5"><a href="customer-satisfaction-and-loyalty.html#cb215-5" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">data =</span> data</span>
<span id="cb215-6"><a href="customer-satisfaction-and-loyalty.html#cb215-6" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">lower =</span> <span class="fl">0.1</span></span>
<span id="cb215-7"><a href="customer-satisfaction-and-loyalty.html#cb215-7" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">rotation =</span> <span class="st">&quot;varimax&quot;</span>)</span>
<span id="cb215-8"><a href="customer-satisfaction-and-loyalty.html#cb215-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-9"><a href="customer-satisfaction-and-loyalty.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit1)</span></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = ~x6 + x7 + x8 + x9 + x10 + x11 + x12 + x13 + x14 +     x15 + x16 + x17 + x18, factors = 4, data = data, rotation = &quot;varimax&quot;,     lower = 0.1)
## 
## Uniquenesses:
##    x6    x7    x8    x9   x10   x11   x12   x13   x14   x15   x16   x17   x18 
## 0.623 0.305 0.285 0.183 0.663 0.100 0.100 0.595 0.100 0.987 0.358 0.100 0.100 
## 
## Loadings:
##     Factor1 Factor2 Factor3 Factor4
## x6           0.609                 
## x7                   0.826         
## x8           0.113           0.838 
## x9   0.879   0.153   0.140         
## x10  0.199  -0.128   0.530         
## x11  0.500   0.814           0.115 
## x12  0.125  -0.140   0.929         
## x13         -0.561   0.219  -0.198 
## x14          0.146           0.931 
## x15  0.109                         
## x16  0.784           0.109   0.111 
## x17  0.553  -0.750   0.204  -0.132 
## x18  0.940   0.122   0.183         
## 
##                Factor1 Factor2 Factor3 Factor4
## SS loadings      2.910   2.030   1.990   1.657
## Proportion Var   0.224   0.156   0.153   0.127
## Cumulative Var   0.224   0.380   0.533   0.661
## 
## Test of the hypothesis that 4 factors are sufficient.
## The chi square statistic is 162.89 on 32 degrees of freedom.
## The p-value is 1.83e-19</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="customer-satisfaction-and-loyalty.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We see that the p-value is highly signinficant, hence we reject the model.</span></span></code></pre></div>
<p>A first exploration of the factors using the EFA reveals the factor loadings for each observable variable. High loadings (&gt;0.6 or &gt; 0.7) are expected for the items that theoretically define each construct.</p>
<p>Items with cross-loadings should be removed.</p>
<p>One can observe:</p>
<ol style="list-style-type: decimal">
<li>x9, x16, x17, x18 load high on Factor 1 (Customer service)</li>
<li>x6, x11, x13, x17 load high on Factor 2 (Product value)</li>
<li>x7, x10?, x12 load high on Factor 3 (Marketing)</li>
<li>x8 and x14 load high on Factor 4 (Technical support)</li>
</ol>
<p>x17 load high simultaneusly on two factors (Factor 1 and 2). This phenomenon is called “cross-loading”.</p>
<p>one needs to remove the items with cross-loading from the measurement model. It means they do not measure a single construct.</p>
<p>x11 might also be a candidate for deletion (loading high on factor 1 and 2); keep it for the moment.</p>
<p>one can delete x15 which does not have high loadings on ANY of the four factors. Very low loadings (&lt;.10) are not displayed.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="customer-satisfaction-and-loyalty.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run EFA without x15 and x17</span></span>
<span id="cb218-2"><a href="customer-satisfaction-and-loyalty.html#cb218-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">factanal</span>(<span class="sc">~</span> x6 <span class="sc">+</span> x7 <span class="sc">+</span> x8 <span class="sc">+</span> x9 <span class="sc">+</span> x10 <span class="sc">+</span> x11 <span class="sc">+</span> x12 <span class="sc">+</span> x13 <span class="sc">+</span> x14 <span class="sc">+</span> x16 <span class="sc">+</span> x18</span>
<span id="cb218-3"><a href="customer-satisfaction-and-loyalty.html#cb218-3" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">factors =</span> <span class="dv">4</span></span>
<span id="cb218-4"><a href="customer-satisfaction-and-loyalty.html#cb218-4" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">data =</span> data</span>
<span id="cb218-5"><a href="customer-satisfaction-and-loyalty.html#cb218-5" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">lower =</span> <span class="fl">0.1</span></span>
<span id="cb218-6"><a href="customer-satisfaction-and-loyalty.html#cb218-6" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">rotation =</span> <span class="st">&quot;varimax&quot;</span>)</span>
<span id="cb218-7"><a href="customer-satisfaction-and-loyalty.html#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit2,<span class="at">sort =</span> T)</span></code></pre></div>
<pre><code>## 
## Call:
## factanal(x = ~x6 + x7 + x8 + x9 + x10 + x11 + x12 + x13 + x14 +     x16 + x18, factors = 4, data = data, rotation = &quot;varimax&quot;,     lower = 0.1)
## 
## Uniquenesses:
##    x6    x7    x8    x9   x10   x11   x12   x13   x14   x16   x18 
## 0.635 0.305 0.285 0.163 0.668 0.100 0.100 0.599 0.100 0.342 0.100 
## 
## Loadings:
##     Factor1 Factor2 Factor3 Factor4
## x9   0.895   0.135           0.128 
## x16  0.796   0.105   0.108         
## x18  0.918   0.193           0.154 
## x7           0.827                 
## x10  0.180   0.537                 
## x12  0.127   0.928          -0.144 
## x8                   0.838   0.107 
## x14                  0.932   0.140 
## x6                           0.598 
## x11  0.519           0.120   0.786 
## x13          0.223  -0.202  -0.553 
## 
##                Factor1 Factor2 Factor3 Factor4
## SS loadings      2.613   1.962   1.645   1.391
## Proportion Var   0.238   0.178   0.150   0.126
## Cumulative Var   0.238   0.416   0.565   0.692
## 
## Test of the hypothesis that 4 factors are sufficient.
## The chi square statistic is 26.7 on 17 degrees of freedom.
## The p-value is 0.0626</code></pre>
<p>We want the cumulative variance to be above 60%, we see that we meet that criteria</p>
<ul>
<li>Test of the hypothesis that 4 factors are sufficient.</li>
<li>The chi square statistic is 26.7 on 17 degrees of freedom.</li>
<li>The p-value is 0.0626 (n.s.) hence we cannot reject, that there is a relationship.</li>
</ul>
<hr />
<p><strong>Using eigen value to assess amount of factors to select.</strong></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="customer-satisfaction-and-loyalty.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span></span>
<span id="cb220-2"><a href="customer-satisfaction-and-loyalty.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nFactors)</span>
<span id="cb220-3"><a href="customer-satisfaction-and-loyalty.html#cb220-3" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(data[,<span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">19</span>)]))</span>
<span id="cb220-4"><a href="customer-satisfaction-and-loyalty.html#cb220-4" aria-hidden="true" tabindex="-1"></a>ev</span></code></pre></div>
<pre><code>## eigen() decomposition
## $values
##  [1] 3.567074795 2.997644547 1.738077491 1.287225051 1.005237601 0.618614261
##  [7] 0.551427702 0.446993915 0.280735795 0.200708880 0.166195339 0.131058876
## [13] 0.009005747
## 
## $vectors
##               [,1]        [,2]        [,3]        [,4]        [,5]         [,6]
##  [1,] -0.008446162  0.36209283  0.04678935  0.47025543 -0.05007347  0.053218125
##  [2,] -0.244268729 -0.25887463 -0.35900707  0.34222834  0.09769943  0.376718762
##  [3,] -0.069090049  0.27405908 -0.52503623 -0.36487985 -0.01424126 -0.052463334
##  [4,] -0.457137214  0.12307431  0.20045850 -0.10240177  0.08595970  0.056968447
##  [5,] -0.255224876 -0.20968349 -0.18298044  0.32643625 -0.12554223 -0.780692662
##  [6,] -0.252450282  0.42196215  0.10369985  0.21751972  0.03205501  0.163391859
##  [7,] -0.290987483 -0.27281337 -0.35867289  0.29559280  0.01309635  0.195905988
##  [8,]  0.008246314 -0.43224128  0.01407530 -0.15377746 -0.02328483  0.358023704
##  [9,] -0.128457735  0.26796431 -0.52277710 -0.32283288 -0.13005779  0.001572649
## [10,] -0.065686377 -0.01201495  0.09504456  0.01527331 -0.97011829  0.145935408
## [11,] -0.430501041  0.10171830  0.16835005 -0.14893939  0.05661020  0.028760422
## [12,] -0.278546553 -0.37514985  0.14985400 -0.34574836 -0.01358671 -0.154763215
## [13,] -0.478712405  0.07283481  0.21649677 -0.08389812  0.03767846  0.020892771
##              [,7]        [,8]        [,9]        [,10]       [,11]        [,12]
##  [1,]  0.66589654 -0.33225521 -0.22462438  0.007874262  0.18916547  0.004949852
##  [2,] -0.20788462 -0.18096215  0.04333602 -0.568040361  0.12566307  0.242746705
##  [3,]  0.12857096 -0.02143816 -0.36226254 -0.317860485 -0.37815324 -0.340652073
##  [4,]  0.01886806  0.04489722 -0.30907596  0.143600911 -0.42151255  0.646668513
##  [5,]  0.13799303  0.24702527  0.12615240 -0.132664225 -0.08789281  0.064371162
##  [6,] -0.14409748  0.51451471  0.07780447 -0.095834270  0.07938639 -0.183829669
##  [7,] -0.09050524 -0.06131073 -0.12450579  0.663204133 -0.14586925 -0.308660927
##  [8,]  0.62750296  0.48310471  0.13005088 -0.074305149 -0.10264536 -0.009554218
##  [9,]  0.10712744  0.07358489  0.29554570  0.264416777  0.46117870  0.360900790
## [10,] -0.10467064 -0.04524136 -0.02892652 -0.056036609 -0.08198456 -0.003969278
## [11,]  0.13766958 -0.40015006  0.66839914 -0.055764820 -0.26409100 -0.225868516
## [12,]  0.09410061 -0.28163148 -0.30107123 -0.053262879  0.37941812 -0.067534206
## [13,] -0.06694700  0.21116321 -0.20232546 -0.066810707  0.38574841 -0.296113322
##              [,13]
##  [1,]  0.003255188
##  [2,] -0.024896668
##  [3,]  0.007706804
##  [4,] -0.014147290
##  [5,] -0.012734529
##  [6,]  0.575848184
##  [7,]  0.049860958
##  [8,] -0.017852976
##  [9,] -0.013022281
## [10,] -0.011434967
## [11,]  0.008058268
## [12,]  0.534199397
## [13,] -0.615473481</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="customer-satisfaction-and-loyalty.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># EV = a measure of how much of varaince each factor explain.</span></span>
<span id="cb222-2"><a href="customer-satisfaction-and-loyalty.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="co"># According to this, we select 5 factors, equal to the no. of values</span></span>
<span id="cb222-3"><a href="customer-satisfaction-and-loyalty.html#cb222-3" aria-hidden="true" tabindex="-1"></a><span class="co"># that is above 1.</span></span></code></pre></div>
<hr />
<p>We defined the individual constructs based on the theory (Stage 1) and developed the overall measurement model making also a first exploration with EFA. The next stages (4 and 5) would be to assess the measurement model validity (Confirmatory Factor Analsysis). Lastly, stages 5 and 6 implies to specify the structural model (SEM) and to asssess the structural model validity.</p>
<p>Hence, the next two main operational tasks are:</p>
<ol style="list-style-type: decimal">
<li>Set up a confirmatory factor analysis to confirm the measurement model</li>
<li>Given the measurement model has been examined and validated in the CFA analysis, set up a SEM model, to test the structural relationships between the four constructs identified and the customers´ likelihood to continue doing business with HBAT (X19-Satisfaction, X20-Likelihood of recommendation and X21-Likelihood of future purchase).</li>
</ol>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="customer-satisfaction-and-loyalty.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">variable.names</span>(data)</span></code></pre></div>
<pre><code>##  [1] &quot;id&quot;  &quot;x1&quot;  &quot;x2&quot;  &quot;x3&quot;  &quot;x4&quot;  &quot;x5&quot;  &quot;x6&quot;  &quot;x7&quot;  &quot;x8&quot;  &quot;x9&quot;  &quot;x10&quot; &quot;x11&quot;
## [13] &quot;x12&quot; &quot;x13&quot; &quot;x14&quot; &quot;x15&quot; &quot;x16&quot; &quot;x17&quot; &quot;x18&quot; &quot;x19&quot; &quot;x20&quot; &quot;x21&quot; &quot;x22&quot; &quot;x23&quot;</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="customer-satisfaction-and-loyalty.html#cb225-1" aria-hidden="true" tabindex="-1"></a>VariableLabels <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">attr</span>(data, <span class="st">&quot;variable.labels&quot;</span>))</span>
<span id="cb225-2"><a href="customer-satisfaction-and-loyalty.html#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.label.table &lt;- attr(sav, &quot;label.table&quot;) # if you load it with read_sav()</span></span>
<span id="cb225-3"><a href="customer-satisfaction-and-loyalty.html#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code></pre></div>
<pre><code>##        id                        x1                      x2    
##  Min.   :  1.00   Less than 1 year:32   Magazine industry :52  
##  1st Qu.: 25.75   1 to 5 years    :35   Newsprint industry:48  
##  Median : 50.50   Over 5 years    :33                          
##  Mean   : 50.50                                                
##  3rd Qu.: 75.25                                                
##  Max.   :100.00                                                
##                 x3                         x4                           x5    
##  Small (0 to 499):49   USA/North America    :39   Indirect through broker:57  
##  Large (500+)    :51   Outside North America:61   Direct to customer     :43  
##                                                                               
##                                                                               
##                                                                               
##                                                                               
##        x6               x7              x8              x9       
##  Min.   : 5.000   Min.   :2.200   Min.   :1.300   Min.   :2.600  
##  1st Qu.: 6.575   1st Qu.:3.275   1st Qu.:4.250   1st Qu.:4.600  
##  Median : 8.000   Median :3.600   Median :5.400   Median :5.450  
##  Mean   : 7.810   Mean   :3.672   Mean   :5.365   Mean   :5.442  
##  3rd Qu.: 9.100   3rd Qu.:3.925   3rd Qu.:6.625   3rd Qu.:6.325  
##  Max.   :10.000   Max.   :5.700   Max.   :8.500   Max.   :7.800  
##       x10             x11             x12             x13       
##  Min.   :1.900   Min.   :2.300   Min.   :2.900   Min.   :3.700  
##  1st Qu.:3.175   1st Qu.:4.700   1st Qu.:4.500   1st Qu.:5.875  
##  Median :4.000   Median :5.750   Median :4.900   Median :7.100  
##  Mean   :4.010   Mean   :5.805   Mean   :5.123   Mean   :6.974  
##  3rd Qu.:4.800   3rd Qu.:6.800   3rd Qu.:5.800   3rd Qu.:8.400  
##  Max.   :6.500   Max.   :8.400   Max.   :8.200   Max.   :9.900  
##       x14             x15            x16             x17            x18       
##  Min.   :4.100   Min.   :1.70   Min.   :2.000   Min.   :2.60   Min.   :1.600  
##  1st Qu.:5.400   1st Qu.:4.10   1st Qu.:3.700   1st Qu.:3.70   1st Qu.:3.400  
##  Median :6.100   Median :5.00   Median :4.400   Median :4.35   Median :3.900  
##  Mean   :6.043   Mean   :5.15   Mean   :4.278   Mean   :4.61   Mean   :3.886  
##  3rd Qu.:6.600   3rd Qu.:6.30   3rd Qu.:4.800   3rd Qu.:5.60   3rd Qu.:4.425  
##  Max.   :8.100   Max.   :9.50   Max.   :6.700   Max.   :7.30   Max.   :5.500  
##       x19             x20            x21             x22       
##  Min.   :4.700   Min.   :4.60   Min.   :5.500   Min.   :37.10  
##  1st Qu.:6.000   1st Qu.:6.30   1st Qu.:7.100   1st Qu.:51.10  
##  Median :7.050   Median :7.00   Median :7.700   Median :58.60  
##  Mean   :6.918   Mean   :7.02   Mean   :7.713   Mean   :58.40  
##  3rd Qu.:7.625   3rd Qu.:7.60   3rd Qu.:8.400   3rd Qu.:65.35  
##  Max.   :9.900   Max.   :9.90   Max.   :9.900   Max.   :77.10  
##                      x23    
##  No, would not consider:55  
##  Yes, would consider   :45  
##                             
##                             
##                             
## </code></pre>
</div>
<div id="cfa-model" class="section level4" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> CFA model</h4>
<p>We use CFA to iterate through different models.</p>
<div id="initial-model" class="section level5" number="2.3.2.2.1">
<h5><span class="header-section-number">2.3.2.2.1</span> Initial model</h5>
<ul>
<li>CS = Customer Service</li>
<li>PV = Product value</li>
<li>MK = Marketing</li>
<li>TS = Technical support</li>
</ul>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="customer-satisfaction-and-loyalty.html#cb227-1" aria-hidden="true" tabindex="-1"></a>CFA.model <span class="ot">&lt;-</span> <span class="st">&#39;CS =~ x18 + x9 + x16</span></span>
<span id="cb227-2"><a href="customer-satisfaction-and-loyalty.html#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="st">             PV =~ x11 + x6 + x13</span></span>
<span id="cb227-3"><a href="customer-satisfaction-and-loyalty.html#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="st">             MK =~ x12 + x7 + x10</span></span>
<span id="cb227-4"><a href="customer-satisfaction-and-loyalty.html#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="st">             TS =~ x8 + x14</span></span>
<span id="cb227-5"><a href="customer-satisfaction-and-loyalty.html#cb227-5" aria-hidden="true" tabindex="-1"></a><span class="st">    # Correlations between exogeneous constructs are optional because</span></span>
<span id="cb227-6"><a href="customer-satisfaction-and-loyalty.html#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="st">    # by default, all exogenous latent variables in a CFA model are allowed to correlate</span></span>
<span id="cb227-7"><a href="customer-satisfaction-and-loyalty.html#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="st">        CS ~~ PV</span></span>
<span id="cb227-8"><a href="customer-satisfaction-and-loyalty.html#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="st">        CS ~~ MK</span></span>
<span id="cb227-9"><a href="customer-satisfaction-and-loyalty.html#cb227-9" aria-hidden="true" tabindex="-1"></a><span class="st">        CS ~~ TS</span></span>
<span id="cb227-10"><a href="customer-satisfaction-and-loyalty.html#cb227-10" aria-hidden="true" tabindex="-1"></a><span class="st">        PV ~~ MK</span></span>
<span id="cb227-11"><a href="customer-satisfaction-and-loyalty.html#cb227-11" aria-hidden="true" tabindex="-1"></a><span class="st">        PV ~~ TS</span></span>
<span id="cb227-12"><a href="customer-satisfaction-and-loyalty.html#cb227-12" aria-hidden="true" tabindex="-1"></a><span class="st">        MK ~~ TS&#39;</span></span>
<span id="cb227-13"><a href="customer-satisfaction-and-loyalty.html#cb227-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-14"><a href="customer-satisfaction-and-loyalty.html#cb227-14" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb227-15"><a href="customer-satisfaction-and-loyalty.html#cb227-15" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(CFA.model, <span class="at">data =</span> data)</span>
<span id="cb227-16"><a href="customer-satisfaction-and-loyalty.html#cb227-16" aria-hidden="true" tabindex="-1"></a><span class="co"># display summary output</span></span>
<span id="cb227-17"><a href="customer-satisfaction-and-loyalty.html#cb227-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit</span>
<span id="cb227-18"><a href="customer-satisfaction-and-loyalty.html#cb227-18" aria-hidden="true" tabindex="-1"></a>        , <span class="at">fit.measures=</span><span class="cn">TRUE</span></span>
<span id="cb227-19"><a href="customer-satisfaction-and-loyalty.html#cb227-19" aria-hidden="true" tabindex="-1"></a>        , <span class="at">standardized =</span> <span class="cn">TRUE</span></span>
<span id="cb227-20"><a href="customer-satisfaction-and-loyalty.html#cb227-20" aria-hidden="true" tabindex="-1"></a>        , <span class="at">modindices =</span> <span class="cn">FALSE</span>) <span class="co">#If TRUE, then we would get modificantion index</span></span></code></pre></div>
<pre><code>## lavaan 0.6-7 ended normally after 53 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         28
##                                                       
##   Number of observations                           100
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                61.835
##   Degrees of freedom                                38
##   P-value (Chi-square)                           0.009
## 
## Model Test Baseline Model:
## 
##   Test statistic                               655.315
##   Degrees of freedom                                55
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.960
##   Tucker-Lewis Index (TLI)                       0.943
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1349.559
##   Loglikelihood unrestricted model (H1)      -1318.642
##                                                       
##   Akaike (AIC)                                2755.119
##   Bayesian (BIC)                              2828.064
##   Sample-size adjusted Bayesian (BIC)         2739.632
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.079
##   90 Percent confidence interval - lower         0.040
##   90 Percent confidence interval - upper         0.114
##   P-value RMSEA &lt;= 0.05                          0.097
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.087
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS =~                                                                 
##     x18               1.000                               0.703    0.961
##     x9                1.549    0.099   15.657    0.000    1.088    0.905
##     x16               1.035    0.092   11.198    0.000    0.727    0.787
##   PV =~                                                                 
##     x11               1.000                               1.547    1.182
##     x6                0.360    0.103    3.515    0.000    0.558    0.401
##     x13              -0.385    0.112   -3.444    0.001   -0.596   -0.388
##   MK =~                                                                 
##     x12               1.000                               1.071    1.003
##     x7                0.514    0.064    8.009    0.000    0.550    0.789
##     x10               0.566    0.104    5.434    0.000    0.605    0.540
##   TS =~                                                                 
##     x8                1.000                               1.014    0.666
##     x14               0.962    0.391    2.461    0.014    0.976    1.197
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS ~~                                                                 
##     PV                0.608    0.113    5.406    0.000    0.560    0.560
##     MK                0.204    0.080    2.558    0.011    0.271    0.271
##     TS                0.089    0.075    1.190    0.234    0.125    0.125
##   PV ~~                                                                 
##     MK                0.006    0.136    0.042    0.967    0.003    0.003
##     TS                0.265    0.176    1.506    0.132    0.169    0.169
##   MK ~~                                                                 
##     TS                0.120    0.106    1.126    0.260    0.110    0.110
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .x18               0.040    0.018    2.242    0.025    0.040    0.076
##    .x9                0.261    0.056    4.675    0.000    0.261    0.181
##    .x16               0.325    0.051    6.396    0.000    0.325    0.381
##    .x11              -0.681    0.427   -1.596    0.111   -0.681   -0.398
##    .x6                1.619    0.229    7.065    0.000    1.619    0.839
##    .x13               2.008    0.283    7.096    0.000    2.008    0.850
##    .x12              -0.008    0.112   -0.070    0.944   -0.008   -0.007
##    .x7                0.183    0.039    4.665    0.000    0.183    0.378
##    .x10               0.891    0.131    6.806    0.000    0.891    0.708
##    .x8                1.290    0.440    2.929    0.003    1.290    0.556
##    .x14              -0.288    0.373   -0.770    0.441   -0.288   -0.432
##     CS                0.494    0.077    6.392    0.000    1.000    1.000
##     PV                2.394    0.472    5.076    0.000    1.000    1.000
##     MK                1.146    0.196    5.843    0.000    1.000    1.000
##     TS                1.029    0.485    2.122    0.034    1.000    1.000</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="customer-satisfaction-and-loyalty.html#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the model fit (see slides for references). </span></span>
<span id="cb229-2"><a href="customer-satisfaction-and-loyalty.html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: we get &quot;lavaan </span><span class="al">WARNING</span><span class="co">: some estimated ov variances are negative&quot;. </span></span>
<span id="cb229-3"><a href="customer-satisfaction-and-loyalty.html#cb229-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is called in the literature &quot;Heywood case&quot;. Heywood cases or negative variance estimates, are a common occurrence in factor analysis and latent variable structural equation models.</span></span>
<span id="cb229-4"><a href="customer-satisfaction-and-loyalty.html#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co"># There are several potential causes (https://journals.sagepub.com/doi/10.1177/0049124112442138). Here,eliminating the problematic item x11, will solve the problem.  </span></span></code></pre></div>
<ul>
<li><p>We see that we want to maximize TLI and CFI towards 1. Atm it looks well.</p></li>
<li><p>We want the RMSEA (Root Mean Square Error of Approximation) to be below the 5% level. This we obtain in this example with pointe estimate of 0.079 where the 5% level is at 0.097, hence we are below. She writes in the slides (54) that we just need to be below 8%, this we also meet. she also writes that above 10% is a poor fit.</p></li>
</ul>
<p>We see that we get a warning, that is because there are negative variances, this is because of variable 11, that we ended up leaving in the model.</p>
<p>Now we can ask for the modification indexes.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="customer-satisfaction-and-loyalty.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ask for the modification indiceslin</span></span>
<span id="cb230-2"><a href="customer-satisfaction-and-loyalty.html#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(fit</span>
<span id="cb230-3"><a href="customer-satisfaction-and-loyalty.html#cb230-3" aria-hidden="true" tabindex="-1"></a>                    ,<span class="at">sort =</span> T</span>
<span id="cb230-4"><a href="customer-satisfaction-and-loyalty.html#cb230-4" aria-hidden="true" tabindex="-1"></a>                    ,<span class="at">minimum.value =</span> <span class="dv">10</span></span>
<span id="cb230-5"><a href="customer-satisfaction-and-loyalty.html#cb230-5" aria-hidden="true" tabindex="-1"></a>                    ,<span class="at">op =</span> <span class="st">&quot;~~&quot;</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">lhs</th>
<th align="left">op</th>
<th align="left">rhs</th>
<th align="right">mi</th>
<th align="right">epc</th>
<th align="right">sepc.lv</th>
<th align="right">sepc.all</th>
<th align="right">sepc.nox</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">68</td>
<td align="left">x18</td>
<td align="left">~~</td>
<td align="left">x11</td>
<td align="right">15.70319</td>
<td align="right">0.1283451</td>
<td align="right">0.1283451</td>
<td align="right">0.7733247</td>
<td align="right">0.7733247</td>
</tr>
<tr class="even">
<td align="left">69</td>
<td align="left">x18</td>
<td align="left">~~</td>
<td align="left">x6</td>
<td align="right">11.22736</td>
<td align="right">-0.1347114</td>
<td align="right">-0.1347114</td>
<td align="right">-0.5264974</td>
<td align="right">-0.5264974</td>
</tr>
<tr class="odd">
<td align="left">85</td>
<td align="left">x16</td>
<td align="left">~~</td>
<td align="left">x11</td>
<td align="right">10.73299</td>
<td align="right">-0.1541396</td>
<td align="right">-0.1541396</td>
<td align="right">-0.3274085</td>
<td align="right">-0.3274085</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="customer-satisfaction-and-loyalty.html#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MI reveal that x11 is correlated with x16 and x18; it means that x11 has substantial cross-loading on two factors (we also found this in EFA). Cross-loading goes against one of the principles of unidimensionality in SEM. We delete x11 from the analysis and re-run CFA. </span></span></code></pre></div>
<p>This confirms that we must do something with x11 (it should have been done in the exploratory assessment, but it was kept to show it)</p>
</div>
<div id="second-model" class="section level5" number="2.3.2.2.2">
<h5><span class="header-section-number">2.3.2.2.2</span> Second model</h5>
<p><strong>Model without x11</strong></p>
<p>Notice that the EFA already suggested this, but we wanted to explore how it affected the overall model. And we end up seeing the consensus that we need to do something with V11.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="customer-satisfaction-and-loyalty.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CFA model after deleting x11</span></span>
<span id="cb232-2"><a href="customer-satisfaction-and-loyalty.html#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb232-3"><a href="customer-satisfaction-and-loyalty.html#cb232-3" aria-hidden="true" tabindex="-1"></a>CFA.model <span class="ot">&lt;-</span> <span class="st">&#39;CS =~ x18 + x9 + x16</span></span>
<span id="cb232-4"><a href="customer-satisfaction-and-loyalty.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="st">             PV =~ x6 + x13</span></span>
<span id="cb232-5"><a href="customer-satisfaction-and-loyalty.html#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="st">             MK =~ x12 + x7 + x10</span></span>
<span id="cb232-6"><a href="customer-satisfaction-and-loyalty.html#cb232-6" aria-hidden="true" tabindex="-1"></a><span class="st">             TS =~ x8 + x14&#39;</span></span>
<span id="cb232-7"><a href="customer-satisfaction-and-loyalty.html#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb232-8"><a href="customer-satisfaction-and-loyalty.html#cb232-8" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(CFA.model, <span class="at">data =</span> data)</span>
<span id="cb232-9"><a href="customer-satisfaction-and-loyalty.html#cb232-9" aria-hidden="true" tabindex="-1"></a><span class="co"># display summary output</span></span>
<span id="cb232-10"><a href="customer-satisfaction-and-loyalty.html#cb232-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">modindices =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-7 ended normally after 60 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         26
##                                                       
##   Number of observations                           100
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                18.183
##   Degrees of freedom                                29
##   P-value (Chi-square)                           0.940
## 
## Model Test Baseline Model:
## 
##   Test statistic                               530.377
##   Degrees of freedom                                45
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.035
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1221.406
##   Loglikelihood unrestricted model (H1)      -1212.314
##                                                       
##   Akaike (AIC)                                2494.812
##   Bayesian (BIC)                              2562.546
##   Sample-size adjusted Bayesian (BIC)         2480.432
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.016
##   P-value RMSEA &lt;= 0.05                          0.989
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.039
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS =~                                                                 
##     x18               1.000                               0.677    0.926
##     x9                1.658    0.113   14.664    0.000    1.123    0.934
##     x16               1.107    0.098   11.294    0.000    0.749    0.811
##   PV =~                                                                 
##     x6                1.000                               0.625    0.450
##     x13              -2.197    0.962   -2.284    0.022   -1.372   -0.893
##   MK =~                                                                 
##     x12               1.000                               1.066    0.999
##     x7                0.518    0.063    8.249    0.000    0.552    0.792
##     x10               0.571    0.103    5.531    0.000    0.609    0.543
##   TS =~                                                                 
##     x8                1.000                               1.280    0.841
##     x14               0.604    0.135    4.467    0.000    0.774    0.948
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS ~~                                                                 
##     PV                0.055    0.054    1.022    0.307    0.131    0.131
##     MK                0.191    0.077    2.471    0.013    0.265    0.265
##     TS                0.123    0.097    1.272    0.203    0.142    0.142
##   PV ~~                                                                 
##     MK               -0.199    0.112   -1.774    0.076   -0.299   -0.299
##     TS                0.239    0.144    1.665    0.096    0.299    0.299
##   MK ~~                                                                 
##     TS                0.127    0.145    0.880    0.379    0.093    0.093
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .x18               0.076    0.022    3.434    0.001    0.076    0.142
##    .x9                0.185    0.059    3.137    0.002    0.185    0.128
##    .x16               0.292    0.048    6.108    0.000    0.292    0.342
##    .x6                1.540    0.268    5.750    0.000    1.540    0.798
##    .x13               0.480    0.756    0.635    0.525    0.480    0.203
##    .x12               0.003    0.106    0.026    0.979    0.003    0.002
##    .x7                0.181    0.038    4.714    0.000    0.181    0.372
##    .x10               0.887    0.130    6.813    0.000    0.887    0.705
##    .x8                0.681    0.362    1.882    0.060    0.681    0.294
##    .x14               0.067    0.128    0.523    0.601    0.067    0.100
##     CS                0.458    0.077    5.936    0.000    1.000    1.000
##     PV                0.390    0.227    1.721    0.085    1.000    1.000
##     MK                1.136    0.193    5.886    0.000    1.000    1.000
##     TS                1.638    0.469    3.494    0.000    1.000    1.000</code></pre>
<div id="intepretation-of-the-model" class="section level6" number="2.3.2.2.2.1">
<h6><span class="header-section-number">2.3.2.2.2.1</span> Intepretation of the model</h6>
<div id="examine-the-model-fit" class="section level7" number="2.3.2.2.2.1.1">
<p class="heading" number="2.3.2.2.2.1.1"><span class="header-section-number">2.3.2.2.2.1.1</span> <strong>1.) Examine the MODEL FIT</strong></p>
<p>a much better fit than we obtained before</p>
<p>A decent model requires:</p>
<ul>
<li>CFI &gt;.90,</li>
<li>TLI&gt;.90,</li>
<li>RMSEA&lt; 0.08,</li>
<li>SRMR &lt;.0.08.</li>
</ul>
<p>Check these indexes of model fit in your summary.</p>
</div>
<div id="examine-the-loadings-significance-size-and-sign" class="section level7" number="2.3.2.2.2.1.2">
<p class="heading" number="2.3.2.2.2.1.2"><span class="header-section-number">2.3.2.2.2.1.2</span> <strong>2). Examine the LOADINGS significance, size and sign</strong></p>
<p>The (std.) loadings should be at least +-.40. It is desirable to have high and significant loadings - it reflects items convergent validity.</p>
<p>In one factor 2, competitive pricing (x13) and product quality (x6) have opposite signs. It means that the product quality and competitive pricing vary together, but move in direction opposite to each other. Perceptions are more positive whether product quality increases or price decreases. This trade-off leads to naming the factor product value. When variables have different signs, we need to be careful to reverse one when creating summated scales or using further in SEM analysis.</p>
<p><strong>Reverse scoring</strong> is the process by which the data values for a variable are reversed so that its correlation with the other variables are reversed (go from negative to positive). The purpose of reversing is to prevent a canceling out of variables with positive and negative loading. Reverse coding is typically required if we have some negatively phrased statement items in our questionnaire. For a categorical variable e.g. 1-5, the reversing implies: 1-&gt;5, 2-&gt;4, 3-&gt;2, 4-&gt;1, 5-&gt;1 For a continous variable: newvar = oldvar * (-1)</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="customer-satisfaction-and-loyalty.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>x13)</span>
<span id="cb234-2"><a href="customer-satisfaction-and-loyalty.html#cb234-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data<span class="sc">$</span>x13)</span>
<span id="cb234-3"><a href="customer-satisfaction-and-loyalty.html#cb234-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-4"><a href="customer-satisfaction-and-loyalty.html#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># reversing X13 :</span></span>
<span id="cb234-5"><a href="customer-satisfaction-and-loyalty.html#cb234-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb234-6"><a href="customer-satisfaction-and-loyalty.html#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb234-7"><a href="customer-satisfaction-and-loyalty.html#cb234-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb234-8"><a href="customer-satisfaction-and-loyalty.html#cb234-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x13r =</span> x13 <span class="sc">*</span> (<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb234-9"><a href="customer-satisfaction-and-loyalty.html#cb234-9" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data<span class="sc">$</span>x13r)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   3.700   5.875   7.100   6.974   8.400   9.900 
##  num [1:100] 6.8 5.3 4.5 8.8 6.8 8.5 8.9 6.9 9.3 8.4 ...
##  num [1:100] -6.8 -5.3 -4.5 -8.8 -6.8 -8.5 -8.9 -6.9 -9.3 -8.4 ...</code></pre>
</div>
<div id="examine-reliability-of-the-factors" class="section level7" number="2.3.2.2.2.1.3">
<p class="heading" number="2.3.2.2.2.1.3"><span class="header-section-number">2.3.2.2.2.1.3</span> <strong>3). Examine RELIABILITY of the factors</strong></p>
<p>Reliability = assessment of degree of consistency between multiple measurements of a variable (back to the slides to refer to this concept).</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="customer-satisfaction-and-loyalty.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb236-2"><a href="customer-satisfaction-and-loyalty.html#cb236-2" aria-hidden="true" tabindex="-1"></a>semTools<span class="sc">::</span><span class="fu">reliability</span>(fit)</span></code></pre></div>
<pre><code>##               CS         PV        MK        TS
## alpha  0.8971043 -1.3290821 0.7829833 0.7977744
## omega  0.9214780  0.2168081 0.8224869 0.8494229
## omega2 0.9214780  0.2168081 0.8224869 0.8494229
## omega3 0.9215495  0.2168081 0.8225741 0.8494228
## avevar 0.8046227  0.5294845 0.6286031 0.7495027</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="customer-satisfaction-and-loyalty.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha =  coefficient alpha (Cronbach, 1951) - should be &gt; than 0.5 or 0.6 (some textbooks)</span></span>
<span id="cb238-2"><a href="customer-satisfaction-and-loyalty.html#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="co"># omega = is similar to composite reliability index (CR) (Fornell &amp; Larcker (1981) - should be &gt; 0.7</span></span>
<span id="cb238-3"><a href="customer-satisfaction-and-loyalty.html#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="co"># avevar = average variance extracted (AVE) (Fornell &amp; Larcker (1981))  - should be &gt; than 0.5.</span></span>
<span id="cb238-4"><a href="customer-satisfaction-and-loyalty.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For PV factor, reliability was calculed with the non-reversed item; let´s change that:</span></span></code></pre></div>
<p>We want the <code>avevar</code> to be above 0.60.</p>
<p>The omega is the composite reliability, it should be higher than 0.7.</p>
<p>We want the <code>alpha</code> to be close to 1.</p>
<p>We see that PV is not meeting the two above. that is because we have a negative variable.</p>
<p>Now we are going to reverse x13 to make the construct PV meet the requirements (or at least get closer to)</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="customer-satisfaction-and-loyalty.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb239-2"><a href="customer-satisfaction-and-loyalty.html#cb239-2" aria-hidden="true" tabindex="-1"></a>    CFA.model <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb239-3"><a href="customer-satisfaction-and-loyalty.html#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="st">    # Measurement model</span></span>
<span id="cb239-4"><a href="customer-satisfaction-and-loyalty.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="st">        CS =~ x18 + x9 + x16</span></span>
<span id="cb239-5"><a href="customer-satisfaction-and-loyalty.html#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="st">        PV =~ x6 + x13r</span></span>
<span id="cb239-6"><a href="customer-satisfaction-and-loyalty.html#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="st">        MK =~ x12 + x7 + x10</span></span>
<span id="cb239-7"><a href="customer-satisfaction-and-loyalty.html#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="st">        TS =~ x8 + x14&#39;</span></span>
<span id="cb239-8"><a href="customer-satisfaction-and-loyalty.html#cb239-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb239-9"><a href="customer-satisfaction-and-loyalty.html#cb239-9" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">cfa</span>(CFA.model, <span class="at">data =</span> data)</span>
<span id="cb239-10"><a href="customer-satisfaction-and-loyalty.html#cb239-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summary</span>(fit, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">modindices =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-7 ended normally after 60 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         26
##                                                       
##   Number of observations                           100
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                18.183
##   Degrees of freedom                                29
##   P-value (Chi-square)                           0.940
## 
## Model Test Baseline Model:
## 
##   Test statistic                               530.377
##   Degrees of freedom                                45
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.035
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1221.406
##   Loglikelihood unrestricted model (H1)      -1212.314
##                                                       
##   Akaike (AIC)                                2494.812
##   Bayesian (BIC)                              2562.546
##   Sample-size adjusted Bayesian (BIC)         2480.432
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.016
##   P-value RMSEA &lt;= 0.05                          0.989
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.039
## 
## Parameter Estimates:
## 
##   Standard errors                             Standard
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS =~                                                                 
##     x18               1.000                               0.677    0.926
##     x9                1.658    0.113   14.664    0.000    1.123    0.934
##     x16               1.107    0.098   11.294    0.000    0.749    0.811
##   PV =~                                                                 
##     x6                1.000                               0.625    0.450
##     x13r              2.197    0.962    2.284    0.022    1.372    0.893
##   MK =~                                                                 
##     x12               1.000                               1.066    0.999
##     x7                0.518    0.063    8.249    0.000    0.552    0.792
##     x10               0.571    0.103    5.531    0.000    0.609    0.543
##   TS =~                                                                 
##     x8                1.000                               1.280    0.841
##     x14               0.604    0.135    4.467    0.000    0.774    0.948
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS ~~                                                                 
##     PV                0.055    0.054    1.022    0.307    0.131    0.131
##     MK                0.191    0.077    2.471    0.013    0.265    0.265
##     TS                0.123    0.097    1.272    0.203    0.142    0.142
##   PV ~~                                                                 
##     MK               -0.199    0.112   -1.774    0.076   -0.299   -0.299
##     TS                0.239    0.144    1.665    0.096    0.299    0.299
##   MK ~~                                                                 
##     TS                0.127    0.145    0.880    0.379    0.093    0.093
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .x18               0.076    0.022    3.434    0.001    0.076    0.142
##    .x9                0.185    0.059    3.137    0.002    0.185    0.128
##    .x16               0.292    0.048    6.108    0.000    0.292    0.342
##    .x6                1.540    0.268    5.750    0.000    1.540    0.798
##    .x13r              0.480    0.756    0.635    0.525    0.480    0.203
##    .x12               0.003    0.106    0.026    0.979    0.003    0.002
##    .x7                0.181    0.038    4.714    0.000    0.181    0.372
##    .x10               0.887    0.130    6.813    0.000    0.887    0.705
##    .x8                0.681    0.362    1.882    0.060    0.681    0.294
##    .x14               0.067    0.128    0.523    0.601    0.067    0.100
##     CS                0.458    0.077    5.936    0.000    1.000    1.000
##     PV                0.390    0.227    1.721    0.085    1.000    1.000
##     MK                1.136    0.193    5.886    0.000    1.000    1.000
##     TS                1.638    0.469    3.494    0.000    1.000    1.000</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="customer-satisfaction-and-loyalty.html#cb241-1" aria-hidden="true" tabindex="-1"></a>    semTools<span class="sc">::</span><span class="fu">reliability</span>(fit)</span></code></pre></div>
<pre><code>##               CS        PV        MK        TS
## alpha  0.8971043 0.5706463 0.7829833 0.7977744
## omega  0.9214780 0.6637334 0.8224869 0.8494229
## omega2 0.9214780 0.6637334 0.8224869 0.8494229
## omega3 0.9215495 0.6637332 0.8225741 0.8494228
## avevar 0.8046227 0.5294845 0.6286031 0.7495027</code></pre>
<p>given alpha, omega and avevar values overpass the recommended values, one can conclude that all factors display good reliability.</p>
<p>Although it does not appear as if the PV <code>avevar</code> does not meet the 60% goal.</p>
<p>With x13 reversed, we see that the model is far better. Although it does not entirely meet the requirements.</p>
</div>
<div id="examine-discriminant-validity-of-the-factors" class="section level7" number="2.3.2.2.2.1.4">
<p class="heading" number="2.3.2.2.2.1.4"><span class="header-section-number">2.3.2.2.2.1.4</span> <strong>4). Examine DISCRIMINANT VALIDITY of the factors</strong></p>
<p>each pair of latent correlations (correlations between the principal components) should be sufficiently below 1 (in absolute value), that the latent variables can be thought of representing two distinct contructs. (to recall, back to the slides to refer to this concept).</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="customer-satisfaction-and-loyalty.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">discriminantValidity</span>(fit, <span class="at">merge=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="kable-table">
<table style="width:100%;">
<colgroup>
<col width="3%" />
<col width="2%" />
<col width="3%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="2%" />
<col width="8%" />
<col width="8%" />
<col width="9%" />
<col width="10%" />
<col width="7%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">lhs</th>
<th align="left">op</th>
<th align="left">rhs</th>
<th align="right">est</th>
<th align="right">ci.lower</th>
<th align="right">ci.upper</th>
<th align="right">Df</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
<th align="right">Chisq</th>
<th align="right">Chisq diff</th>
<th align="right">Df diff</th>
<th align="right">Pr(&gt;Chisq)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CS</td>
<td align="left">~~</td>
<td align="left">PV</td>
<td align="right">0.1305940</td>
<td align="right">-0.0961131</td>
<td align="right">0.3573012</td>
<td align="right">32</td>
<td align="right">2522.142</td>
<td align="right">2582.061</td>
<td align="right">51.51374</td>
<td align="right">33.33044</td>
<td align="right">3</td>
<td align="right">3.00e-07</td>
</tr>
<tr class="even">
<td align="left">CS</td>
<td align="left">~~</td>
<td align="left">MK</td>
<td align="right">0.2650079</td>
<td align="right">0.0744574</td>
<td align="right">0.4555583</td>
<td align="right">32</td>
<td align="right">2623.696</td>
<td align="right">2683.615</td>
<td align="right">153.06726</td>
<td align="right">134.88395</td>
<td align="right">3</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="odd">
<td align="left">CS</td>
<td align="left">~~</td>
<td align="left">TS</td>
<td align="right">0.1420574</td>
<td align="right">-0.0659618</td>
<td align="right">0.3500766</td>
<td align="right">32</td>
<td align="right">2596.806</td>
<td align="right">2656.725</td>
<td align="right">126.17795</td>
<td align="right">107.99464</td>
<td align="right">3</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">PV</td>
<td align="left">~~</td>
<td align="left">MK</td>
<td align="right">-0.2993652</td>
<td align="right">-0.5271069</td>
<td align="right">-0.0716235</td>
<td align="right">32</td>
<td align="right">2514.275</td>
<td align="right">2574.194</td>
<td align="right">43.64625</td>
<td align="right">25.46294</td>
<td align="right">3</td>
<td align="right">1.24e-05</td>
</tr>
<tr class="odd">
<td align="left">PV</td>
<td align="left">~~</td>
<td align="left">TS</td>
<td align="right">0.2992056</td>
<td align="right">0.0620862</td>
<td align="right">0.5363251</td>
<td align="right">32</td>
<td align="right">2517.564</td>
<td align="right">2577.483</td>
<td align="right">46.93603</td>
<td align="right">28.75273</td>
<td align="right">3</td>
<td align="right">2.50e-06</td>
</tr>
<tr class="even">
<td align="left">MK</td>
<td align="left">~~</td>
<td align="left">TS</td>
<td align="right">0.0934218</td>
<td align="right">-0.1100485</td>
<td align="right">0.2968921</td>
<td align="right">32</td>
<td align="right">2598.582</td>
<td align="right">2658.501</td>
<td align="right">127.95325</td>
<td align="right">109.76994</td>
<td align="right">3</td>
<td align="right">0.00e+00</td>
</tr>
</tbody>
</table>
</div>
<p>Output:</p>
<ul>
<li>The first set are factor correlation estimates and their confidence intervals.</li>
<li>Are these correlations sufficiently low to claim discriminant validity of the four constructs?</li>
<li>Based on Fornell &amp; Larcker (1981), the square root of each construct´s AVE should have a greater value than the inter-constructs corelations (alternatitvely, AVE &gt; corr^2). Let us check that:</li>
</ul>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="customer-satisfaction-and-loyalty.html#cb244-1" aria-hidden="true" tabindex="-1"></a>reliability_out <span class="ot">=</span> <span class="fu">reliability</span> (fit)</span>
<span id="cb244-2"><a href="customer-satisfaction-and-loyalty.html#cb244-2" aria-hidden="true" tabindex="-1"></a>    AVEs <span class="ot">=</span> reliability_out[<span class="dv">5</span>,]</span>
<span id="cb244-3"><a href="customer-satisfaction-and-loyalty.html#cb244-3" aria-hidden="true" tabindex="-1"></a>    sqrtAVEs <span class="ot">=</span> <span class="fu">sqrt</span>(AVEs)</span>
<span id="cb244-4"><a href="customer-satisfaction-and-loyalty.html#cb244-4" aria-hidden="true" tabindex="-1"></a>    sqrtAVEs</span></code></pre></div>
<pre><code>##        CS        PV        MK        TS 
## 0.8970076 0.7276569 0.7928449 0.8657383</code></pre>
<p>Comparing the inter-constructs correlations (see “est”" column in the output of discriminantValidity(fit, merge=TRUE)) with the sqrtAVEs, we conclude that cf. Fornell &amp; Larcker (1981) criterion, the four constructss display significant discriminat validity.</p>
<p>Now we can plot the CFA. notice that the arrows are not yet directed hence you have not yet imposed the structure that we are going to do in SEM.</p>
<div id="htmlwidget-1b4ff99564eb6e8884a5" style="width:720px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-1b4ff99564eb6e8884a5">{"x":{"diagram":" digraph plot { \n graph [ overlap = true, fontsize = 10 ] \n node [ shape = box, fontname = Helvetica ] \n node [shape = box] \n x18; x9; x16; x6; x13r; x12; x7; x10; x8; x14 \n node [shape = oval] \n CS; PV; MK; TS \n \n edge [ color = grey ] \n  CS->x18 [label = \"0.93\"] CS->x9 [label = \"0.93\"] CS->x16 [label = \"0.81\"] PV->x6 [label = \"0.45\"] PV->x13r [label = \"0.89\"] MK->x12 [label = \"1\"] MK->x7 [label = \"0.79\"] MK->x10 [label = \"0.54\"] TS->x8 [label = \"0.84\"] TS->x14 [label = \"0.95\"] PV -> CS [label = \"\", dir = \"both\"] MK -> CS [label = \"0.27*\", dir = \"both\"] TS -> CS [label = \"\", dir = \"both\"] MK -> PV [label = \"\", dir = \"both\"] TS -> PV [label = \"\", dir = \"both\"] TS -> MK [label = \"\", dir = \"both\"]\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
<div id="sem" class="section level4" number="2.3.2.3">
<h4><span class="header-section-number">2.3.2.3</span> SEM</h4>
<p>NOTE: Three variables were not included in the CFA (x11, x15, x17) as these did not meet the assumptions, reasoning both in the EFA and CFA for x11.</p>
<p>Reason: These variables did not load high on any of the main constructs If they are important, they can be treated as separate explanatory variables in SEM
last DV in our SEM model will be x19-Satisfaction. in other words, we build a model to explain x19</p>
<p>Notice that we are also continuing to use the reversed version of x13r.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="customer-satisfaction-and-loyalty.html#cb246-1" aria-hidden="true" tabindex="-1"></a>SEM.model1 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb246-2"><a href="customer-satisfaction-and-loyalty.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb246-3"><a href="customer-satisfaction-and-loyalty.html#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="st">        CS =~ x18 + x9 + x16</span></span>
<span id="cb246-4"><a href="customer-satisfaction-and-loyalty.html#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="st">        PV =~ x6 + x13r</span></span>
<span id="cb246-5"><a href="customer-satisfaction-and-loyalty.html#cb246-5" aria-hidden="true" tabindex="-1"></a><span class="st">        MK =~ x12 + x7 + x10</span></span>
<span id="cb246-6"><a href="customer-satisfaction-and-loyalty.html#cb246-6" aria-hidden="true" tabindex="-1"></a><span class="st">        TS =~ x8 + x14</span></span>
<span id="cb246-7"><a href="customer-satisfaction-and-loyalty.html#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb246-8"><a href="customer-satisfaction-and-loyalty.html#cb246-8" aria-hidden="true" tabindex="-1"></a><span class="st">        x19 ~ CS + PV + MK + TS&#39;</span></span></code></pre></div>
<p>Now we can fit the model</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="customer-satisfaction-and-loyalty.html#cb247-1" aria-hidden="true" tabindex="-1"></a>fitSEM1 <span class="ot">&lt;-</span> <span class="fu">sem</span>(SEM.model1</span>
<span id="cb247-2"><a href="customer-satisfaction-and-loyalty.html#cb247-2" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">data=</span>data</span>
<span id="cb247-3"><a href="customer-satisfaction-and-loyalty.html#cb247-3" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">se=</span><span class="st">&quot;robust&quot;</span></span>
<span id="cb247-4"><a href="customer-satisfaction-and-loyalty.html#cb247-4" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">estimator =</span> <span class="st">&quot;ML&quot;</span>) <span class="co">#Maximum Likelihood, that is the standard</span></span>
<span id="cb247-5"><a href="customer-satisfaction-and-loyalty.html#cb247-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-6"><a href="customer-satisfaction-and-loyalty.html#cb247-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitSEM1, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">rsquare=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-7 ended normally after 60 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         31
##                                                       
##   Number of observations                           100
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                32.225
##   Degrees of freedom                                35
##   P-value (Chi-square)                           0.603
## 
## Model Test Baseline Model:
## 
##   Test statistic                               688.965
##   Degrees of freedom                                55
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.007
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1308.074
##   Loglikelihood unrestricted model (H1)      -1291.961
##                                                       
##   Akaike (AIC)                                2678.148
##   Bayesian (BIC)                              2758.908
##   Sample-size adjusted Bayesian (BIC)         2661.002
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.064
##   P-value RMSEA &lt;= 0.05                          0.877
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.064
## 
## Parameter Estimates:
## 
##   Standard errors                           Robust.sem
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS =~                                                                 
##     x18               1.000                               0.678    0.928
##     x9                1.652    0.127   12.995    0.000    1.120    0.932
##     x16               1.106    0.102   10.858    0.000    0.750    0.812
##   PV =~                                                                 
##     x6                1.000                               1.126    0.810
##     x13r              0.676    0.125    5.422    0.000    0.761    0.495
##   MK =~                                                                 
##     x12               1.000                               1.150    1.078
##     x7                0.447    0.048    9.309    0.000    0.514    0.737
##     x10               0.466    0.063    7.340    0.000    0.535    0.478
##   TS =~                                                                 
##     x8                1.000                               1.057    0.694
##     x14               0.886    0.452    1.960    0.050    0.936    1.148
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   x19 ~                                                                 
##     CS                0.787    0.116    6.758    0.000    0.534    0.450
##     PV                0.663    0.110    6.022    0.000    0.746    0.629
##     MK                0.518    0.078    6.671    0.000    0.595    0.502
##     TS               -0.039    0.045   -0.870    0.384   -0.042   -0.035
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS ~~                                                                 
##     PV                0.090    0.099    0.912    0.362    0.118    0.118
##     MK                0.181    0.083    2.194    0.028    0.232    0.232
##     TS                0.099    0.091    1.088    0.277    0.138    0.138
##   PV ~~                                                                 
##     MK               -0.269    0.146   -1.838    0.066   -0.208   -0.208
##     TS                0.131    0.142    0.920    0.357    0.110    0.110
##   MK ~~                                                                 
##     TS                0.137    0.131    1.046    0.296    0.112    0.112
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .x18               0.074    0.017    4.328    0.000    0.074    0.139
##    .x9                0.191    0.045    4.274    0.000    0.191    0.132
##    .x16               0.291    0.041    7.080    0.000    0.291    0.341
##    .x6                0.663    0.203    3.261    0.001    0.663    0.343
##    .x13r              1.784    0.206    8.662    0.000    1.784    0.755
##    .x12              -0.184    0.085   -2.161    0.031   -0.184   -0.162
##    .x7                0.222    0.037    6.005    0.000    0.222    0.456
##    .x10               0.971    0.113    8.580    0.000    0.971    0.772
##    .x8                1.201    0.576    2.083    0.037    1.201    0.518
##    .x14              -0.212    0.424   -0.499    0.618   -0.212   -0.318
##    .x19               0.170    0.087    1.963    0.050    0.170    0.121
##     CS                0.460    0.077    5.942    0.000    1.000    1.000
##     PV                1.267    0.261    4.861    0.000    1.000    1.000
##     MK                1.322    0.186    7.119    0.000    1.000    1.000
##     TS                1.118    0.645    1.734    0.083    1.000    1.000
## 
## R-Square:
##                    Estimate
##     x18               0.861
##     x9                0.868
##     x16               0.659
##     x6                0.657
##     x13r              0.245
##     x12                  NA
##     x7                0.544
##     x10               0.228
##     x8                0.482
##     x14                  NA
##     x19               0.879</code></pre>
<p>If the message “lavaan WARNING: some estimated ov variances are negative” shows up. In this case, the problematic items are x12 and x14. It reflects that we would need more quality data and more items per construct to run this model.</p>
<p>We set se=“robust” to produce robust standard errors; setting se=“boot” or se=“bootstrap” will produce bootstrap standard errors.</p>
<p>Now we can check the information critera / indexes as we did in the CFA. The following is a summary of all important criteria.</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="customer-satisfaction-and-loyalty.html#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitmeasures</span>(fit) <span class="co"># alternative summary</span></span></code></pre></div>
<pre><code>##                npar                fmin               chisq                  df 
##              26.000               0.091              18.183              29.000 
##              pvalue      baseline.chisq         baseline.df     baseline.pvalue 
##               0.940             530.377              45.000               0.000 
##                 cfi                 tli                nnfi                 rfi 
##               1.000               1.035               1.035               0.947 
##                 nfi                pnfi                 ifi                 rni 
##               0.966               0.622               1.022               1.022 
##                logl   unrestricted.logl                 aic                 bic 
##           -1221.406           -1212.314            2494.812            2562.546 
##              ntotal                bic2               rmsea      rmsea.ci.lower 
##             100.000            2480.432               0.000               0.000 
##      rmsea.ci.upper        rmsea.pvalue                 rmr          rmr_nomean 
##               0.016               0.989               0.048               0.048 
##                srmr        srmr_bentler srmr_bentler_nomean                crmr 
##               0.039               0.039               0.039               0.043 
##         crmr_nomean          srmr_mplus   srmr_mplus_nomean               cn_05 
##               0.043               0.039               0.039             235.044 
##               cn_01                 gfi                agfi                pgfi 
##             273.711               0.966               0.935               0.509 
##                 mfi                ecvi 
##               1.056               0.702</code></pre>
<p>Next, check the structural coeficients in summary(). Output partially reproduced below:</p>
<p>Regressions:
Estimate Std.Err z-value P(&gt;|z|) Std.lv Std.all
x19 ~<br />
CS 0.787 0.116 6.758 0.000 0.534 0.450
PV 0.663 0.110 6.022 0.000 0.746 0.629
MK 0.518 0.078 6.671 0.000 0.595 0.502
TS -0.039 0.045 -0.870 0.384 -0.042 -0.035</p>
<p>Concl.: Customers perceptions about CS, PV and MK are positively and significantly correlated with satisfaction. TS (Technical Service) perceptions is not significantly related to customer satisfaction.</p>
<p><strong>check modification indices if relevant</strong></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="customer-satisfaction-and-loyalty.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitSEM1, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">rsquare=</span><span class="cn">TRUE</span>, <span class="at">modindices=</span><span class="cn">TRUE</span>)</span>
<span id="cb251-2"><a href="customer-satisfaction-and-loyalty.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(fitSEM1, <span class="at">sort =</span> T, <span class="at">minimum.value =</span> <span class="dv">10</span>, <span class="at">op =</span> <span class="st">&quot;~~&quot;</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-7 ended normally after 60 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         31
##                                                       
##   Number of observations                           100
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                32.225
##   Degrees of freedom                                35
##   P-value (Chi-square)                           0.603
## 
## Model Test Baseline Model:
## 
##   Test statistic                               688.965
##   Degrees of freedom                                55
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    1.000
##   Tucker-Lewis Index (TLI)                       1.007
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1308.074
##   Loglikelihood unrestricted model (H1)      -1291.961
##                                                       
##   Akaike (AIC)                                2678.148
##   Bayesian (BIC)                              2758.908
##   Sample-size adjusted Bayesian (BIC)         2661.002
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.000
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.064
##   P-value RMSEA &lt;= 0.05                          0.877
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.064
## 
## Parameter Estimates:
## 
##   Standard errors                           Robust.sem
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS =~                                                                 
##     x18               1.000                               0.678    0.928
##     x9                1.652    0.127   12.995    0.000    1.120    0.932
##     x16               1.106    0.102   10.858    0.000    0.750    0.812
##   PV =~                                                                 
##     x6                1.000                               1.126    0.810
##     x13r              0.676    0.125    5.422    0.000    0.761    0.495
##   MK =~                                                                 
##     x12               1.000                               1.150    1.078
##     x7                0.447    0.048    9.309    0.000    0.514    0.737
##     x10               0.466    0.063    7.340    0.000    0.535    0.478
##   TS =~                                                                 
##     x8                1.000                               1.057    0.694
##     x14               0.886    0.452    1.960    0.050    0.936    1.148
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   x19 ~                                                                 
##     CS                0.787    0.116    6.758    0.000    0.534    0.450
##     PV                0.663    0.110    6.022    0.000    0.746    0.629
##     MK                0.518    0.078    6.671    0.000    0.595    0.502
##     TS               -0.039    0.045   -0.870    0.384   -0.042   -0.035
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS ~~                                                                 
##     PV                0.090    0.099    0.912    0.362    0.118    0.118
##     MK                0.181    0.083    2.194    0.028    0.232    0.232
##     TS                0.099    0.091    1.088    0.277    0.138    0.138
##   PV ~~                                                                 
##     MK               -0.269    0.146   -1.838    0.066   -0.208   -0.208
##     TS                0.131    0.142    0.920    0.357    0.110    0.110
##   MK ~~                                                                 
##     TS                0.137    0.131    1.046    0.296    0.112    0.112
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .x18               0.074    0.017    4.328    0.000    0.074    0.139
##    .x9                0.191    0.045    4.274    0.000    0.191    0.132
##    .x16               0.291    0.041    7.080    0.000    0.291    0.341
##    .x6                0.663    0.203    3.261    0.001    0.663    0.343
##    .x13r              1.784    0.206    8.662    0.000    1.784    0.755
##    .x12              -0.184    0.085   -2.161    0.031   -0.184   -0.162
##    .x7                0.222    0.037    6.005    0.000    0.222    0.456
##    .x10               0.971    0.113    8.580    0.000    0.971    0.772
##    .x8                1.201    0.576    2.083    0.037    1.201    0.518
##    .x14              -0.212    0.424   -0.499    0.618   -0.212   -0.318
##    .x19               0.170    0.087    1.963    0.050    0.170    0.121
##     CS                0.460    0.077    5.942    0.000    1.000    1.000
##     PV                1.267    0.261    4.861    0.000    1.000    1.000
##     MK                1.322    0.186    7.119    0.000    1.000    1.000
##     TS                1.118    0.645    1.734    0.083    1.000    1.000
## 
## R-Square:
##                    Estimate
##     x18               0.861
##     x9                0.868
##     x16               0.659
##     x6                0.657
##     x13r              0.245
##     x12                  NA
##     x7                0.544
##     x10               0.228
##     x8                0.482
##     x14                  NA
##     x19               0.879
## 
## Modification Indices:
## 
##      lhs op  rhs    mi    epc sepc.lv sepc.all sepc.nox
## 36    CS =~   x6 0.356 -0.197  -0.133   -0.096   -0.096
## 37    CS =~ x13r 0.356  0.133   0.090    0.059    0.059
## 38    CS =~  x12 0.455 -0.092  -0.062   -0.058   -0.058
## 39    CS =~   x7 0.001  0.002   0.001    0.002    0.002
## 40    CS =~  x10 2.401  0.234   0.159    0.142    0.142
## 41    CS =~   x8 0.158 -0.079  -0.054   -0.035   -0.035
## 42    CS =~  x14 0.158  0.070   0.048    0.058    0.058
## 43    PV =~  x18 2.442 -0.055  -0.062   -0.085   -0.085
## 44    PV =~   x9 1.008  0.058   0.066    0.055    0.055
## 45    PV =~  x16 0.612  0.043   0.049    0.053    0.053
## 46    PV =~  x12 0.806  0.077   0.087    0.081    0.081
## 47    PV =~   x7 1.280 -0.049  -0.055   -0.079   -0.079
## 48    PV =~  x10 0.058  0.023   0.026    0.023    0.023
## 49    PV =~   x8 1.002  0.095   0.107    0.070    0.070
## 50    PV =~  x14 1.002 -0.084  -0.095   -0.116   -0.116
## 51    MK =~  x18 0.376  0.017   0.020    0.027    0.027
## 52    MK =~   x9 0.064 -0.012  -0.014   -0.011   -0.011
## 53    MK =~  x16 0.274 -0.024  -0.028   -0.030   -0.030
## 54    MK =~   x6 3.377  0.329   0.378    0.272    0.272
## 55    MK =~ x13r 3.377 -0.222  -0.256   -0.166   -0.166
## 56    MK =~   x8 0.708 -0.083  -0.095   -0.063   -0.063
## 57    MK =~  x14 0.708  0.073   0.084    0.104    0.104
## 58    TS =~  x18 0.404 -0.018  -0.019   -0.026   -0.026
## 59    TS =~   x9 0.291 -0.025  -0.026   -0.022   -0.022
## 60    TS =~  x16 2.951  0.078   0.083    0.090    0.090
## 61    TS =~   x6 2.902 -0.287  -0.304   -0.219   -0.219
## 62    TS =~ x13r 2.902  0.194   0.206    0.134    0.134
## 63    TS =~  x12 0.211  0.031   0.032    0.030    0.030
## 64    TS =~   x7 0.159 -0.014  -0.014   -0.021   -0.021
## 65    TS =~  x10 0.071 -0.020  -0.021   -0.019   -0.019
## 66   x18 ~~   x9 0.036  0.011   0.011    0.091    0.091
## 67   x18 ~~  x16 0.045 -0.006  -0.006   -0.044   -0.044
## 68   x18 ~~   x6 1.441 -0.041  -0.041   -0.185   -0.185
## 69   x18 ~~ x13r 0.029 -0.008  -0.008   -0.022   -0.022
## 70   x18 ~~  x12 0.427 -0.011  -0.011   -0.092   -0.092
## 71   x18 ~~   x7 0.559  0.011   0.011    0.083    0.083
## 72   x18 ~~  x10 2.482  0.051   0.051    0.192    0.192
## 73   x18 ~~   x8 1.139 -0.034  -0.034   -0.114   -0.114
## 74   x18 ~~  x14 0.091  0.005   0.005    0.041    0.041
## 75   x18 ~~  x19 0.051  0.005   0.005    0.046    0.046
## 76    x9 ~~  x16 0.004  0.003   0.003    0.014    0.014
## 77    x9 ~~   x6 0.481  0.039   0.039    0.109    0.109
## 78    x9 ~~ x13r 0.630  0.062   0.062    0.106    0.106
## 79    x9 ~~  x12 0.473  0.018   0.018    0.099    0.099
## 80    x9 ~~   x7 0.507 -0.017  -0.017   -0.080   -0.080
## 81    x9 ~~  x10 0.916 -0.051  -0.051   -0.119   -0.119
## 82    x9 ~~   x8 2.939  0.089   0.089    0.186    0.186
## 83    x9 ~~  x14 2.066 -0.040  -0.040   -0.201   -0.201
## 84    x9 ~~  x19 0.058 -0.009  -0.009   -0.050   -0.050
## 85   x16 ~~   x6 0.031  0.009   0.009    0.021    0.021
## 86   x16 ~~ x13r 0.049  0.017   0.017    0.024    0.024
## 87   x16 ~~  x12 0.560 -0.020  -0.020   -0.084   -0.084
## 88   x16 ~~   x7 0.836  0.022   0.022    0.085    0.085
## 89   x16 ~~  x10 0.004  0.003   0.003    0.006    0.006
## 90   x16 ~~   x8 1.439 -0.063  -0.063   -0.107   -0.107
## 91   x16 ~~  x14 3.275  0.051   0.051    0.203    0.203
## 92   x16 ~~  x19 0.000  0.001   0.001    0.003    0.003
## 94    x6 ~~  x12 0.161  0.039   0.039    0.111    0.111
## 95    x6 ~~   x7 0.256  0.026   0.026    0.067    0.067
## 96    x6 ~~  x10 0.046 -0.021  -0.021   -0.026   -0.026
## 97    x6 ~~   x8 0.021  0.014   0.014    0.016    0.016
## 98    x6 ~~  x14 0.865 -0.067  -0.067   -0.179   -0.179
## 99    x6 ~~  x19 7.958  1.408   1.408    4.191    4.191
## 100 x13r ~~  x12 0.784 -0.081  -0.081   -0.141   -0.141
## 101 x13r ~~   x7 0.004 -0.004  -0.004   -0.006   -0.006
## 102 x13r ~~  x10 0.080 -0.037  -0.037   -0.028   -0.028
## 103 x13r ~~   x8 1.321  0.146   0.146    0.100    0.100
## 104 x13r ~~  x14 0.197  0.031   0.031    0.050    0.050
## 105 x13r ~~  x19 7.958 -0.952  -0.952   -1.728   -1.728
## 106  x12 ~~   x7 0.494  0.082   0.082    0.405    0.405
## 107  x12 ~~  x10 2.507 -0.136  -0.136   -0.322   -0.322
## 108  x12 ~~   x8 0.019 -0.007  -0.007   -0.014   -0.014
## 109  x12 ~~  x14 0.125  0.012   0.012    0.059    0.059
## 110  x12 ~~  x19 2.831  0.158   0.158    0.894    0.894
## 111   x7 ~~  x10 1.855  0.066   0.066    0.142    0.142
## 112   x7 ~~   x8 0.029  0.006   0.006    0.013    0.013
## 113   x7 ~~  x14 0.114 -0.007  -0.007   -0.032   -0.032
## 114   x7 ~~  x19 3.051 -0.066  -0.066   -0.341   -0.341
## 115  x10 ~~   x8 0.446 -0.058  -0.058   -0.054   -0.054
## 116  x10 ~~  x14 0.023  0.007   0.007    0.015    0.015
## 117  x10 ~~  x19 0.124  0.021   0.021    0.052    0.052
## 119   x8 ~~  x19 0.000  0.000   0.000    0.001    0.001
## 120  x14 ~~  x19 0.000  0.000   0.000   -0.002   -0.002</code></pre>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">lhs</th>
<th align="left">op</th>
<th align="left">rhs</th>
<th align="right">mi</th>
<th align="right">epc</th>
<th align="right">sepc.lv</th>
<th align="right">sepc.all</th>
<th align="right">sepc.nox</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<p>First we see the summary, and we can assess for improvements, there does not appear to be any.</p>
<p>no suggestion for improvement</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="customer-satisfaction-and-loyalty.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If required, the bootstrap model parameters are available with:</span></span>
<span id="cb253-2"><a href="customer-satisfaction-and-loyalty.html#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="co"># PAR.boot &lt;- bootstrapLavaan(fitSEM1, R=10, type=&quot;ordinary&quot;,FUN=&quot;coef&quot;)</span></span>
<span id="cb253-3"><a href="customer-satisfaction-and-loyalty.html#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co"># T.boot &lt;- bootstrapLavaan(fitSEM1, R=10, type=&quot;bollen.stine&quot;,FUN=fitMeasures, fit.measures=&quot;chisq&quot;)</span></span></code></pre></div>
</div>
</div>
<div id="plotting-the-model" class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Plotting the model</h3>
<div id="htmlwidget-8f836166d559454ecd73" style="width:720px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-8f836166d559454ecd73">{"x":{"diagram":" digraph plot { \n graph [ overlap = true, fontsize = 10 ] \n node [ shape = box, fontname = Helvetica ] \n node [shape = box] \n x19; x18; x9; x16; x6; x13r; x12; x7; x10; x8; x14 \n node [shape = oval] \n CS; PV; MK; TS \n x19 [label = \"SATISFACTION\"] \n edge [ color = grey ] \n CS->x19 [label = \"0.45***\"] PV->x19 [label = \"0.63***\"] MK->x19 [label = \"0.5***\"] TS->x19 [label = \"\"] CS->x18 [label = \"0.93\"] CS->x9 [label = \"0.93\"] CS->x16 [label = \"0.81\"] PV->x6 [label = \"0.81\"] PV->x13r [label = \"0.5\"] MK->x12 [label = \"1.08\"] MK->x7 [label = \"0.74\"] MK->x10 [label = \"0.48\"] TS->x8 [label = \"0.69\"] TS->x14 [label = \"1.15\"] PV -> CS [label = \"\", dir = \"both\"] MK -> CS [label = \"0.23\", dir = \"both\"] TS -> CS [label = \"\", dir = \"both\"] MK -> PV [label = \"\", dir = \"both\"] TS -> PV [label = \"\", dir = \"both\"] TS -> MK [label = \"\", dir = \"both\"]\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>and this is another plot</p>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-132-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>This also show what variables that should be exlcuded.</p>
<p>Note: to improve the model, exclude the items with the negative variance. hence the two items, x12 and x14</p>
</div>
<div id="consider-a-more-complex-sem-model-involving-a-mediating-effect." class="section level3" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Consider a more complex SEM model involving a mediating effect.</h3>
<p>Consistent with the theory, Sem.model2 proposed x19 (Satisfaction) as mediator between the four latent constructs and Likelihood of future purchase (x21).</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="customer-satisfaction-and-loyalty.html#cb254-1" aria-hidden="true" tabindex="-1"></a>SEM.model2 <span class="ot">&lt;-</span> <span class="st">&#39;</span></span>
<span id="cb254-2"><a href="customer-satisfaction-and-loyalty.html#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="st"># Measurement model</span></span>
<span id="cb254-3"><a href="customer-satisfaction-and-loyalty.html#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="st">             CS =~ x18 + x9 + x16</span></span>
<span id="cb254-4"><a href="customer-satisfaction-and-loyalty.html#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="st">             PV =~ x6 + x13r</span></span>
<span id="cb254-5"><a href="customer-satisfaction-and-loyalty.html#cb254-5" aria-hidden="true" tabindex="-1"></a><span class="st">             MK =~ x12 + x7 + x10</span></span>
<span id="cb254-6"><a href="customer-satisfaction-and-loyalty.html#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="st">             TS =~ x8 + x14</span></span>
<span id="cb254-7"><a href="customer-satisfaction-and-loyalty.html#cb254-7" aria-hidden="true" tabindex="-1"></a><span class="st"># Structural model</span></span>
<span id="cb254-8"><a href="customer-satisfaction-and-loyalty.html#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="st">             x19 ~ CS + PV + MK + TS</span></span>
<span id="cb254-9"><a href="customer-satisfaction-and-loyalty.html#cb254-9" aria-hidden="true" tabindex="-1"></a><span class="st">             x21 ~ x19&#39;</span></span>
<span id="cb254-10"><a href="customer-satisfaction-and-loyalty.html#cb254-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-11"><a href="customer-satisfaction-and-loyalty.html#cb254-11" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb254-12"><a href="customer-satisfaction-and-loyalty.html#cb254-12" aria-hidden="true" tabindex="-1"></a>fitSEM2 <span class="ot">&lt;-</span> <span class="fu">sem</span>(SEM.model2, <span class="at">data=</span>data, <span class="at">se=</span><span class="st">&quot;robust&quot;</span>) </span>
<span id="cb254-13"><a href="customer-satisfaction-and-loyalty.html#cb254-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitSEM2, <span class="at">fit.measures=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-7 ended normally after 55 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         33
##                                                       
##   Number of observations                           100
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                45.798
##   Degrees of freedom                                45
##   P-value (Chi-square)                           0.439
## 
## Model Test Baseline Model:
## 
##   Test statistic                               778.988
##   Degrees of freedom                                66
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.999
##   Tucker-Lewis Index (TLI)                       0.998
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1404.638
##   Loglikelihood unrestricted model (H1)      -1381.738
##                                                       
##   Akaike (AIC)                                2875.275
##   Bayesian (BIC)                              2961.246
##   Sample-size adjusted Bayesian (BIC)         2857.023
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.013
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.068
##   P-value RMSEA &lt;= 0.05                          0.814
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.065
## 
## Parameter Estimates:
## 
##   Standard errors                           Robust.sem
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   CS =~                                               
##     x18               1.000                           
##     x9                1.652    0.127   12.995    0.000
##     x16               1.106    0.102   10.858    0.000
##   PV =~                                               
##     x6                1.000                           
##     x13r              0.676    0.125    5.422    0.000
##   MK =~                                               
##     x12               1.000                           
##     x7                0.447    0.048    9.309    0.000
##     x10               0.466    0.063    7.340    0.000
##   TS =~                                               
##     x8                1.000                           
##     x14               0.886    0.452    1.960    0.050
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   x19 ~                                               
##     CS                0.787    0.116    6.758    0.000
##     PV                0.663    0.110    6.022    0.000
##     MK                0.518    0.078    6.671    0.000
##     TS               -0.039    0.045   -0.870    0.384
##   x21 ~                                               
##     x19               0.574    0.055   10.450    0.000
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##   CS ~~                                               
##     PV                0.090    0.099    0.912    0.362
##     MK                0.181    0.083    2.194    0.028
##     TS                0.099    0.091    1.088    0.277
##   PV ~~                                               
##     MK               -0.269    0.146   -1.838    0.066
##     TS                0.131    0.142    0.920    0.357
##   MK ~~                                               
##     TS                0.137    0.131    1.046    0.296
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)
##    .x18               0.074    0.017    4.328    0.000
##    .x9                0.191    0.045    4.274    0.000
##    .x16               0.291    0.041    7.080    0.000
##    .x6                0.663    0.203    3.261    0.001
##    .x13r              1.784    0.206    8.662    0.000
##    .x12              -0.184    0.085   -2.161    0.031
##    .x7                0.222    0.037    6.005    0.000
##    .x10               0.971    0.113    8.580    0.000
##    .x8                1.201    0.576    2.083    0.037
##    .x14              -0.212    0.424   -0.499    0.618
##    .x19               0.170    0.087    1.963    0.050
##    .x21               0.404    0.047    8.674    0.000
##     CS                0.460    0.077    5.942    0.000
##     PV                1.267    0.261    4.861    0.000
##     MK                1.322    0.186    7.119    0.000
##     TS                1.118    0.645    1.734    0.083</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="customer-satisfaction-and-loyalty.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fitSEM2, <span class="at">fit.measures=</span><span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>, <span class="at">rsquare=</span><span class="cn">TRUE</span>, <span class="at">modindices=</span><span class="cn">TRUE</span>)</span>
<span id="cb256-2"><a href="customer-satisfaction-and-loyalty.html#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">modificationindices</span>(fitSEM2, <span class="at">sort =</span> T, <span class="at">minimum.value =</span> <span class="dv">10</span>, <span class="at">op =</span> <span class="st">&quot;~~&quot;</span>)</span></code></pre></div>
<pre><code>## lavaan 0.6-7 ended normally after 55 iterations
## 
##   Estimator                                         ML
##   Optimization method                           NLMINB
##   Number of free parameters                         33
##                                                       
##   Number of observations                           100
##                                                       
## Model Test User Model:
##                                                       
##   Test statistic                                45.798
##   Degrees of freedom                                45
##   P-value (Chi-square)                           0.439
## 
## Model Test Baseline Model:
## 
##   Test statistic                               778.988
##   Degrees of freedom                                66
##   P-value                                        0.000
## 
## User Model versus Baseline Model:
## 
##   Comparative Fit Index (CFI)                    0.999
##   Tucker-Lewis Index (TLI)                       0.998
## 
## Loglikelihood and Information Criteria:
## 
##   Loglikelihood user model (H0)              -1404.638
##   Loglikelihood unrestricted model (H1)      -1381.738
##                                                       
##   Akaike (AIC)                                2875.275
##   Bayesian (BIC)                              2961.246
##   Sample-size adjusted Bayesian (BIC)         2857.023
## 
## Root Mean Square Error of Approximation:
## 
##   RMSEA                                          0.013
##   90 Percent confidence interval - lower         0.000
##   90 Percent confidence interval - upper         0.068
##   P-value RMSEA &lt;= 0.05                          0.814
## 
## Standardized Root Mean Square Residual:
## 
##   SRMR                                           0.065
## 
## Parameter Estimates:
## 
##   Standard errors                           Robust.sem
##   Information                                 Expected
##   Information saturated (h1) model          Structured
## 
## Latent Variables:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS =~                                                                 
##     x18               1.000                               0.678    0.928
##     x9                1.652    0.127   12.995    0.000    1.120    0.932
##     x16               1.106    0.102   10.858    0.000    0.750    0.812
##   PV =~                                                                 
##     x6                1.000                               1.126    0.810
##     x13r              0.676    0.125    5.422    0.000    0.761    0.495
##   MK =~                                                                 
##     x12               1.000                               1.150    1.078
##     x7                0.447    0.048    9.309    0.000    0.514    0.737
##     x10               0.466    0.063    7.340    0.000    0.535    0.478
##   TS =~                                                                 
##     x8                1.000                               1.057    0.694
##     x14               0.886    0.452    1.960    0.050    0.936    1.148
## 
## Regressions:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   x19 ~                                                                 
##     CS                0.787    0.116    6.758    0.000    0.534    0.450
##     PV                0.663    0.110    6.022    0.000    0.746    0.629
##     MK                0.518    0.078    6.671    0.000    0.595    0.502
##     TS               -0.039    0.045   -0.870    0.384   -0.042   -0.035
##   x21 ~                                                                 
##     x19               0.574    0.055   10.450    0.000    0.574    0.731
## 
## Covariances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##   CS ~~                                                                 
##     PV                0.090    0.099    0.912    0.362    0.118    0.118
##     MK                0.181    0.083    2.194    0.028    0.232    0.232
##     TS                0.099    0.091    1.088    0.277    0.138    0.138
##   PV ~~                                                                 
##     MK               -0.269    0.146   -1.838    0.066   -0.208   -0.208
##     TS                0.131    0.142    0.920    0.357    0.110    0.110
##   MK ~~                                                                 
##     TS                0.137    0.131    1.046    0.296    0.112    0.112
## 
## Variances:
##                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
##    .x18               0.074    0.017    4.328    0.000    0.074    0.139
##    .x9                0.191    0.045    4.274    0.000    0.191    0.132
##    .x16               0.291    0.041    7.080    0.000    0.291    0.341
##    .x6                0.663    0.203    3.261    0.001    0.663    0.343
##    .x13r              1.784    0.206    8.662    0.000    1.784    0.755
##    .x12              -0.184    0.085   -2.161    0.031   -0.184   -0.162
##    .x7                0.222    0.037    6.005    0.000    0.222    0.456
##    .x10               0.971    0.113    8.580    0.000    0.971    0.772
##    .x8                1.201    0.576    2.083    0.037    1.201    0.518
##    .x14              -0.212    0.424   -0.499    0.618   -0.212   -0.318
##    .x19               0.170    0.087    1.963    0.050    0.170    0.121
##    .x21               0.404    0.047    8.674    0.000    0.404    0.466
##     CS                0.460    0.077    5.942    0.000    1.000    1.000
##     PV                1.267    0.261    4.861    0.000    1.000    1.000
##     MK                1.322    0.186    7.119    0.000    1.000    1.000
##     TS                1.118    0.645    1.734    0.083    1.000    1.000
## 
## R-Square:
##                    Estimate
##     x18               0.861
##     x9                0.868
##     x16               0.659
##     x6                0.657
##     x13r              0.245
##     x12                  NA
##     x7                0.544
##     x10               0.228
##     x8                0.482
##     x14                  NA
##     x19               0.879
##     x21               0.534
## 
## Modification Indices:
## 
##      lhs op  rhs    mi    epc sepc.lv sepc.all sepc.nox
## 38    CS =~   x6 0.356 -0.197  -0.133   -0.096   -0.096
## 39    CS =~ x13r 0.356  0.133   0.090    0.059    0.059
## 40    CS =~  x12 0.455 -0.092  -0.062   -0.058   -0.058
## 41    CS =~   x7 0.001  0.002   0.001    0.002    0.002
## 42    CS =~  x10 2.401  0.234   0.159    0.142    0.142
## 43    CS =~   x8 0.158 -0.079  -0.054   -0.035   -0.035
## 44    CS =~  x14 0.158  0.070   0.048    0.058    0.058
## 45    PV =~  x18 2.442 -0.055  -0.062   -0.085   -0.085
## 46    PV =~   x9 1.008  0.058   0.066    0.055    0.055
## 47    PV =~  x16 0.612  0.043   0.049    0.053    0.053
## 48    PV =~  x12 0.806  0.077   0.087    0.081    0.081
## 49    PV =~   x7 1.280 -0.049  -0.055   -0.079   -0.079
## 50    PV =~  x10 0.058  0.023   0.026    0.023    0.023
## 51    PV =~   x8 1.002  0.095   0.107    0.070    0.070
## 52    PV =~  x14 1.002 -0.084  -0.095   -0.116   -0.116
## 53    MK =~  x18 0.376  0.017   0.020    0.027    0.027
## 54    MK =~   x9 0.064 -0.012  -0.014   -0.011   -0.011
## 55    MK =~  x16 0.274 -0.024  -0.028   -0.030   -0.030
## 56    MK =~   x6 3.377  0.329   0.378    0.272    0.272
## 57    MK =~ x13r 3.377 -0.222  -0.256   -0.166   -0.166
## 58    MK =~   x8 0.708 -0.083  -0.095   -0.063   -0.063
## 59    MK =~  x14 0.708  0.073   0.084    0.104    0.104
## 60    TS =~  x18 0.404 -0.018  -0.019   -0.026   -0.026
## 61    TS =~   x9 0.291 -0.025  -0.026   -0.022   -0.022
## 62    TS =~  x16 2.951  0.078   0.083    0.090    0.090
## 63    TS =~   x6 2.901 -0.287  -0.304   -0.219   -0.219
## 64    TS =~ x13r 2.902  0.194   0.206    0.134    0.134
## 65    TS =~  x12 0.211  0.031   0.032    0.030    0.030
## 66    TS =~   x7 0.159 -0.014  -0.014   -0.021   -0.021
## 67    TS =~  x10 0.071 -0.020  -0.021   -0.019   -0.019
## 68   x18 ~~   x9 0.036  0.011   0.011    0.091    0.091
## 69   x18 ~~  x16 0.045 -0.006  -0.006   -0.044   -0.044
## 70   x18 ~~   x6 1.441 -0.041  -0.041   -0.185   -0.185
## 71   x18 ~~ x13r 0.029 -0.008  -0.008   -0.022   -0.022
## 72   x18 ~~  x12 0.427 -0.011  -0.011   -0.092   -0.092
## 73   x18 ~~   x7 0.559  0.011   0.011    0.083    0.083
## 74   x18 ~~  x10 2.482  0.051   0.051    0.192    0.192
## 75   x18 ~~   x8 1.139 -0.034  -0.034   -0.114   -0.114
## 76   x18 ~~  x14 0.091  0.005   0.005    0.041    0.041
## 77   x18 ~~  x19 0.051  0.005   0.005    0.046    0.046
## 78   x18 ~~  x21 0.001  0.000   0.000   -0.003   -0.003
## 79    x9 ~~  x16 0.004  0.003   0.003    0.014    0.014
## 80    x9 ~~   x6 0.481  0.039   0.039    0.109    0.109
## 81    x9 ~~ x13r 0.630  0.062   0.062    0.106    0.106
## 82    x9 ~~  x12 0.473  0.018   0.018    0.099    0.099
## 83    x9 ~~   x7 0.507 -0.017  -0.017   -0.080   -0.080
## 84    x9 ~~  x10 0.916 -0.051  -0.051   -0.119   -0.119
## 85    x9 ~~   x8 2.939  0.089   0.089    0.186    0.186
## 86    x9 ~~  x14 2.066 -0.040  -0.040   -0.201   -0.201
## 87    x9 ~~  x19 0.058 -0.009  -0.009   -0.050   -0.050
## 88    x9 ~~  x21 0.685  0.029   0.029    0.106    0.106
## 89   x16 ~~   x6 0.031  0.009   0.009    0.021    0.021
## 90   x16 ~~ x13r 0.049  0.017   0.017    0.024    0.024
## 91   x16 ~~  x12 0.560 -0.020  -0.020   -0.084   -0.084
## 92   x16 ~~   x7 0.836  0.022   0.022    0.085    0.085
## 93   x16 ~~  x10 0.004  0.003   0.003    0.006    0.006
## 94   x16 ~~   x8 1.439 -0.063  -0.063   -0.107   -0.107
## 95   x16 ~~  x14 3.275  0.051   0.051    0.203    0.203
## 96   x16 ~~  x19 0.000  0.001   0.001    0.003    0.003
## 97   x16 ~~  x21 2.088 -0.053  -0.053   -0.154   -0.154
## 99    x6 ~~  x12 0.161  0.039   0.039    0.111    0.111
## 100   x6 ~~   x7 0.256  0.026   0.026    0.067    0.067
## 101   x6 ~~  x10 0.046 -0.021  -0.021   -0.026   -0.026
## 102   x6 ~~   x8 0.021  0.014   0.014    0.016    0.016
## 103   x6 ~~  x14 0.865 -0.067  -0.067   -0.179   -0.179
## 104   x6 ~~  x19 7.958  1.408   1.408    4.191    4.191
## 105   x6 ~~  x21 2.959  0.100   0.100    0.193    0.193
## 106 x13r ~~  x12 0.784 -0.081  -0.081   -0.141   -0.141
## 107 x13r ~~   x7 0.004 -0.004  -0.004   -0.006   -0.006
## 108 x13r ~~  x10 0.080 -0.037  -0.037   -0.028   -0.028
## 109 x13r ~~   x8 1.321  0.146   0.146    0.100    0.100
## 110 x13r ~~  x14 0.197  0.031   0.031    0.050    0.050
## 111 x13r ~~  x19 7.958 -0.952  -0.952   -1.728   -1.728
## 112 x13r ~~  x21 0.058  0.021   0.021    0.025    0.025
## 113  x12 ~~   x7 0.494  0.082   0.082    0.405    0.405
## 114  x12 ~~  x10 2.507 -0.136  -0.136   -0.322   -0.322
## 115  x12 ~~   x8 0.019 -0.007  -0.007   -0.014   -0.014
## 116  x12 ~~  x14 0.125  0.012   0.012    0.059    0.059
## 117  x12 ~~  x19 2.831  0.158   0.158    0.894    0.894
## 118  x12 ~~  x21 2.442  0.045   0.045    0.164    0.164
## 119   x7 ~~  x10 1.855  0.066   0.066    0.142    0.142
## 120   x7 ~~   x8 0.029  0.006   0.006    0.013    0.013
## 121   x7 ~~  x14 0.114 -0.007  -0.007   -0.032   -0.032
## 122   x7 ~~  x19 3.051 -0.066  -0.066   -0.341   -0.341
## 123   x7 ~~  x21 3.033 -0.045  -0.045   -0.152   -0.152
## 124  x10 ~~   x8 0.446 -0.058  -0.058   -0.054   -0.054
## 125  x10 ~~  x14 0.023  0.007   0.007    0.015    0.015
## 126  x10 ~~  x19 0.124  0.021   0.021    0.052    0.052
## 127  x10 ~~  x21 0.288 -0.032  -0.032   -0.052   -0.052
## 129   x8 ~~  x19 0.000  0.000   0.000    0.001    0.001
## 130   x8 ~~  x21 5.305  0.134   0.134    0.193    0.193
## 131  x14 ~~  x19 0.000  0.000   0.000   -0.002   -0.002
## 132  x14 ~~  x21 4.602 -0.066  -0.066   -0.225   -0.225
## 133  x19 ~~  x21 0.678 -0.032  -0.032   -0.122   -0.122
## 134  x19  ~  x21 0.678 -0.079  -0.079   -0.062   -0.062
## 135  x21  ~   CS 1.460 -0.155  -0.105   -0.113   -0.113
## 136  x21  ~   PV 1.200  0.082   0.093    0.100    0.100
## 137  x21  ~   MK 0.003  0.003   0.003    0.004    0.004
## 138  x21  ~   TS 1.302 -0.057  -0.060   -0.065   -0.065
## 140   CS  ~  x21 1.192 -0.128  -0.188   -0.175   -0.175
## 145   PV  ~  x21 3.038  0.432   0.384    0.358    0.358
## 150   MK  ~  x21 0.432  0.111   0.096    0.090    0.090
## 155   TS  ~  x21 1.366 -0.157  -0.148   -0.138   -0.138</code></pre>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left">lhs</th>
<th align="left">op</th>
<th align="left">rhs</th>
<th align="right">mi</th>
<th align="right">epc</th>
<th align="right">sepc.lv</th>
<th align="right">sepc.all</th>
<th align="right">sepc.nox</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
</div>
<p>Model has a good fit</p>
<p>Plotting the model</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="customer-satisfaction-and-loyalty.html#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaanPlot)</span>
<span id="cb258-2"><a href="customer-satisfaction-and-loyalty.html#cb258-2" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x19 =</span> <span class="st">&quot;SATISFACTION&quot;</span>, <span class="at">x21 =</span> <span class="st">&quot;FUTURE PURCHASE&quot;</span>)</span>
<span id="cb258-3"><a href="customer-satisfaction-and-loyalty.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lavaanPlot</span>(<span class="at">model =</span> fitSEM2</span>
<span id="cb258-4"><a href="customer-satisfaction-and-loyalty.html#cb258-4" aria-hidden="true" tabindex="-1"></a>           , <span class="at">node_options =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="st">&quot;box&quot;</span></span>
<span id="cb258-5"><a href="customer-satisfaction-and-loyalty.html#cb258-5" aria-hidden="true" tabindex="-1"></a>                                 , <span class="at">fontname =</span> <span class="st">&quot;Helvetica&quot;</span>)</span>
<span id="cb258-6"><a href="customer-satisfaction-and-loyalty.html#cb258-6" aria-hidden="true" tabindex="-1"></a>           , <span class="at">edge_options =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb258-7"><a href="customer-satisfaction-and-loyalty.html#cb258-7" aria-hidden="true" tabindex="-1"></a>           , <span class="at">coefs =</span> <span class="cn">TRUE</span></span>
<span id="cb258-8"><a href="customer-satisfaction-and-loyalty.html#cb258-8" aria-hidden="true" tabindex="-1"></a>           , <span class="at">covs=</span><span class="cn">TRUE</span></span>
<span id="cb258-9"><a href="customer-satisfaction-and-loyalty.html#cb258-9" aria-hidden="true" tabindex="-1"></a>           , <span class="at">stand=</span><span class="cn">TRUE</span></span>
<span id="cb258-10"><a href="customer-satisfaction-and-loyalty.html#cb258-10" aria-hidden="true" tabindex="-1"></a>           , <span class="at">sig=</span>.<span class="dv">05</span></span>
<span id="cb258-11"><a href="customer-satisfaction-and-loyalty.html#cb258-11" aria-hidden="true" tabindex="-1"></a>           , <span class="at">stars=</span><span class="st">&quot;regress&quot;</span></span>
<span id="cb258-12"><a href="customer-satisfaction-and-loyalty.html#cb258-12" aria-hidden="true" tabindex="-1"></a>           , <span class="at">labels =</span> labels)</span></code></pre></div>
<div id="htmlwidget-0d7db73d03839427d3b7" style="width:720px;height:480px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-0d7db73d03839427d3b7">{"x":{"diagram":" digraph plot { \n graph [ overlap = true, fontsize = 10 ] \n node [ shape = box, fontname = Helvetica ] \n node [shape = box] \n x19; x21; x18; x9; x16; x6; x13r; x12; x7; x10; x8; x14 \n node [shape = oval] \n CS; PV; MK; TS \n x19 [label = \"SATISFACTION\"]\nx21 [label = \"FUTURE PURCHASE\"] \n edge [ color = grey ] \n CS->x19 [label = \"0.45***\"] PV->x19 [label = \"0.63***\"] MK->x19 [label = \"0.5***\"] TS->x19 [label = \"\"] x19->x21 [label = \"0.73***\"] CS->x18 [label = \"0.93\"] CS->x9 [label = \"0.93\"] CS->x16 [label = \"0.81\"] PV->x6 [label = \"0.81\"] PV->x13r [label = \"0.5\"] MK->x12 [label = \"1.08\"] MK->x7 [label = \"0.74\"] MK->x10 [label = \"0.48\"] TS->x8 [label = \"0.69\"] TS->x14 [label = \"1.15\"] PV -> CS [label = \"\", dir = \"both\"] MK -> CS [label = \"0.23\", dir = \"both\"] TS -> CS [label = \"\", dir = \"both\"] MK -> PV [label = \"\", dir = \"both\"] TS -> PV [label = \"\", dir = \"both\"] TS -> MK [label = \"\", dir = \"both\"]\n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>
<p>We see that satisfaction is the mediator, where the future purchase is the final construct that we want to measure.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="customer-satisfaction-and-loyalty.html#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now</span></span>
<span id="cb259-2"><a href="customer-satisfaction-and-loyalty.html#cb259-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># - summarize the findings </span></span>
<span id="cb259-3"><a href="customer-satisfaction-and-loyalty.html#cb259-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># - are the all structural paths in the sem model significant? (if so, which hypotheses are supported?)</span></span>
<span id="cb259-4"><a href="customer-satisfaction-and-loyalty.html#cb259-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># - which is the most important determinant of customer satisfaction? (check std. path coefficients and conclude)</span></span>
<span id="cb259-5"><a href="customer-satisfaction-and-loyalty.html#cb259-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># - does satisfaction act as a sigificant mediator? (check the sig. of mediating patterns and conclude)</span></span>
<span id="cb259-6"><a href="customer-satisfaction-and-loyalty.html#cb259-6" aria-hidden="true" tabindex="-1"></a> <span class="co"># - how much variance in x21 (Likelihood of future purchase) the model explains? (check R^2 associated)</span></span></code></pre></div>
<p><br />
</p>
</div>
</div>
<div id="pls" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> PLS</h2>
<div id="definition-of-pls" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Definition of PLS</h3>
<p>We see that partial least squares can be used to make exploratiry analysis as well as prediction. Where SEM is used in a more confirmatory way of looking into relationships, where you assume some structure.</p>
<p>Hence we also assume normality in SEM, this is not the case with PLS. See more information in the following illustration.</p>
<div class="figure">
<img src="images/SEMPLS.png" alt="" />
<p class="caption">SEMVSPLS</p>
</div>
</div>
<div id="when-to-use-pls-and-when-to-use-sem" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> When to use PLS and when to use SEM</h3>
<p>PLS if:</p>
<ol style="list-style-type: decimal">
<li>You have a goal of predicting a target construct</li>
<li>The structural model is complex (many constructs and indicators)</li>
<li>If the sample size is small, and then again, what is small?? Or if the data is not normally distributed.</li>
</ol>
<p>SEM if:</p>
<ol style="list-style-type: decimal">
<li>The goal is theory testin or comparison of different theories</li>
<li>Error terms requires additional specificatio such as the covariation</li>
<li>The structural model is non-recursive</li>
<li>The research requires a global goodness-of-fit criterion</li>
</ol>
</div>
<div id="model-construction" class="section level3" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Model construction</h3>
<p>We have two types of variables:</p>
<ol style="list-style-type: decimal">
<li>Latent: These cannot be directly observed. These come in two classes:
<ol style="list-style-type: decimal">
<li>Exogenous latent variables: are independent variables</li>
<li>Endogenous latent variable: are dependent variables.</li>
</ol></li>
<li>Manifest: This is a directly observable. These come in two classes:
<ol style="list-style-type: decimal">
<li>Exogenous: reveal exogenious latent variables</li>
<li>Endogenous: reveal endogenious latent variables</li>
</ol></li>
</ol>
<p>PLS is based on OLS and dont assume linearity and observations does not have to be independent.</p>
</div>
<div id="model-estimation" class="section level3" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Model Estimation</h3>
<p>It is called partial least squares as some of the model is changed while others is not changed, hence you change it partially. That comes in different procedures.</p>
<p>The iterative process is where you first estimate the outer variables and then you move onwards.</p>
</div>
<div id="model-evaluation" class="section level3" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Model evaluation</h3>
<p>Look at the following criteria:</p>
<ol style="list-style-type: decimal">
<li>Loadings - items reliability. We want the above 0.7 as they indicate that the constrct explains more than 50% of the indicators variance. Thus proving reliability.</li>
<li>Internal reliability.</li>
<li>Discriminant validity</li>
<li>The significance of the inner coefficients</li>
<li>The models ability to explain the endogenous latent variables</li>
</ol>
</div>
<div id="example-for-the-lecture" class="section level3" number="2.4.6">
<h3><span class="header-section-number">2.4.6</span> Example for the lecture</h3>
<p>PLS is estimated based upon OLS</p>
<ul>
<li><p>It is always converging</p>
<ul>
<li>It provides an output although the constructs are poorly
measured</li>
</ul></li>
<li><p>It works with less assumptions than covariance based SEM</p></li>
<li><p>It has no overall fit criterion</p></li>
<li><p>it is very popular expecially in consulting</p></li>
</ul>
<p><strong>Description of the following example:</strong></p>
<p>In epsi_pls.R the purpose was to estimate the EPSI model in a slightly modified form as given below. The only diference to the standard EPSI model was that all questions related to quality aspects were items for an overall Quality construct and not divided into Quality with respect to service (Quality soft ware)and Quality with respect to Product (Quality Hard ware)</p>
<div class="figure">
<img src="images/paste-1C8931AB.png" alt="" />
<p class="caption">EPSI</p>
</div>
<p>If we take a look at the dataset (help(mobi) we can see that there are 24 items all in all. One question is about complaints (CUSCO). Complaints is not part of the model, so we do not include that one.</p>
<p>We see that the measurement model is all the relationships between the questions (the yellow boxes) to the constructs. They are called the <em>measurement model</em>, as these are the variables that you can measure.</p>
<p>Next step is to formulate the model. In semPLS we use a matrix format and not equations like in Lavaan.</p>
<p>We describe the measurement model and the structural model separately and in this case we should end up with two matrices like the following:</p>
<div class="figure">
<img src="images/paste-EED54128.png" width="311" alt="" />
<p class="caption">Mapping questions and latentvariables</p>
</div>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="customer-satisfaction-and-loyalty.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)  <span class="co">#Bootstrapping of standard deviations to outer loadings and path coefficients</span></span>
<span id="cb260-2"><a href="customer-satisfaction-and-loyalty.html#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPLS)</span>
<span id="cb260-3"><a href="customer-satisfaction-and-loyalty.html#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb260-4"><a href="customer-satisfaction-and-loyalty.html#cb260-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-5"><a href="customer-satisfaction-and-loyalty.html#cb260-5" aria-hidden="true" tabindex="-1"></a><span class="co"># help(mobi)</span></span>
<span id="cb260-6"><a href="customer-satisfaction-and-loyalty.html#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mobi)</span>
<span id="cb260-7"><a href="customer-satisfaction-and-loyalty.html#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="co">#names(mobi)</span></span></code></pre></div>
<p>Before we run the model it is always a good idea to have an overview of the dataset. We can use the function describe from library psych to give this overview.</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="customer-satisfaction-and-loyalty.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The dataset</span></span>
<span id="cb261-2"><a href="customer-satisfaction-and-loyalty.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mobi)</span>
<span id="cb261-3"><a href="customer-satisfaction-and-loyalty.html#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(mobi) <span class="co">#from library(psych)</span></span></code></pre></div>
<pre><code>##      CUEX1           CUEX2            CUEX3            CUSA1       
##  Min.   : 1.00   Min.   : 1.000   Min.   : 1.000   Min.   : 4.000  
##  1st Qu.: 7.00   1st Qu.: 7.000   1st Qu.: 6.000   1st Qu.: 7.000  
##  Median : 8.00   Median : 8.000   Median : 8.000   Median : 8.000  
##  Mean   : 7.58   Mean   : 7.532   Mean   : 7.424   Mean   : 7.988  
##  3rd Qu.: 8.00   3rd Qu.: 9.000   3rd Qu.: 9.000   3rd Qu.: 9.000  
##  Max.   :10.00   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      CUSA2            CUSA3            CUSCO            CUSL1       
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.000   Min.   : 1.000  
##  1st Qu.: 6.000   1st Qu.: 7.000   1st Qu.: 6.000   1st Qu.: 6.000  
##  Median : 7.000   Median : 7.000   Median : 7.000   Median : 8.000  
##  Mean   : 7.128   Mean   : 7.316   Mean   : 7.068   Mean   : 7.452  
##  3rd Qu.: 8.000   3rd Qu.: 8.000   3rd Qu.: 9.000   3rd Qu.:10.000  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      CUSL2            CUSL3            IMAG1           IMAG2      
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.00   Min.   : 1.00  
##  1st Qu.: 3.000   1st Qu.: 7.000   1st Qu.: 7.00   1st Qu.: 7.00  
##  Median : 4.000   Median : 8.000   Median : 8.00   Median : 8.00  
##  Mean   : 4.988   Mean   : 7.668   Mean   : 7.64   Mean   : 7.78  
##  3rd Qu.: 6.750   3rd Qu.:10.000   3rd Qu.: 9.00   3rd Qu.: 9.00  
##  Max.   :10.000   Max.   :10.000   Max.   :10.00   Max.   :10.00  
##      IMAG3            IMAG4            IMAG5            PERQ1       
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.000   Min.   : 2.000  
##  1st Qu.: 5.000   1st Qu.: 7.000   1st Qu.: 7.000   1st Qu.: 7.000  
##  Median : 7.000   Median : 8.000   Median : 8.000   Median : 8.000  
##  Mean   : 6.744   Mean   : 7.588   Mean   : 7.932   Mean   : 7.944  
##  3rd Qu.: 8.000   3rd Qu.: 9.000   3rd Qu.: 9.000   3rd Qu.: 9.000  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      PERQ2            PERQ3          PERQ4            PERQ5       
##  Min.   : 1.000   Min.   : 1.0   Min.   : 1.000   Min.   : 3.000  
##  1st Qu.: 6.000   1st Qu.: 7.0   1st Qu.: 7.000   1st Qu.: 7.000  
##  Median : 7.000   Median : 8.0   Median : 8.000   Median : 8.000  
##  Mean   : 7.192   Mean   : 7.7   Mean   : 7.916   Mean   : 7.872  
##  3rd Qu.: 8.000   3rd Qu.: 9.0   3rd Qu.: 9.000   3rd Qu.: 9.000  
##  Max.   :10.000   Max.   :10.0   Max.   :10.000   Max.   :10.000  
##      PERQ6            PERQ7            PERV1            PERV2       
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.000   Min.   : 1.000  
##  1st Qu.: 7.000   1st Qu.: 7.000   1st Qu.: 5.000   1st Qu.: 6.000  
##  Median : 8.000   Median : 8.000   Median : 6.000   Median : 7.000  
##  Mean   : 7.776   Mean   : 7.592   Mean   : 6.156   Mean   : 6.916  
##  3rd Qu.: 9.000   3rd Qu.: 9.000   3rd Qu.: 8.000   3rd Qu.: 8.000  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000</code></pre>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">vars</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">median</th>
<th align="right">trimmed</th>
<th align="right">mad</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">range</th>
<th align="right">skew</th>
<th align="right">kurtosis</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CUEX1</td>
<td align="right">1</td>
<td align="right">250</td>
<td align="right">7.580</td>
<td align="right">1.621765</td>
<td align="right">8</td>
<td align="right">7.680</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.6632888</td>
<td align="right">0.8289969</td>
<td align="right">0.1025694</td>
</tr>
<tr class="even">
<td align="left">CUEX2</td>
<td align="right">2</td>
<td align="right">250</td>
<td align="right">7.532</td>
<td align="right">1.792716</td>
<td align="right">8</td>
<td align="right">7.665</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7996766</td>
<td align="right">1.4470764</td>
<td align="right">0.1133813</td>
</tr>
<tr class="odd">
<td align="left">CUEX3</td>
<td align="right">3</td>
<td align="right">250</td>
<td align="right">7.424</td>
<td align="right">2.102834</td>
<td align="right">8</td>
<td align="right">7.630</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.8489926</td>
<td align="right">0.6154474</td>
<td align="right">0.1329949</td>
</tr>
<tr class="even">
<td align="left">CUSA1</td>
<td align="right">4</td>
<td align="right">250</td>
<td align="right">7.988</td>
<td align="right">1.233671</td>
<td align="right">8</td>
<td align="right">8.030</td>
<td align="right">1.4826</td>
<td align="right">4</td>
<td align="right">10</td>
<td align="right">6</td>
<td align="right">-0.2201919</td>
<td align="right">0.1527890</td>
<td align="right">0.0780242</td>
</tr>
<tr class="odd">
<td align="left">CUSA2</td>
<td align="right">5</td>
<td align="right">250</td>
<td align="right">7.128</td>
<td align="right">1.765242</td>
<td align="right">7</td>
<td align="right">7.180</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.5471886</td>
<td align="right">0.5579660</td>
<td align="right">0.1116437</td>
</tr>
<tr class="even">
<td align="left">CUSA3</td>
<td align="right">6</td>
<td align="right">250</td>
<td align="right">7.316</td>
<td align="right">1.747099</td>
<td align="right">7</td>
<td align="right">7.405</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.6671235</td>
<td align="right">0.9615690</td>
<td align="right">0.1104962</td>
</tr>
<tr class="odd">
<td align="left">CUSCO</td>
<td align="right">7</td>
<td align="right">250</td>
<td align="right">7.068</td>
<td align="right">2.274217</td>
<td align="right">7</td>
<td align="right">7.285</td>
<td align="right">2.2239</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7099909</td>
<td align="right">0.2384216</td>
<td align="right">0.1438341</td>
</tr>
<tr class="even">
<td align="left">CUSL1</td>
<td align="right">8</td>
<td align="right">250</td>
<td align="right">7.452</td>
<td align="right">2.658565</td>
<td align="right">8</td>
<td align="right">7.860</td>
<td align="right">2.9652</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9946527</td>
<td align="right">0.0768705</td>
<td align="right">0.1681424</td>
</tr>
<tr class="odd">
<td align="left">CUSL2</td>
<td align="right">9</td>
<td align="right">250</td>
<td align="right">4.988</td>
<td align="right">2.839031</td>
<td align="right">4</td>
<td align="right">4.800</td>
<td align="right">2.9652</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">0.5449058</td>
<td align="right">-0.9063918</td>
<td align="right">0.1795561</td>
</tr>
<tr class="even">
<td align="left">CUSL3</td>
<td align="right">10</td>
<td align="right">250</td>
<td align="right">7.668</td>
<td align="right">2.218437</td>
<td align="right">8</td>
<td align="right">7.955</td>
<td align="right">2.9652</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-1.0592863</td>
<td align="right">0.8637662</td>
<td align="right">0.1403063</td>
</tr>
<tr class="odd">
<td align="left">IMAG1</td>
<td align="right">11</td>
<td align="right">250</td>
<td align="right">7.640</td>
<td align="right">1.699988</td>
<td align="right">8</td>
<td align="right">7.765</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9014379</td>
<td align="right">1.6887323</td>
<td align="right">0.1075167</td>
</tr>
<tr class="even">
<td align="left">IMAG2</td>
<td align="right">12</td>
<td align="right">250</td>
<td align="right">7.780</td>
<td align="right">1.687302</td>
<td align="right">8</td>
<td align="right">7.930</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7931040</td>
<td align="right">0.9620206</td>
<td align="right">0.1067143</td>
</tr>
<tr class="odd">
<td align="left">IMAG3</td>
<td align="right">13</td>
<td align="right">250</td>
<td align="right">6.744</td>
<td align="right">2.131817</td>
<td align="right">7</td>
<td align="right">6.905</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7930042</td>
<td align="right">0.6570813</td>
<td align="right">0.1348279</td>
</tr>
<tr class="even">
<td align="left">IMAG4</td>
<td align="right">14</td>
<td align="right">250</td>
<td align="right">7.588</td>
<td align="right">1.841690</td>
<td align="right">8</td>
<td align="right">7.755</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9231357</td>
<td align="right">1.3210435</td>
<td align="right">0.1164787</td>
</tr>
<tr class="odd">
<td align="left">IMAG5</td>
<td align="right">15</td>
<td align="right">250</td>
<td align="right">7.932</td>
<td align="right">1.557266</td>
<td align="right">8</td>
<td align="right">8.070</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-1.0694987</td>
<td align="right">2.6817548</td>
<td align="right">0.0984901</td>
</tr>
<tr class="even">
<td align="left">PERQ1</td>
<td align="right">16</td>
<td align="right">250</td>
<td align="right">7.944</td>
<td align="right">1.421600</td>
<td align="right">8</td>
<td align="right">8.040</td>
<td align="right">1.4826</td>
<td align="right">2</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">-0.7203890</td>
<td align="right">1.1786363</td>
<td align="right">0.0899099</td>
</tr>
<tr class="odd">
<td align="left">PERQ2</td>
<td align="right">17</td>
<td align="right">250</td>
<td align="right">7.192</td>
<td align="right">1.891414</td>
<td align="right">7</td>
<td align="right">7.330</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.8186657</td>
<td align="right">0.7287376</td>
<td align="right">0.1196235</td>
</tr>
<tr class="even">
<td align="left">PERQ3</td>
<td align="right">18</td>
<td align="right">250</td>
<td align="right">7.700</td>
<td align="right">1.821888</td>
<td align="right">8</td>
<td align="right">7.885</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9064463</td>
<td align="right">0.8310284</td>
<td align="right">0.1152263</td>
</tr>
<tr class="odd">
<td align="left">PERQ4</td>
<td align="right">19</td>
<td align="right">250</td>
<td align="right">7.916</td>
<td align="right">1.651622</td>
<td align="right">8</td>
<td align="right">8.105</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-1.0704382</td>
<td align="right">1.7901560</td>
<td align="right">0.1044578</td>
</tr>
<tr class="even">
<td align="left">PERQ5</td>
<td align="right">20</td>
<td align="right">250</td>
<td align="right">7.872</td>
<td align="right">1.453294</td>
<td align="right">8</td>
<td align="right">7.970</td>
<td align="right">1.4826</td>
<td align="right">3</td>
<td align="right">10</td>
<td align="right">7</td>
<td align="right">-0.6770313</td>
<td align="right">0.5583053</td>
<td align="right">0.0919144</td>
</tr>
<tr class="odd">
<td align="left">PERQ6</td>
<td align="right">21</td>
<td align="right">250</td>
<td align="right">7.776</td>
<td align="right">1.629862</td>
<td align="right">8</td>
<td align="right">7.925</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9743906</td>
<td align="right">1.7870540</td>
<td align="right">0.1030815</td>
</tr>
<tr class="even">
<td align="left">PERQ7</td>
<td align="right">22</td>
<td align="right">250</td>
<td align="right">7.592</td>
<td align="right">1.843674</td>
<td align="right">8</td>
<td align="right">7.775</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9593571</td>
<td align="right">1.0528448</td>
<td align="right">0.1166042</td>
</tr>
<tr class="odd">
<td align="left">PERV1</td>
<td align="right">23</td>
<td align="right">250</td>
<td align="right">6.156</td>
<td align="right">2.183284</td>
<td align="right">6</td>
<td align="right">6.260</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.3971992</td>
<td align="right">-0.2142253</td>
<td align="right">0.1380830</td>
</tr>
<tr class="even">
<td align="left">PERV2</td>
<td align="right">24</td>
<td align="right">250</td>
<td align="right">6.916</td>
<td align="right">1.842423</td>
<td align="right">7</td>
<td align="right">6.980</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.6445980</td>
<td align="right">0.9714600</td>
<td align="right">0.1165251</td>
</tr>
</tbody>
</table>
</div>
<p>Here we can see that all items apart from CUSL2 has a negative skewness. If <strong>skewness</strong> is negative then it means that the tail in the distribution is to the left. Less than -1 then highly skewed, between -0,5 and -1 then moderately skewed. <strong>Kurtosis</strong> is the degree of peakedness in a distribution (how heavy tails). Negative kurtosis is an indicator of a more even distribution across possible outcomes.</p>
<p>It can be seen that CUSL2 has a positive skewness (more even distribution) and a negative kurtosis. Answers to this question behaves completely different compared to the rest. The question is also compared to the other questions that are more straightforward to answer.</p>
<p>We can plot the distribution of the CUSL1 and 2.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="customer-satisfaction-and-loyalty.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mobi<span class="sc">$</span>CUSL1)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-139"></span>
<img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-139-1.png" alt="Histogram CUSL1" width="720" />
<p class="caption">
Figure 2.1: Histogram CUSL1
</p>
</div>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="customer-satisfaction-and-loyalty.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mobi<span class="sc">$</span>CUSL2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-140"></span>
<img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-140-1.png" alt="Histogram CUSL2" width="720" />
<p class="caption">
Figure 2.2: Histogram CUSL2
</p>
</div>
<p>We see that they are not at all normally distributed. Notice that we are going to build the following model using in R.</p>
<p><img src="images/paste-86283E6A.png" width="414" /></p>
<p>We see that we are going to use the arrows which are non-dotted.</p>
<p>We see that in the package we have <strong>image</strong> that is the only variable that are not described by other constructs.</p>
<p><img src="images/paste-D223470C.png" /></p>
<p>Now we are going to define the structural model, by describing the varaibles that are linked to them, hence identifying the indicators of each of the latent variables.</p>
<p>Now we can ‘draw’ the model. We saw in SEM that we wrote it as a function, here we make it as a matrix.</p>
<div id="making-structural--and-measurement-model" class="section level4" number="2.4.6.1">
<h4><span class="header-section-number">2.4.6.1</span> Making structural- and measurement model</h4>
<p>We relate the constructs and the varaibles in the following.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="customer-satisfaction-and-loyalty.html#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The structural model</span></span>
<span id="cb265-2"><a href="customer-satisfaction-and-loyalty.html#cb265-2" aria-hidden="true" tabindex="-1"></a>EPSIsm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;IMAGE&quot;</span>, <span class="st">&quot;VALUE&quot;</span></span>
<span id="cb265-3"><a href="customer-satisfaction-and-loyalty.html#cb265-3" aria-hidden="true" tabindex="-1"></a>                   ,<span class="st">&quot;EXP&quot;</span>,<span class="st">&quot;VALUE&quot;</span></span>
<span id="cb265-4"><a href="customer-satisfaction-and-loyalty.html#cb265-4" aria-hidden="true" tabindex="-1"></a>                   ,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;VALUE&quot;</span></span>
<span id="cb265-5"><a href="customer-satisfaction-and-loyalty.html#cb265-5" aria-hidden="true" tabindex="-1"></a>                   ,<span class="st">&quot;VALUE&quot;</span>,<span class="st">&quot;SATISF&quot;</span></span>
<span id="cb265-6"><a href="customer-satisfaction-and-loyalty.html#cb265-6" aria-hidden="true" tabindex="-1"></a>                   ,<span class="st">&quot;SATISF&quot;</span>,<span class="st">&quot;LOYAL&quot;</span></span>
<span id="cb265-7"><a href="customer-satisfaction-and-loyalty.html#cb265-7" aria-hidden="true" tabindex="-1"></a>                   ,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;LOYAL&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb265-8"><a href="customer-satisfaction-and-loyalty.html#cb265-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSIsm)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb265-9"><a href="customer-satisfaction-and-loyalty.html#cb265-9" aria-hidden="true" tabindex="-1"></a>EPSIsm</span></code></pre></div>
<pre><code>##      source   target  
## [1,] &quot;IMAGE&quot;  &quot;VALUE&quot; 
## [2,] &quot;EXP&quot;    &quot;VALUE&quot; 
## [3,] &quot;QUAL&quot;   &quot;VALUE&quot; 
## [4,] &quot;VALUE&quot;  &quot;SATISF&quot;
## [5,] &quot;SATISF&quot; &quot;LOYAL&quot; 
## [6,] &quot;IMAGE&quot;  &quot;LOYAL&quot;</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="customer-satisfaction-and-loyalty.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The measurement model</span></span>
<span id="cb267-2"><a href="customer-satisfaction-and-loyalty.html#cb267-2" aria-hidden="true" tabindex="-1"></a>EPSImm1 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;IMAGE&quot;</span>, <span class="st">&quot;IMAG1&quot;</span>,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;IMAG2&quot;</span>,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;IMAG3&quot;</span>,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;IMAG4&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb267-3"><a href="customer-satisfaction-and-loyalty.html#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm1)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb267-4"><a href="customer-satisfaction-and-loyalty.html#cb267-4" aria-hidden="true" tabindex="-1"></a><span class="co"># EPSImm1</span></span>
<span id="cb267-5"><a href="customer-satisfaction-and-loyalty.html#cb267-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-6"><a href="customer-satisfaction-and-loyalty.html#cb267-6" aria-hidden="true" tabindex="-1"></a>EPSImm2 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;EXP&quot;</span>, <span class="st">&quot;CUEX1&quot;</span>,<span class="st">&quot;EXP&quot;</span>,<span class="st">&quot;CUEX2&quot;</span>,<span class="st">&quot;EXP&quot;</span>,<span class="st">&quot;CUEX3&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb267-7"><a href="customer-satisfaction-and-loyalty.html#cb267-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb267-8"><a href="customer-satisfaction-and-loyalty.html#cb267-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-9"><a href="customer-satisfaction-and-loyalty.html#cb267-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-10"><a href="customer-satisfaction-and-loyalty.html#cb267-10" aria-hidden="true" tabindex="-1"></a>EPSImm3 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;QUAL&quot;</span>, <span class="st">&quot;PERQ1&quot;</span>,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ2&quot;</span>,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ3&quot;</span>,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ4&quot;</span>,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ5&quot;</span>,</span>
<span id="cb267-11"><a href="customer-satisfaction-and-loyalty.html#cb267-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ6&quot;</span>,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ7&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb267-12"><a href="customer-satisfaction-and-loyalty.html#cb267-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm3)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb267-13"><a href="customer-satisfaction-and-loyalty.html#cb267-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(EPSImm3,<span class="dv">7</span>)</span>
<span id="cb267-14"><a href="customer-satisfaction-and-loyalty.html#cb267-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-15"><a href="customer-satisfaction-and-loyalty.html#cb267-15" aria-hidden="true" tabindex="-1"></a>EPSImm4 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;VALUE&quot;</span>, <span class="st">&quot;PERV1&quot;</span>,<span class="st">&quot;VALUE&quot;</span>,<span class="st">&quot;PERV2&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb267-16"><a href="customer-satisfaction-and-loyalty.html#cb267-16" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm4)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb267-17"><a href="customer-satisfaction-and-loyalty.html#cb267-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-18"><a href="customer-satisfaction-and-loyalty.html#cb267-18" aria-hidden="true" tabindex="-1"></a>EPSImm5 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;SATISF&quot;</span>, <span class="st">&quot;CUSA1&quot;</span>,<span class="st">&quot;SATISF&quot;</span>,<span class="st">&quot;CUSA2&quot;</span>,<span class="st">&quot;SATISF&quot;</span>,<span class="st">&quot;CUSA3&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb267-19"><a href="customer-satisfaction-and-loyalty.html#cb267-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm5)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb267-20"><a href="customer-satisfaction-and-loyalty.html#cb267-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-21"><a href="customer-satisfaction-and-loyalty.html#cb267-21" aria-hidden="true" tabindex="-1"></a>EPSImm6 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;LOYAL&quot;</span>, <span class="st">&quot;CUSL1&quot;</span>,<span class="st">&quot;LOYAL&quot;</span>,<span class="st">&quot;CUSL2&quot;</span>,<span class="st">&quot;LOYAL&quot;</span>,<span class="st">&quot;CUSL3&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb267-22"><a href="customer-satisfaction-and-loyalty.html#cb267-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm6)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span></code></pre></div>
<pre><code>##      source target 
## [1,] &quot;QUAL&quot; &quot;PERQ1&quot;
## [2,] &quot;QUAL&quot; &quot;PERQ2&quot;
## [3,] &quot;QUAL&quot; &quot;PERQ3&quot;
## [4,] &quot;QUAL&quot; &quot;PERQ4&quot;
## [5,] &quot;QUAL&quot; &quot;PERQ5&quot;
## [6,] &quot;QUAL&quot; &quot;PERQ6&quot;
## [7,] &quot;QUAL&quot; &quot;PERQ7&quot;</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="customer-satisfaction-and-loyalty.html#cb269-1" aria-hidden="true" tabindex="-1"></a>EPSImm <span class="ot">&lt;-</span><span class="fu">rbind</span>(EPSImm1,EPSImm2,EPSImm3,EPSImm4,EPSImm5,EPSImm6)</span>
<span id="cb269-2"><a href="customer-satisfaction-and-loyalty.html#cb269-2" aria-hidden="true" tabindex="-1"></a>EPSImm</span></code></pre></div>
<pre><code>##       source   target 
##  [1,] &quot;IMAGE&quot;  &quot;IMAG1&quot;
##  [2,] &quot;IMAGE&quot;  &quot;IMAG2&quot;
##  [3,] &quot;IMAGE&quot;  &quot;IMAG3&quot;
##  [4,] &quot;IMAGE&quot;  &quot;IMAG4&quot;
##  [5,] &quot;EXP&quot;    &quot;CUEX1&quot;
##  [6,] &quot;EXP&quot;    &quot;CUEX2&quot;
##  [7,] &quot;EXP&quot;    &quot;CUEX3&quot;
##  [8,] &quot;QUAL&quot;   &quot;PERQ1&quot;
##  [9,] &quot;QUAL&quot;   &quot;PERQ2&quot;
## [10,] &quot;QUAL&quot;   &quot;PERQ3&quot;
## [11,] &quot;QUAL&quot;   &quot;PERQ4&quot;
## [12,] &quot;QUAL&quot;   &quot;PERQ5&quot;
## [13,] &quot;QUAL&quot;   &quot;PERQ6&quot;
## [14,] &quot;QUAL&quot;   &quot;PERQ7&quot;
## [15,] &quot;VALUE&quot;  &quot;PERV1&quot;
## [16,] &quot;VALUE&quot;  &quot;PERV2&quot;
## [17,] &quot;SATISF&quot; &quot;CUSA1&quot;
## [18,] &quot;SATISF&quot; &quot;CUSA2&quot;
## [19,] &quot;SATISF&quot; &quot;CUSA3&quot;
## [20,] &quot;LOYAL&quot;  &quot;CUSL1&quot;
## [21,] &quot;LOYAL&quot;  &quot;CUSL2&quot;
## [22,] &quot;LOYAL&quot;  &quot;CUSL3&quot;</code></pre>
</div>
<div id="now-we-can-estimate-the-model" class="section level4" number="2.4.6.2">
<h4><span class="header-section-number">2.4.6.2</span> Now we can estimate the model</h4>
<p>estimating and looking at the matrices reflecting the relationships.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="customer-satisfaction-and-loyalty.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The whole model</span></span>
<span id="cb271-2"><a href="customer-satisfaction-and-loyalty.html#cb271-2" aria-hidden="true" tabindex="-1"></a>EPSI <span class="ot">&lt;-</span> <span class="fu">plsm</span>(<span class="at">data=</span>mobi</span>
<span id="cb271-3"><a href="customer-satisfaction-and-loyalty.html#cb271-3" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">strucmod=</span>EPSIsm</span>
<span id="cb271-4"><a href="customer-satisfaction-and-loyalty.html#cb271-4" aria-hidden="true" tabindex="-1"></a>             ,<span class="at">measuremod=</span>EPSImm)</span>
<span id="cb271-5"><a href="customer-satisfaction-and-loyalty.html#cb271-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-6"><a href="customer-satisfaction-and-loyalty.html#cb271-6" aria-hidden="true" tabindex="-1"></a>EPSI[[<span class="st">&quot;D&quot;</span>]] <span class="co">#The structural model (inner relations)</span></span>
<span id="cb271-7"><a href="customer-satisfaction-and-loyalty.html#cb271-7" aria-hidden="true" tabindex="-1"></a>EPSI[[<span class="st">&quot;M&quot;</span>]] <span class="co">#The measurement model</span></span></code></pre></div>
<pre><code>##        EXP IMAGE QUAL VALUE SATISF LOYAL
## EXP      0     0    0     1      0     0
## IMAGE    0     0    0     1      0     1
## QUAL     0     0    0     1      0     0
## VALUE    0     0    0     0      1     0
## SATISF   0     0    0     0      0     1
## LOYAL    0     0    0     0      0     0
##       EXP IMAGE QUAL VALUE SATISF LOYAL
## CUEX1   1     0    0     0      0     0
## CUEX2   1     0    0     0      0     0
## CUEX3   1     0    0     0      0     0
## IMAG1   0     1    0     0      0     0
## IMAG2   0     1    0     0      0     0
## IMAG3   0     1    0     0      0     0
## IMAG4   0     1    0     0      0     0
## PERQ1   0     0    1     0      0     0
## PERQ2   0     0    1     0      0     0
## PERQ3   0     0    1     0      0     0
## PERQ4   0     0    1     0      0     0
## PERQ5   0     0    1     0      0     0
## PERQ6   0     0    1     0      0     0
## PERQ7   0     0    1     0      0     0
## PERV1   0     0    0     1      0     0
## PERV2   0     0    0     1      0     0
## CUSA1   0     0    0     0      1     0
## CUSA2   0     0    0     0      1     0
## CUSA3   0     0    0     0      1     0
## CUSL1   0     0    0     0      0     1
## CUSL2   0     0    0     0      0     1
## CUSL3   0     0    0     0      0     1</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="customer-satisfaction-and-loyalty.html#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimation of model</span></span>
<span id="cb273-2"><a href="customer-satisfaction-and-loyalty.html#cb273-2" aria-hidden="true" tabindex="-1"></a>epsi <span class="ot">&lt;-</span> <span class="fu">sempls</span>(<span class="at">model=</span>EPSI,<span class="at">data=</span>mobi)</span>
<span id="cb273-3"><a href="customer-satisfaction-and-loyalty.html#cb273-3" aria-hidden="true" tabindex="-1"></a>epsi</span></code></pre></div>
<pre><code>## All 250 observations are valid.
## Converged after 8 iterations.
## Tolerance: 1e-07
## Scheme: centroid
##                     Path Estimate
## lam_1_1     EXP -&gt; CUEX1    0.786
## lam_1_2     EXP -&gt; CUEX2    0.583
## lam_1_3     EXP -&gt; CUEX3    0.682
## lam_2_1   IMAGE -&gt; IMAG1    0.751
## lam_2_2   IMAGE -&gt; IMAG2    0.593
## lam_2_3   IMAGE -&gt; IMAG3    0.628
## lam_2_4   IMAGE -&gt; IMAG4    0.821
## lam_3_1    QUAL -&gt; PERQ1    0.796
## lam_3_2    QUAL -&gt; PERQ2    0.626
## lam_3_3    QUAL -&gt; PERQ3    0.789
## lam_3_4    QUAL -&gt; PERQ4    0.762
## lam_3_5    QUAL -&gt; PERQ5    0.764
## lam_3_6    QUAL -&gt; PERQ6    0.769
## lam_3_7    QUAL -&gt; PERQ7    0.791
## lam_4_1   VALUE -&gt; PERV1    0.903
## lam_4_2   VALUE -&gt; PERV2    0.939
## lam_5_1  SATISF -&gt; CUSA1    0.784
## lam_5_2  SATISF -&gt; CUSA2    0.845
## lam_5_3  SATISF -&gt; CUSA3    0.865
## lam_6_1   LOYAL -&gt; CUSL1    0.825
## lam_6_2   LOYAL -&gt; CUSL2    0.209
## lam_6_3   LOYAL -&gt; CUSL3    0.911
## beta_1_4    EXP -&gt; VALUE    0.036
## beta_2_4  IMAGE -&gt; VALUE    0.232
## beta_3_4   QUAL -&gt; VALUE    0.403
## beta_4_5 VALUE -&gt; SATISF    0.610
## beta_2_6  IMAGE -&gt; LOYAL    0.140
## beta_5_6 SATISF -&gt; LOYAL    0.563</code></pre>
<p>We see that we get the estimates, which are the coefficients.</p>
<p>Just as in the covariance based approach it is important to have a good measurement model and the criteria are the same.</p>
<p>Firstly we have to make sure that the items are good indicators for the latent constructs. Here we look at the loadings. The loadings are produced with the following line:</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="customer-satisfaction-and-loyalty.html#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation of estimated model</span></span>
<span id="cb275-2"><a href="customer-satisfaction-and-loyalty.html#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plsLoadings</span>(epsi)</span></code></pre></div>
<pre><code>##        EXP IMAGE QUAL VALUE SATISF LOYAL
## CUEX1 0.79     .    .     .      .     .
## CUEX2 0.58     .    .     .      .     .
## CUEX3 0.68     .    .     .      .     .
## IMAG1    .  0.75    .     .      .     .
## IMAG2    .  0.59 0.49     .      .     .
## IMAG3    .  0.63    .     .      .     .
## IMAG4    .  0.82    .     .      .     .
## PERQ1    .     . 0.80     .   0.68     .
## PERQ2    .     . 0.63     .      .     .
## PERQ3    .     . 0.79     .   0.65     .
## PERQ4    .     . 0.76     .      .     .
## PERQ5    .     . 0.76     .      .     .
## PERQ6    .     . 0.77     .      .     .
## PERQ7    .     . 0.79     .   0.70     .
## PERV1    .     .    .  0.90      .     .
## PERV2    .     .    .  0.94      .     .
## CUSA1    .     . 0.64     .   0.78     .
## CUSA2    .     .    .     .   0.85     .
## CUSA3    .     .    .     .   0.86     .
## CUSL1    .     .    .     .      .  0.83
## CUSL2    .     .    .     .      .  0.21
## CUSL3    .     .    .     .      .  0.91</code></pre>
<p>We see that expectations are influenced by CUEX, and Image is defined by image etc. Although it is rather interesting to see that the satisfaction is defined by several variable.</p>
<p>When we look on the loyalty, we see that question no. 2 (CUSL2) that there is a very low relationship. <strong><em>The rule of thumb, is that the relationship needs to be at least 0.7.</em></strong> So we also have other variables that are questionable.</p>
</div>
<div id="measuring-quality-of-the-constructs" class="section level4" number="2.4.6.3">
<h4><span class="header-section-number">2.4.6.3</span> Measuring quality of the constructs</h4>
<p>We can can compute the composite reliability by the following:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="customer-satisfaction-and-loyalty.html#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Composite reliability</span></span>
<span id="cb277-2"><a href="customer-satisfaction-and-loyalty.html#cb277-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dgrho</span>(epsi)</span></code></pre></div>
<pre><code>##        Dillon-Goldstein&#39;s rho reflective MVs
## EXP                      0.73              3
## IMAGE                    0.79              4
## QUAL                     0.90              7
## VALUE                    0.92              2
## SATISF                   0.87              3
## LOYAL                    0.72              3</code></pre>
<p>We want the coefficients be higher than 0.8 (<strong><em>rule of thumb</em></strong>), hence we see that loyalty for instance is low. that is because of the question no. 2, that was very weak.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="customer-satisfaction-and-loyalty.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AVE is average of communality for a construct</span></span>
<span id="cb279-2"><a href="customer-satisfaction-and-loyalty.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">communality</span>(epsi) <span class="co">#These are just the loadings squared</span></span></code></pre></div>
<pre><code>##        communality reflective MVs
## EXP           0.47              3
## IMAGE         0.50              4
## QUAL          0.58              7
## VALUE         0.85              2
## SATISF        0.69              3
## LOYAL         0.52              3
## 
##  Average communality: 0.58</code></pre>
<p>Commonality must be higher than correlation between the latent variables. If not, you can argue that two constructs should be merged.</p>
<p>EXP = 0.47, meaning that on average EXP explains 47% of the variance in the items related to EXP. Therefore</p>
<p><em>Rule of thumb, should be higher than 50%, that is also why the loadings should be higher than 70% as <span class="math inline">\(0.7^2 = 0.5\)</span>. Although 60% is a nice level as well</em></p>
<p>now we can look at the inner relations, relationships between latent variables.</p>
<p>We see that in the following matrix we only get estimates for endogenous (dependent variables), that is the reason we dont see any for EXP, IMA and QUA, because they are only endogenous in the measurement models.</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="customer-satisfaction-and-loyalty.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Inner relations</span></span>
<span id="cb281-2"><a href="customer-satisfaction-and-loyalty.html#cb281-2" aria-hidden="true" tabindex="-1"></a>pC <span class="ot">&lt;-</span> <span class="fu">pathCoeff</span>(epsi)</span>
<span id="cb281-3"><a href="customer-satisfaction-and-loyalty.html#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pC,<span class="at">abbreviate=</span><span class="cn">TRUE</span>,<span class="at">minlength=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     EXP IMA QUA   VAL   SAT   LOY
## EXP   .   .   . 0.036     .     .
## IMA   .   .   . 0.232     . 0.140
## QUA   .   .   . 0.403     .     .
## VAL   .   .   .     . 0.610     .
## SAT   .   .   .     .     . 0.563
## LOY   .   .   .     .     .     .</code></pre>
<p>Example: if we increase EXP by 1 standard deviation, the VAL will increase by 0.036 standard deviations.</p>
<p>we see that the coefficients are standardized.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="customer-satisfaction-and-loyalty.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The total effects</span></span>
<span id="cb283-2"><a href="customer-satisfaction-and-loyalty.html#cb283-2" aria-hidden="true" tabindex="-1"></a>tE <span class="ot">&lt;-</span> <span class="fu">totalEffects</span>(epsi)</span>
<span id="cb283-3"><a href="customer-satisfaction-and-loyalty.html#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tE,<span class="at">abbreviate=</span><span class="cn">TRUE</span>,<span class="at">minlength=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     EXP IMA QUA   VAL   SAT   LOY
## EXP   .   .   . 0.036 0.022 0.012
## IMA   .   .   . 0.232 0.141 0.219
## QUA   .   .   . 0.403 0.246 0.139
## VAL   .   .   .     . 0.610 0.344
## SAT   .   .   .     .     . 0.563
## LOY   .   .   .     .     .     .</code></pre>
<p>The total effect includes the indirect effects, e.g., going between
latent variables.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="customer-satisfaction-and-loyalty.html#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co">#R2</span></span>
<span id="cb285-2"><a href="customer-satisfaction-and-loyalty.html#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rSquared</span>(epsi)</span></code></pre></div>
<pre><code>##        R-squared
## EXP            .
## IMAGE          .
## QUAL           .
## VALUE       0.38
## SATISF      0.37
## LOYAL       0.44</code></pre>
<p>We see that the <span class="math inline">\(R^2\)</span> is rather low. It is common to say, that it needs to be at least 0.65, i.e., 65%.</p>
</div>
<div id="are-the-coefficients-significant" class="section level4" number="2.4.6.4">
<h4><span class="header-section-number">2.4.6.4</span> Are the coefficients significant?</h4>
<p>We can run a bootstrap to assess whether the coefficients are significant.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="customer-satisfaction-and-loyalty.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bootstrapping - estimation of standard errors</span></span>
<span id="cb287-2"><a href="customer-satisfaction-and-loyalty.html#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb287-3"><a href="customer-satisfaction-and-loyalty.html#cb287-3" aria-hidden="true" tabindex="-1"></a>epsiBoot <span class="ot">&lt;-</span> <span class="fu">bootsempls</span>(epsi,<span class="at">nboot=</span><span class="dv">500</span>,<span class="at">start=</span><span class="st">&quot;ones&quot;</span>,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb287-4"><a href="customer-satisfaction-and-loyalty.html#cb287-4" aria-hidden="true" tabindex="-1"></a>epsiBoot</span></code></pre></div>
<pre><code>## Call: bootsempls(object = epsi, nboot = 500, start = &quot;ones&quot;, verbose = FALSE)
## 
##                 Estimate      Bias Std.Error
## EXP -&gt; CUEX1      0.7865 -0.015459    0.0716
## EXP -&gt; CUEX2      0.5827 -0.019156    0.1474
## EXP -&gt; CUEX3      0.6817 -0.003128    0.1026
## IMAGE -&gt; IMAG1    0.7505 -0.002769    0.0417
## IMAGE -&gt; IMAG2    0.5927 -0.006763    0.0764
## IMAGE -&gt; IMAG3    0.6281 -0.002382    0.0632
## IMAGE -&gt; IMAG4    0.8215 -0.001675    0.0355
## QUAL -&gt; PERQ1     0.7962 -0.000784    0.0264
## QUAL -&gt; PERQ2     0.6256 -0.006429    0.0539
## QUAL -&gt; PERQ3     0.7893 -0.000843    0.0306
## QUAL -&gt; PERQ4     0.7622 -0.001921    0.0467
## QUAL -&gt; PERQ5     0.7644 -0.000716    0.0342
## QUAL -&gt; PERQ6     0.7694  0.001351    0.0582
## QUAL -&gt; PERQ7     0.7906  0.001880    0.0295
## VALUE -&gt; PERV1    0.9035 -0.001996    0.0208
## VALUE -&gt; PERV2    0.9386  0.000559    0.0071
## SATISF -&gt; CUSA1   0.7841 -0.003195    0.0347
## SATISF -&gt; CUSA2   0.8451  0.000466    0.0230
## SATISF -&gt; CUSA3   0.8648  0.001230    0.0164
## LOYAL -&gt; CUSL1    0.8253 -0.005565    0.0420
## LOYAL -&gt; CUSL2    0.2087  0.001986    0.1127
## LOYAL -&gt; CUSL3    0.9107 -0.002258    0.0138
## EXP -&gt; VALUE      0.0356  0.019026    0.0822
## IMAGE -&gt; VALUE    0.2317 -0.005509    0.1146
## QUAL -&gt; VALUE     0.4035 -0.004219    0.1216
## VALUE -&gt; SATISF   0.6105 -0.001294    0.0552
## IMAGE -&gt; LOYAL    0.1396  0.013019    0.0762
## SATISF -&gt; LOYAL   0.5635 -0.007305    0.0873</code></pre>
<p>E.g., we see that the relationship between the expectations (EXP) and the value (VALUE) is rather low and there does not appear to be any relationship.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="customer-satisfaction-and-loyalty.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural model coefficients</span></span>
<span id="cb289-2"><a href="customer-satisfaction-and-loyalty.html#cb289-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parallelplot</span>(epsiBoot,<span class="at">reflinesAt=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb289-3"><a href="customer-satisfaction-and-loyalty.html#cb289-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">varnames=</span><span class="fu">attr</span>(epsiBoot<span class="sc">$</span>t,<span class="st">&quot;path&quot;</span>)[<span class="dv">23</span><span class="sc">:</span><span class="dv">28</span>])</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-153-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the dotted line = 0. This gives an idea of the stability of the estimation that we have done.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="customer-satisfaction-and-loyalty.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Constructing observations</span></span>
<span id="cb290-2"><a href="customer-satisfaction-and-loyalty.html#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plsWeights</span>(epsi)</span></code></pre></div>
<pre><code>##        EXP IMAGE QUAL VALUE SATISF LOYAL
## CUEX1 0.56     .    .     .      .     .
## CUEX2 0.34     .    .     .      .     .
## CUEX3 0.52     .    .     .      .     .
## IMAG1    .  0.36    .     .      .     .
## IMAG2    .  0.28    .     .      .     .
## IMAG3    .  0.31    .     .      .     .
## IMAG4    .  0.45    .     .      .     .
## PERQ1    .     . 0.20     .      .     .
## PERQ2    .     . 0.13     .      .     .
## PERQ3    .     . 0.20     .      .     .
## PERQ4    .     . 0.17     .      .     .
## PERQ5    .     . 0.20     .      .     .
## PERQ6    .     . 0.17     .      .     .
## PERQ7    .     . 0.24     .      .     .
## PERV1    .     .    .  0.48      .     .
## PERV2    .     .    .  0.60      .     .
## CUSA1    .     .    .     .   0.35     .
## CUSA2    .     .    .     .   0.38     .
## CUSA3    .     .    .     .   0.47     .
## CUSL1    .     .    .     .      .  0.47
## CUSL2    .     .    .     .      .  0.12
## CUSL3    .     .    .     .      .  0.64</code></pre>
<p>These are the factor scores.</p>
<p><em>Notice, that this has nothing to do with the bootstrapping</em></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="customer-satisfaction-and-loyalty.html#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardised observations for  (constructs)</span></span>
<span id="cb292-2"><a href="customer-satisfaction-and-loyalty.html#cb292-2" aria-hidden="true" tabindex="-1"></a>epsi<span class="sc">$</span>factor_scores</span>
<span id="cb292-3"><a href="customer-satisfaction-and-loyalty.html#cb292-3" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(epsi)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-155-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="customer-satisfaction-and-loyalty.html#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(epsi,<span class="at">use=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-155-2.png" width="720" style="display: block; margin: auto;" /></p>
<pre><code>##                 EXP       IMAGE         QUAL        VALUE      SATISF
##   [1,] -0.658288481 -1.47979167 -1.601304825 -2.195687443 -1.31975186
##   [2,]  1.705062008  1.76533519  1.580150565  1.855563932  1.37048009
##   [3,] -0.408804865 -1.03652985 -0.610023359  0.214167984 -0.10886680
##   [4,] -0.333389664 -0.02013215 -0.307365027 -0.880095982  1.90740374
##   [5,]  0.686485052  0.71219193  0.996103664 -0.332963999  0.94173802
##   [6,]  1.014633965  0.85295798  1.027125702  1.855563932 -0.10886680
##   [7,] -1.154005617 -1.03381653 -0.039740834 -0.228487009  0.37396607
##   [8,] -2.790845510  0.29824424 -0.313829831 -0.228487009 -0.60712381
##   [9,] -0.408804865 -0.43102726 -0.507723115 -0.228487009 -0.39275277
##  [10,] -1.059900259 -0.33833674 -0.327519100 -0.775618992 -1.35841850
##  [11,] -0.350782060  0.12368648  0.199097106  0.214167984  0.24453412
##  [12,]  1.705062008  0.33542780  0.301951965 -0.228487009  0.10550424
##  [13,]  0.245540625  0.56111368  0.405396543 -0.554291495  0.10550424
##  [14,]  1.954545624  1.93001875  1.577843874  0.539972470  0.94173802
##  [15,] -0.736953778 -0.25131339  0.008080324 -1.544078471 -0.32323783
##  [16,] -0.603515772  0.69132700  1.132765394 -0.892469498 -0.03935186
##  [17,] -0.119988600  0.71996262  0.530897165  0.748926450  0.38939021
##  [18,] -1.102483004 -1.91755812 -0.782798203  0.214167984 -1.07453253
##  [19,]  0.877945863  0.91911641  0.646482277  0.435495480  0.92631387
##  [20,] -1.351966620 -0.90631652 -0.343531269  0.214167984 -0.16295759
##  [21,] -1.449322073  0.41519153  0.194718888  0.214167984  0.58833710
##  [22,]  0.126244920 -0.14501757 -0.146887809 -0.880095982 -1.57278954
##  [23,] -0.791726487 -0.37036419 -0.747904529 -0.228487009 -0.92967643
##  [24,] -0.159321249 -0.05975848 -0.035917678  1.308431949  0.37396607
##  [25,] -0.061965795 -0.30386651 -1.444576807 -1.322750974 -2.16380399
##  [26,]  0.761900254  1.93001875  1.785463911  0.761299966  1.47866167
##  [27,]  0.378978631  1.00403624  0.071315399  0.214167984 -0.53760887
##  [28,]  0.877945863 -1.31381980 -2.180453101  1.855563932 -0.53760887
##  [29,] -0.755643934 -0.05975848 -0.215194499  0.539972470 -0.10886680
##  [30,]  0.914028416  1.63817444  1.410950332  1.412908939  1.63894192
##  [31,] -0.564183123  0.09131977  0.617766930  1.087104453  0.65785204
##  [32,] -0.658288481 -0.37036419 -0.215749562 -0.880095982 -1.07453253
##  [33,] -1.027067803  0.78612105 -0.363325695  0.748926450 -0.28457119
##  [34,]  0.339645983  0.73872402  1.125292073  0.435495480  0.55748881
##  [35,]  0.997241569 -0.41226585 -2.968406646 -3.068623912 -2.86100789
##  [36,]  1.571624002  0.99820162  0.223219561  0.435495480 -0.39275277
##  [37,] -0.101298444 -0.43102726 -0.053728589 -1.322750974 -1.46660009
##  [38,] -0.560933027 -0.64649967 -0.351856229 -0.658768485 -0.53760887
##  [39,] -0.061965795  0.46808390  1.142683740  1.308431949  0.99582881
##  [40,] -0.159321249 -0.43652262 -0.108516485  0.318644974 -0.10886680
##  [41,]  1.954545624 -0.04133633  0.985042352  0.761299966  1.42457088
##  [42,]  0.476334085  0.28253542  0.508782224  0.435495480  0.42805686
##  [43,] -1.601450236  1.01180692  1.296477731  1.412908939  1.37048009
##  [44,] -0.061965795 -0.74712833 -0.477489487 -1.101423478 -0.12429095
##  [45,]  1.069406674  1.63817444  1.542124166  1.412908939  1.90740374
##  [46,]  0.877945863  0.83351807  1.476098692  0.435495480  0.65785204
##  [47,]  0.686485052  0.38282482  0.452513887 -1.544078471 -0.32323783
##  [48,] -0.716311286 -0.12625616  0.097351924  0.539972470  0.15959503
##  [49,] -0.680228733 -2.51383426 -2.280570690 -1.648555461 -1.91076631
##  [50,] -0.673728541 -1.66422364  0.417007621 -2.742819426 -1.30432771
##  [51,]  0.877945863  1.06809114  0.435752390 -0.449814505  0.80270814
##  [52,] -0.697621129  0.08582441 -0.786696464 -0.554291495 -0.60712381
##  [53,]  0.054079814 -0.01236146  0.333008660  0.761299966  0.38939021
##  [54,]  1.072656770 -0.77305062 -0.067442099  0.435495480 -0.10886680
##  [55,] -0.907772097 -0.20568064 -0.257326330  0.435495480 -0.32323783
##  [56,]  0.226850469 -0.69973131 -0.108947513  0.435495480 -0.10886680
##  [57,] -0.542242871 -0.55852726 -1.895611695 -0.880095982 -2.30084173
##  [58,]  0.090162367  0.77319425  0.950679500  0.761299966  0.65785204
##  [59,]  1.072656770  1.28017171  0.758251815  1.087104453  1.47866167
##  [60,] -1.063150355 -0.12625616 -0.107961422 -0.332963999 -0.10886680
##  [61,] -0.829106799 -0.87734165 -1.074723275 -1.427227964 -1.58821368
##  [62,] -0.791726487 -0.18725849  0.376091925  0.214167984  0.17501918
##  [63,]  0.783840506  0.01966599 -0.010594458  0.982627463  0.15959503
##  [64,] -0.506160318 -1.35734903 -1.280461433 -0.554291495 -0.82149484
##  [65,]  0.534356890  0.18434954 -0.076250768 -0.007159513 -0.66121460
##  [66,]  0.129495016  0.51337740  0.741170419 -1.218273984 -0.09344265
##  [67,]  0.761900254 -0.11638195  0.872617039  0.214167984  0.10550424
##  [68,]  0.378978631 -0.37036419 -0.626252668 -0.880095982 -2.76825045
##  [69,]  0.093412463 -0.06009774  0.262604967 -0.007159513  0.15959503
##  [70,]  0.187517820 -0.20601989  0.288139110 -0.332963999 -0.60712381
##  [71,] -0.159321249  0.20311095  0.564730662  0.214167984  0.44348101
##  [72,]  1.954545624  0.71219193  1.242835536  0.214167984  0.78145777
##  [73,]  0.512416638  0.54784763  1.504494141 -3.068623912  1.90740374
##  [74,] -1.001877454 -1.28274140 -0.943118413  0.214167984 -1.14404747
##  [75,]  1.260867485 -0.15828362 -0.219572717  0.214167984 -1.67897899
##  [76,] -0.520302619 -2.09727199 -0.448668578 -1.427227964 -0.87558564
##  [77,]  1.416245744 -0.37036419  0.058612221  0.761299966 -0.07020015
##  [78,] -1.637532788 -0.60120617 -1.238508334 -0.880095982 -0.37732863
##  [79,] -0.253426606  0.18434954 -0.116841445 -0.332963999 -0.32323783
##  [80,] -0.217344054 -0.40239164 -0.236298192  0.214167984 -0.17838174
##  [81,]  0.975301317  0.56111368  1.094025690  0.214167984  0.58833710
##  [82,] -1.001877454  0.32993244 -0.172024346  0.539972470 -0.48351808
##  [83,]  0.378978631  0.65929955  0.819232879  0.539972470  1.40914673
##  [84,] -0.658288481 -0.68096990  0.030982310 -0.007159513 -0.59169966
##  [85,] -0.003942991 -0.56402262 -0.137662860 -0.007159513 -0.37732863
##  [86,] -1.442821881  0.06706301  0.455032652 -0.124010019  0.03598930
##  [87,]  1.224784933  0.48134995  0.779910122  1.087104453  1.12526076
##  [88,]  1.108739323  0.70669657  0.923073830  1.308431949  0.42805686
##  [89,]  0.187517820  0.13661327  0.081181513  0.539972470  0.65785204
##  [90,] -0.408804865  0.52664345  0.996782313  0.539972470  0.30445113
##  [91,]  0.378978631  1.22972211  1.192105959  0.761299966  0.67327619
##  [92,] -0.061965795 -0.13952221 -0.640992717 -0.007159513  0.10550424
##  [93,]  0.320955827  0.64053815  0.714095570  0.539972470  0.85679893
##  [94,] -0.813666739 -0.41776121 -0.167829059  0.109690994 -0.17838174
##  [95,] -0.791726487 -2.65130722 -3.019805379 -1.427227964 -3.10622722
##  [96,]  0.531106794  1.55325461  0.722975593  1.412908939  0.91088972
##  [97,] -0.195403802  0.21848052  0.693498460  0.982627463  0.64242789
##  [98,] -0.350782060 -0.51628634 -0.520501399  0.214167984 -0.32323783
##  [99,] -1.099232908 -0.90665578 -0.522808090 -0.228487009 -0.10886680
## [100,]  0.090162367  1.49225229  1.238730552  0.214167984  0.85679893
## [101,] -0.195403802 -0.04133633  0.022657350  0.539972470 -0.53760887
## [102,]  0.129495016  0.25050797 -0.099636462  0.214167984  0.10550424
## [103,]  0.187517820 -0.21962519  0.071425161  0.539972470  0.37396607
## [104,] -0.658288481 -0.53504775 -0.761646030 -0.007159513  0.51299595
## [105,]  0.284873274  1.14995839  0.852781714  0.761299966  0.72736698
## [106,] -1.116625304 -2.00553053 -0.241107438 -0.880095982 -1.35841850
## [107,]  1.954545624 -0.84354993  0.205771157  1.203954959  0.94173802
## [108,]  0.032139562  0.31700565  0.002108720 -0.671142002  0.64242789
## [109,] -0.517052523  0.85601056 -0.095340423  0.761299966  0.15959503
## [110,]  0.570439442  0.25050797  0.270375312  0.539972470  1.47866167
## [111,] -0.369472216 -1.00694518  0.260533440 -0.228487009  0.38939021
## [112,]  0.975301317  1.06503856  0.507141725  0.865776956 -0.05477601
## [113,]  1.358222939  0.85261873  0.923073830  0.982627463  1.14068490
## [114,]  0.877945863  1.21401329  1.785463911  0.761299966  1.47866167
## [115,]  0.415061184  1.16288518  1.296874104  0.761299966  0.91088972
## [116,]  0.220350277  0.47619385 -0.852860722 -1.544078471 -1.07453253
## [117,] -1.752280638  1.47383014  0.877118844  1.855563932  1.33963179
## [118,]  1.954545624  1.93001875  1.277148541  0.761299966  0.72736698
## [119,]  1.571624002  0.80522170  1.241083907  1.308431949  0.64242789
## [120,]  0.823173154  1.50585759  0.454660520  0.761299966  1.33963179
## [121,]  1.224784933  0.79195566  0.436948955  0.539972470  0.28120862
## [122,]  0.226850469 -0.79791718 -0.460103389 -1.869882957 -1.49744838
## [123,]  1.455578392  1.93001875  1.785463911  1.855563932  1.90740374
## [124,] -0.427495021 -1.44226886 -1.395064285 -0.554291495 -1.30432771
## [125,] -0.639598325 -0.69973131 -1.705764852 -0.007159513 -0.53760887
## [126,] -0.253426606 -2.12685667  0.181892124 -0.880095982 -0.67663875
## [127,]  1.513601197  1.57201602  1.063558715  1.308431949  1.35505594
## [128,] -0.849749292 -0.50302030 -0.006216240 -0.554291495  0.10550424
## [129,] -0.061965795 -0.48765073 -0.247360871 -0.880095982 -0.87558564
## [130,] -0.159321249  0.39643012 -0.207582844  0.214167984 -0.10886680
## [131,]  0.498274337 -0.35092428 -0.610305188  0.748926450 -0.15513924
## [132,]  0.148185172 -1.40474605 -0.438751600 -1.427227964 -1.35841850
## [133,] -2.025002266 -1.73926926 -2.508971243 -0.880095982 -1.64230448
## [134,]  0.457643929  1.01764154  1.110517368  1.203954959 -0.19380589
## [135,] -0.907772097 -0.12930875 -0.245844406 -0.007159513 -0.10886680
## [136,] -0.827809039  0.17108350  0.604504937  0.761299966  0.37396607
## [137,]  1.954545624  1.93001875  1.785463911  1.855563932  1.90740374
## [138,]  0.129495016  0.31700565  0.243907759  0.318644974  0.94173802
## [139,]  0.917278512  0.70703583  0.966799046 -0.462188022  1.63894192
## [140,]  0.570439442  0.38282482  0.141349927  1.191581443  0.37396607
## [141,]  0.284873274  1.32756874  0.580667725  0.331018490  0.92631387
## [142,]  0.129495016  0.41519153  0.164735621  0.214167984  0.10550424
## [143,] -1.756828494 -1.33047768 -1.044256299 -1.101423478 -1.92619045
## [144,]  0.415061184  1.30880733 -0.075264677 -0.566665012  0.37396607
## [145,]  1.954545624  1.93001875  1.785463911  1.855563932  1.90740374
## [146,]  0.877945863 -0.92168609  0.923073830  1.308431949  0.94173802
## [147,] -0.661538577 -1.38092728 -2.120610154 -1.205900468 -1.91076631
## [148,] -1.695555593 -0.28544436  0.306330184 -0.007159513  0.10550424
## [149,] -2.121059960 -1.11324100 -1.910937263 -0.880095982 -0.01610936
## [150,]  0.914028416  0.36779450  0.490487605 -0.228487009 -0.16295759
## [151,]  0.877945863  1.24814426  1.033699034  0.761299966  0.44348101
## [152,]  0.378978631  0.39643012  0.060683748 -0.228487009  0.37396607
## [153,] -0.333389664  0.57777156 -0.427196169 -1.439601481 -0.48351808
## [154,]  1.954545624 -1.46085845  0.474332819  0.748926450  0.81813228
## [155,]  0.531106794  0.13905605  0.115040616 -0.007159513  0.10550424
## [156,]  0.975301317  0.25050797 -0.006216240 -0.007159513 -0.17838174
## [157,]  0.378978631 -0.22478130 -0.577996108  0.214167984 -0.10886680
## [158,] -0.506160318  0.95114386  0.442436851  0.761299966  0.65785204
## [159,] -1.813553539 -1.86643001 -1.303236082 -0.775618992 -0.66121460
## [160,]  0.534356890  0.20311095 -0.013273280  0.331018490  0.15959503
## [161,]  0.281623178  1.21401329  0.201168633  0.539972470 -0.10886680
## [162,]  0.187517820 -0.07885914 -0.138376165 -0.554291495 -0.12429095
## [163,]  0.129495016  0.31700565  0.757265724  0.318644974  0.92631387
## [164,] -0.600265676 -1.22241759 -0.805600843 -0.216113492 -1.66554698
## [165,]  0.914028416 -0.31713256 -2.455209890 -2.847296416 -2.04019826
## [166,] -0.473327862  0.31151029  0.782463543 -0.228487009  0.91088972
## [167,]  1.260867485  1.30880733  1.450062167  0.214167984  0.37396607
## [168,]  0.223600373 -1.19039014 -0.522435959  0.318644974 -0.87558564
## [169,] -1.546677527  0.44687972 -0.272411305  0.097317477 -0.32323783
## [170,] -0.022633147 -1.46408284 -1.471403111 -0.228487009 -0.32323783
## [171,] -0.007193087 -0.82655280 -1.011397898 -0.332963999 -0.87558564
## [172,]  0.877945863 -1.66422364  1.581973547  1.855563932  0.91088972
## [173,] -0.408804865  0.05684954  0.382752145  0.539972470  0.15959503
## [174,]  0.187517820 -0.63018105 -0.061931330 -0.880095982 -1.19813826
## [175,]  0.628462247  1.18198584  0.856173841  0.097317477  1.15610905
## [176,]  0.914028416  0.57987508  0.143656618  0.435495480  0.67327619
## [177,] -0.061965795  0.19937986  0.030110763  1.855563932  1.12526076
## [178,]  1.033324122  0.46258855  0.254328487  0.214167984  0.31987527
## [179,]  0.339645983 -0.37036419 -0.460286320  0.214167984  0.53424631
## [180,]  0.129495016  0.68827442 -0.899494357 -0.007159513 -0.10886680
## [181,]  0.148185172  0.00639994 -0.005502935 -0.332963999 -0.10886680
## [182,] -1.027067803 -0.64860320 -2.655626426 -1.857509440 -1.08995667
## [183,]  1.380163191  1.93001875  0.919681702  0.097317477  0.15959503
## [184,]  0.378978631  0.39643012  0.129890427  0.761299966  0.10550424
## [185,] -1.254611166 -0.49752494 -1.269085071 -0.332963999 -1.65772862
## [186,]  1.455578392  1.61941304  1.577843874  1.855563932  1.90740374
## [187,] -0.603515772 -0.10749476  0.962851856  0.761299966 -0.05477601
## [188,] -3.412358544 -1.23602289 -2.773824296 -3.068623912 -2.64663685
## [189,] -1.254611166 -1.11839710 -1.643068277 -0.554291495 -0.87558564
## [190,]  0.281623178  0.77319425  0.268303785  0.214167984 -0.10886680
## [191,]  1.705062008 -0.09972407 -0.571172416 -1.765405967  1.08659411
## [192,]  0.512416638  1.93001875  1.391487139  1.191581443  0.83554857
## [193,]  0.917278512  1.30914659  1.438072294 -0.007159513  0.80270814
## [194,]  1.954545624 -0.70471996  1.419275292  1.529759446  0.87222308
## [195,] -0.600265676 -0.23770809 -0.462639676 -0.775618992 -0.89100978
## [196,]  0.573689539 -1.44192960 -1.385896866 -0.880095982 -1.10538082
## [197,]  1.954545624  0.61671938  1.785463911  0.748926450  1.90740374
## [198,]  1.954545624  1.06809114  1.292000168  1.855563932  1.37048009
## [199,]  0.129495016 -0.01236146  0.013135376 -0.554291495 -0.37732863
## [200,]  1.166762128  0.06706301  0.244413893 -0.007159513  0.94173802
## [201,]  0.378978631  0.39643012  0.613943774 -0.228487009  0.42805686
## [202,] -0.217344054  0.18401029  0.561869357  0.435495480  1.05574582
## [203,] -0.311449411 -1.87565646 -1.956525237 -1.427227964  0.37396607
## [204,] -0.889081940 -2.33150581 -1.138193514 -1.322750974 -1.35841850
## [205,] -0.061965795  0.41179969 -0.975839399 -0.880095982 -0.05477601
## [206,] -1.235921010 -1.41573676 -0.617654474  0.214167984 -1.69639527
## [207,]  0.570439442  0.47585459  0.536942509  1.308431949  0.35854192
## [208,] -0.119988600  0.18434954  0.621340173  0.865776956  1.10201826
## [209,] -0.676978637  0.51032482  0.088471901  0.214167984 -0.17838174
## [210,] -0.736953778  0.21814126  0.155348097  1.203954959  0.91088972
## [211,] -0.159321249 -0.94044750 -0.943118413  0.214167984 -0.64579046
## [212,] -0.408804865  0.44382714  0.019265222  0.214167984 -0.39275277
## [213,] -0.986437394 -0.67757807 -0.375638744 -0.996946488 -0.80607070
## [214,] -0.849749292 -0.06009774 -0.456993538  1.087104453  0.15959503
## [215,] -1.695555593 -1.03897263 -1.791543613 -0.111636502 -1.15947161
## [216,] -2.483339089 -1.35700977 -1.071455183 -1.218273984 -0.21704839
## [217,] -1.406739329  0.39643012  0.028145245  0.761299966 -0.12429095
## [218,]  0.975301317  0.95114386  0.747620164 -0.880095982  0.87222308
## [219,]  0.320955827  0.01966599  0.417113630 -0.332963999  0.58833710
## [220,] -3.213099781 -3.50369987 -3.609178518 -1.974359947 -2.90728033
## [221,] -0.408804865 -0.55041732 -0.140199147 -0.880095982 -0.71530540
## [222,]  0.013449406  0.57404047 -0.169421078  0.318644974  0.44348101
## [223,] -0.061965795  0.78646030  0.316224288  0.214167984  0.37396607
## [224,] -0.752393838 -0.07851989 -0.159246061 -1.322750974 -0.80607070
## [225,]  0.324205923 -0.82994463 -0.988063069 -1.101423478  0.62700375
## [226,]  0.148185172  0.55527906 -0.415202881 -0.111636502 -0.10886680
## [227,] -1.005127550 -0.62030683 -0.951344027 -2.091210453 -1.21356241
## [228,]  0.262933022  1.21062145  0.705611920  0.435495480  0.85679893
## [229,] -0.849749292 -0.28544436 -0.293281201 -1.869882957 -0.37732863
## [230,]  1.954545624  1.93001875  1.577843874  1.855563932  1.90740374
## [231,] -2.251247870 -1.01987197 -1.173200365 -1.101423478 -1.64230448
## [232,] -0.369472216 -0.04133633 -0.184248015  0.097317477  0.01473894
## [233,] -0.178011405  0.57064863  0.907350656  1.308431949  0.87222308
## [234,] -0.560933027 -0.61447222 -0.371616448  0.761299966 -0.39275277
## [235,] -0.603515772 -1.50537470 -2.200570703 -0.996946488 -1.14404747
## [236,] -0.907772097 -0.79452535 -0.594086296  0.214167984 -0.96052472
## [237,] -0.889081940 -1.24894968 -0.535353026 -0.228487009 -0.32323783
## [238,] -0.119988600 -0.43652262 -1.037806554 -0.775618992 -0.37732863
## [239,] -0.022633147 -0.36697236 -2.052351943  0.109690994 -1.55736539
## [240,] -0.755643934 -0.27183906 -0.726800836 -0.228487009  0.37396607
## [241,] -0.874939640  1.22388750  0.847393164  0.435495480  1.62351777
## [242,]  1.954545624 -3.48897806  0.484818593 -3.068623912  0.13635253
## [243,] -1.367406680  0.87104088  1.011030397 -0.880095982  1.47866167
## [244,]  1.455578392  1.32756874  0.927575634  0.097317477  0.69651869
## [245,] -1.601450236 -0.99089710 -0.202920982 -0.437440989 -0.60712381
## [246,] -0.408804865 -0.99157561 -1.460929702  0.097317477 -1.71181942
## [247,]  1.166762128  0.02821393  0.722904239 -0.880095982  0.65785204
## [248,]  0.129495016 -0.25341691  0.065295315  0.761299966  0.15959503
## [249,] -0.600265676  0.10458582 -0.779406075 -0.880095982 -0.53760887
## [250,]  0.324205923  0.96990526  0.827027466  0.423121964  0.09008009
##                LOYAL
##   [1,] -0.7404134392
##   [2,]  0.9996673370
##   [3,] -0.5790374090
##   [4,]  1.0853564905
##   [5,]  0.4626923930
##   [6,]  1.0425119138
##   [7,]  0.0594945246
##   [8,] -0.2521486311
##   [9,] -0.5361928323
##  [10,] -0.0742825511
##  [11,]  0.5055369697
##  [12,] -1.3361007960
##  [13,] -0.0690392057
##  [14,]  1.0853564905
##  [15,]  0.1134480059
##  [16,]  0.3282931035
##  [17,]  0.9996673370
##  [18,] -2.2275634725
##  [19,]  0.9509572011
##  [20,] -0.5573040138
##  [21,]  0.4409589977
##  [22,] -0.9393907007
##  [23,] -0.4017935428
##  [24,]  0.3552698442
##  [25,] -2.8502275700
##  [26,]  1.2567347975
##  [27,] -0.3589489661
##  [28,]  0.7626044303
##  [29,]  0.3711376803
##  [30,]  1.2567347975
##  [31,]  0.6880241813
##  [32,] -1.5831659797
##  [33,]  0.9568227602
##  [34,]  0.4626923930
##  [35,] -3.0761815722
##  [36,] -0.1118837824
##  [37,] -2.3889395026
##  [38,] -0.2943709940
##  [39,]  1.0525141907
##  [40,]  0.7954467301
##  [41,]  0.6880241813
##  [42,]  0.5853605641
##  [43,]  0.9996673370
##  [44,]  0.0007821118
##  [45,]  0.8594024884
##  [46,] -1.9698737982
##  [47,] -0.7562812753
##  [48,]  0.2795829676
##  [49,] -1.8460989994
##  [50,] -0.9335251415
##  [51,]  0.4626923930
##  [52,] -0.5790374090
##  [53,]  0.5107803151
##  [54,]  0.2367383908
##  [55,] -0.3161043893
##  [56,] -0.4017935428
##  [57,] -0.9933441820
##  [58,]  0.1510492373
##  [59,]  1.1282010673
##  [60,] -0.8102347566
##  [61,] -1.2715228240
##  [62,]  0.2795829676
##  [63,]  0.2208705547
##  [64,]  0.0542511792
##  [65,] -2.3191181852
##  [66,] -0.8689471694
##  [67,] -0.3917912659
##  [68,] -2.1207631375
##  [69,]  0.4568268338
##  [70,] -0.0690392057
##  [71,]  0.2208705547
##  [72,] -0.3806823613
##  [73,] -3.0761815722
##  [74,] -0.8102347566
##  [75,] -0.3213477347
##  [76,] -0.3859257067
##  [77,]  0.4409589977
##  [78,]  0.5912261232
##  [79,]  0.2367383908
##  [80,]  0.0225155070
##  [81,]  0.9879362186
##  [82,]  0.4139822570
##  [83,]  1.1710456440
##  [84,] -0.6060141497
##  [85,] -0.7186800439
##  [86,] -0.5414361777
##  [87,]  1.0425119138
##  [88,]  0.6769152768
##  [89,]  0.9996673370
##  [90,]  0.6551818815
##  [91,]  0.7626044303
##  [92,] -0.2462830719
##  [93,]  0.7097575766
##  [94,] -0.4616125833
##  [95,] -3.2047153025
##  [96,]  0.9668250372
##  [97,]  0.7038920174
##  [98,] -0.0690392057
##  [99,] -0.9387684869
## [100,]  0.8106923524
## [101,] -0.7615246206
## [102,] -0.2304152358
## [103,]  0.8224234708
## [104,] -0.2093040543
## [105,]  1.1710456440
## [106,] -0.7134366985
## [107,]  0.1082046605
## [108,]  0.3981144209
## [109,]  1.0853564905
## [110,]  1.2138902208
## [111,]  0.2426039500
## [112,]  0.7097575766
## [113,]  1.3424239511
## [114,]  1.0853564905
## [115,]  0.8165579116
## [116,]  0.6980264582
## [117,]  1.1710456440
## [118,]  0.9996673370
## [119,]  0.4726946699
## [120,]  0.7626044303
## [121,] -0.5790374090
## [122,] -1.5666759298
## [123,]  1.2567347975
## [124,]  0.1938938141
## [125,] -0.4716148602
## [126,] -2.1148975783
## [127,]  1.0525141907
## [128,] -0.1817050998
## [129,] -0.8325903657
## [130,] -0.1118837824
## [131,]  0.3770032395
## [132,] -1.1705880482
## [133,]  1.3424239511
## [134,]  0.4198478162
## [135,] -0.2245496766
## [136,]  1.1282010673
## [137,]  1.3424239511
## [138,]  0.9879362186
## [139,]  0.2208705547
## [140,]  0.5912261232
## [141,]  0.6880241813
## [142,]  1.3424239511
## [143,] -1.0890356124
## [144,]  0.5912261232
## [145,]  0.9996673370
## [146,] -0.1553505730
## [147,] -1.4974768262
## [148,] -0.3161043893
## [149,] -1.3361007960
## [150,]  1.0853564905
## [151,]  1.1710456440
## [152,]  0.2367383908
## [153,]  0.8652680475
## [154,]  1.1710456440
## [155,] -0.4446381196
## [156,] -0.0531713696
## [157,] -1.0039686727
## [158,]  0.7626044303
## [159,] -0.7351700938
## [160,]  0.4568268338
## [161,]  0.3770032395
## [162,]  0.2156272093
## [163,]  0.7795788940
## [164,] -1.1588569298
## [165,]  0.9996673370
## [166,] -1.3361007960
## [167,]  0.9996673370
## [168,]  0.2954508037
## [169,]  0.2367383908
## [170,]  0.0594945246
## [171,] -0.1717028229
## [172,]  1.0425119138
## [173,]  0.5266481512
## [174,] -0.4563692380
## [175,] -0.4669937287
## [176,] -1.0790333355
## [177,]  0.2789607538
## [178,]  0.3711376803
## [179,]  1.3424239511
## [180,] -0.7562812753
## [181,] -0.2245496766
## [182,] -0.2573919765
## [183,]  0.9568227602
## [184,] -0.9822352774
## [185,] -1.2234349019
## [186,]  1.3424239511
## [187,]  0.3711376803
## [188,] -0.4505036788
## [189,] -0.9387684869
## [190,]  0.5055369697
## [191,]  0.4626923930
## [192,] -0.4241491519
## [193,] -0.4241491519
## [194,]  1.0425119138
## [195,] -0.9933441820
## [196,] -0.7345478800
## [197,]  1.1282010673
## [198,]  1.0425119138
## [199,]  0.7097575766
## [200,]  0.5266481512
## [201,] -0.5426806053
## [202,]  0.7626044303
## [203,] -0.0320601881
## [204,]  0.4081166978
## [205,]  0.5912261232
## [206,] -3.2047153025
## [207,]  1.3424239511
## [208,]  0.6451796046
## [209,]  0.4568268338
## [210,]  0.1134480059
## [211,] -0.6329908904
## [212,] -1.2938784331
## [213,] -0.1388605231
## [214,]  0.2854485268
## [215,] -0.9874786228
## [216,] -2.0450762609
## [217,]  1.1710456440
## [218,]  0.5325137104
## [219,]  0.5325137104
## [220,] -2.5820512049
## [221,] -0.8959239101
## [222,]  0.9568227602
## [223,]  0.6610474407
## [224,] -0.3161043893
## [225,] -0.2838843033
## [226,]  0.3013163629
## [227,] -1.4276555087
## [228,]  0.5853605641
## [229,] -0.5473017369
## [230,]  1.3424239511
## [231,] -2.4048073387
## [232,] -1.2504116425
## [233,]  0.5483815465
## [234,] -0.1817050998
## [235,] -1.2932562193
## [236,] -0.0590369288
## [237,]  0.2854485268
## [238,] -0.4781026332
## [239,] -2.8989377060
## [240,] -0.0109490066
## [241,]  1.1710456440
## [242,]  1.1710456440
## [243,]  0.9996673370
## [244,]  1.3424239511
## [245,]  0.2308728316
## [246,] -1.7023196468
## [247,] -0.0050834474
## [248,]  0.2308728316
## [249,] -0.1875706590
## [250,]  1.0425119138
## attr(,&quot;scaled:center&quot;)
##           EXP         IMAGE          QUAL         VALUE        SATISF 
## -6.222800e-17  5.578871e-17  2.159384e-17 -7.310819e-17 -1.755263e-16 
##         LOYAL 
## -4.485301e-17 
## attr(,&quot;scaled:scale&quot;)
##       EXP     IMAGE      QUAL     VALUE    SATISF     LOYAL 
## 0.5231365 1.1889121 2.3487935 1.0512457 1.4909429 0.9860017</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="customer-satisfaction-and-loyalty.html#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Unstandardised solution</span></span>
<span id="cb295-2"><a href="customer-satisfaction-and-loyalty.html#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="customer-satisfaction-and-loyalty.html#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get unstandardized LV</span></span>
<span id="cb295-4"><a href="customer-satisfaction-and-loyalty.html#cb295-4" aria-hidden="true" tabindex="-1"></a>unstandardized_LV <span class="ot">&lt;-</span> <span class="cf">function</span>(data, sempls_model){</span>
<span id="cb295-5"><a href="customer-satisfaction-and-loyalty.html#cb295-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save object to hold outer weights which will be scaled in loop</span></span>
<span id="cb295-6"><a href="customer-satisfaction-and-loyalty.html#cb295-6" aria-hidden="true" tabindex="-1"></a>  outer_weights_resc <span class="ot">&lt;-</span> sempls_model<span class="sc">$</span>outer_weights</span>
<span id="cb295-7"><a href="customer-satisfaction-and-loyalty.html#cb295-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find standard deviation of indicators</span></span>
<span id="cb295-8"><a href="customer-satisfaction-and-loyalty.html#cb295-8" aria-hidden="true" tabindex="-1"></a>  std_indicators <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(data, <span class="at">FUN =</span> sd))</span>
<span id="cb295-9"><a href="customer-satisfaction-and-loyalty.html#cb295-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (lv <span class="cf">in</span> <span class="fu">colnames</span>(sempls_model<span class="sc">$</span>model<span class="sc">$</span>M)) {</span>
<span id="cb295-10"><a href="customer-satisfaction-and-loyalty.html#cb295-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check estimation mode of LV</span></span>
<span id="cb295-11"><a href="customer-satisfaction-and-loyalty.html#cb295-11" aria-hidden="true" tabindex="-1"></a>    mode <span class="ot">&lt;-</span> <span class="fu">attr</span>(sempls_model<span class="sc">$</span>model<span class="sc">$</span>blocks[[lv]], <span class="st">&quot;mode&quot;</span>)</span>
<span id="cb295-12"><a href="customer-satisfaction-and-loyalty.html#cb295-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mode <span class="sc">==</span> <span class="st">&quot;A&quot;</span>) {</span>
<span id="cb295-13"><a href="customer-satisfaction-and-loyalty.html#cb295-13" aria-hidden="true" tabindex="-1"></a>      tmp_indicator_names <span class="ot">&lt;-</span> sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[,<span class="dv">1</span>]<span class="sc">==</span>lv,<span class="dv">2</span>]</span>
<span id="cb295-14"><a href="customer-satisfaction-and-loyalty.html#cb295-14" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb295-15"><a href="customer-satisfaction-and-loyalty.html#cb295-15" aria-hidden="true" tabindex="-1"></a>      tmp_indicator_names <span class="ot">&lt;-</span> sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[,<span class="dv">2</span>]<span class="sc">==</span>lv,<span class="dv">1</span>]  </span>
<span id="cb295-16"><a href="customer-satisfaction-and-loyalty.html#cb295-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb295-17"><a href="customer-satisfaction-and-loyalty.html#cb295-17" aria-hidden="true" tabindex="-1"></a>    tmp_weights <span class="ot">&lt;-</span> outer_weights_resc[tmp_indicator_names,lv]</span>
<span id="cb295-18"><a href="customer-satisfaction-and-loyalty.html#cb295-18" aria-hidden="true" tabindex="-1"></a>    tmp_weights <span class="ot">&lt;-</span> tmp_weights<span class="sc">/</span>std_indicators[tmp_indicator_names]</span>
<span id="cb295-19"><a href="customer-satisfaction-and-loyalty.html#cb295-19" aria-hidden="true" tabindex="-1"></a>    outer_weights_resc[tmp_indicator_names,lv] <span class="ot">&lt;-</span> tmp_weights<span class="sc">/</span><span class="fu">sum</span>(tmp_weights)</span>
<span id="cb295-20"><a href="customer-satisfaction-and-loyalty.html#cb295-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb295-21"><a href="customer-satisfaction-and-loyalty.html#cb295-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb295-22"><a href="customer-satisfaction-and-loyalty.html#cb295-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data as matrix in order to perform matrix multiplication</span></span>
<span id="cb295-23"><a href="customer-satisfaction-and-loyalty.html#cb295-23" aria-hidden="true" tabindex="-1"></a>  data_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[,<span class="fu">rownames</span>(outer_weights_resc)])</span>
<span id="cb295-24"><a href="customer-satisfaction-and-loyalty.html#cb295-24" aria-hidden="true" tabindex="-1"></a>  unstandardized_LV <span class="ot">&lt;-</span> data_mat <span class="sc">%*%</span> outer_weights_resc</span>
<span id="cb295-25"><a href="customer-satisfaction-and-loyalty.html#cb295-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(unstandardized_LV)</span>
<span id="cb295-26"><a href="customer-satisfaction-and-loyalty.html#cb295-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb295-27"><a href="customer-satisfaction-and-loyalty.html#cb295-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-28"><a href="customer-satisfaction-and-loyalty.html#cb295-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Unstandardized LV</span></span>
<span id="cb295-29"><a href="customer-satisfaction-and-loyalty.html#cb295-29" aria-hidden="true" tabindex="-1"></a>LV_unstand <span class="ot">&lt;-</span> <span class="fu">unstandardized_LV</span>(<span class="at">data =</span> mobi, <span class="at">sempls_model =</span> epsi)</span>
<span id="cb295-30"><a href="customer-satisfaction-and-loyalty.html#cb295-30" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(LV_unstand)</span></code></pre></div>
<pre><code>##           EXP    IMAGE     QUAL     VALUE    SATISF    LOYAL
## [1,] 6.683309 5.553162 5.730157  2.595477  5.790953 5.915991
## [2,] 9.683309 9.785231 9.741153 10.000000  9.299712 9.327926
## [3,] 7.000000 6.131233 6.979907  7.000000  7.370261 6.232415
## [4,] 7.095731 7.456748 7.361482  5.000000 10.000000 9.495944
## [5,] 8.390344 8.411795 9.004820  6.000000  8.740522 8.275030
## [6,] 8.806891 8.595372 9.043931 10.000000  7.370261 9.411935</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="customer-satisfaction-and-loyalty.html#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LV_unstand[,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-157-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="customer-satisfaction-and-loyalty.html#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(LV_unstand,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">cex=</span><span class="fl">0.7</span>,<span class="at">cex.axis=</span><span class="fl">0.8</span>,<span class="at">col.axis=</span><span class="st">&quot;gray70&quot;</span>,<span class="at">gap=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-157-2.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="customer-satisfaction-and-loyalty.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LV_unstand)</span></code></pre></div>
<pre><code>##       EXP             IMAGE             QUAL            VALUE       
##  Min.   : 3.187   Min.   : 2.914   Min.   : 3.199   Min.   : 1.000  
##  1st Qu.: 6.683   1st Qu.: 6.686   1st Qu.: 7.152   1st Qu.: 5.579  
##  Median : 7.525   Median : 7.538   Median : 7.788   Median : 7.000  
##  Mean   : 7.519   Mean   : 7.483   Mean   : 7.749   Mean   : 6.609  
##  3rd Qu.: 8.299   3rd Qu.: 8.371   3rd Qu.: 8.658   3rd Qu.: 7.977  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      SATISF           LOYAL       
##  Min.   : 3.461   Min.   : 1.084  
##  1st Qu.: 6.811   1st Qu.: 6.304  
##  Median : 7.640   Median : 7.820  
##  Mean   : 7.512   Mean   : 7.368  
##  3rd Qu.: 8.385   3rd Qu.: 8.863  
##  Max.   :10.000   Max.   :10.000</code></pre>
</div>
</div>
<div id="revised-code" class="section level3" number="2.4.7">
<h3><span class="header-section-number">2.4.7</span> Revised code</h3>
<p>He made some changes, e.g., removing the question that was not relevant for the customer loyalty.</p>
<p>In this setup the only difference is that I have made some modifications to the model formulation.</p>
<ol style="list-style-type: decimal">
<li>I have deleted CUSL2 for the reasons mentioned above</li>
<li>I have included IMAGE5 that I actually forgot to include in the
first setup (it does not have any real influence I found out)</li>
<li>I have modified the Quality construct. Now it only has 2 items</li>
</ol>
<p>So it is now a contruct that measures the perception of the service in an attempt to avoid it to be mixed up with SAT</p>
<p>If you run this model, you will see that the problem with EXP still remains and the effect of EXP is still insignificant, so it could be an idea simply to drop EXP from the model. The construct IMAGE still have a relative low AVE, but the effects from IMAGE are now significant.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="customer-satisfaction-and-loyalty.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)  <span class="co">#Bootstrapping of standard deviations to outer loadings and path coefficients</span></span>
<span id="cb301-2"><a href="customer-satisfaction-and-loyalty.html#cb301-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPLS)</span>
<span id="cb301-3"><a href="customer-satisfaction-and-loyalty.html#cb301-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb301-4"><a href="customer-satisfaction-and-loyalty.html#cb301-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb301-5"><a href="customer-satisfaction-and-loyalty.html#cb301-5" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(mobi)</span>
<span id="cb301-6"><a href="customer-satisfaction-and-loyalty.html#cb301-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mobi)</span>
<span id="cb301-7"><a href="customer-satisfaction-and-loyalty.html#cb301-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mobi)</span></code></pre></div>
<pre><code>##  [1] &quot;CUEX1&quot; &quot;CUEX2&quot; &quot;CUEX3&quot; &quot;CUSA1&quot; &quot;CUSA2&quot; &quot;CUSA3&quot; &quot;CUSCO&quot; &quot;CUSL1&quot; &quot;CUSL2&quot;
## [10] &quot;CUSL3&quot; &quot;IMAG1&quot; &quot;IMAG2&quot; &quot;IMAG3&quot; &quot;IMAG4&quot; &quot;IMAG5&quot; &quot;PERQ1&quot; &quot;PERQ2&quot; &quot;PERQ3&quot;
## [19] &quot;PERQ4&quot; &quot;PERQ5&quot; &quot;PERQ6&quot; &quot;PERQ7&quot; &quot;PERV1&quot; &quot;PERV2&quot;</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="customer-satisfaction-and-loyalty.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The dataset</span></span>
<span id="cb303-2"><a href="customer-satisfaction-and-loyalty.html#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mobi)</span></code></pre></div>
<pre><code>##      CUEX1           CUEX2            CUEX3            CUSA1       
##  Min.   : 1.00   Min.   : 1.000   Min.   : 1.000   Min.   : 4.000  
##  1st Qu.: 7.00   1st Qu.: 7.000   1st Qu.: 6.000   1st Qu.: 7.000  
##  Median : 8.00   Median : 8.000   Median : 8.000   Median : 8.000  
##  Mean   : 7.58   Mean   : 7.532   Mean   : 7.424   Mean   : 7.988  
##  3rd Qu.: 8.00   3rd Qu.: 9.000   3rd Qu.: 9.000   3rd Qu.: 9.000  
##  Max.   :10.00   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      CUSA2            CUSA3            CUSCO            CUSL1       
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.000   Min.   : 1.000  
##  1st Qu.: 6.000   1st Qu.: 7.000   1st Qu.: 6.000   1st Qu.: 6.000  
##  Median : 7.000   Median : 7.000   Median : 7.000   Median : 8.000  
##  Mean   : 7.128   Mean   : 7.316   Mean   : 7.068   Mean   : 7.452  
##  3rd Qu.: 8.000   3rd Qu.: 8.000   3rd Qu.: 9.000   3rd Qu.:10.000  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      CUSL2            CUSL3            IMAG1           IMAG2      
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.00   Min.   : 1.00  
##  1st Qu.: 3.000   1st Qu.: 7.000   1st Qu.: 7.00   1st Qu.: 7.00  
##  Median : 4.000   Median : 8.000   Median : 8.00   Median : 8.00  
##  Mean   : 4.988   Mean   : 7.668   Mean   : 7.64   Mean   : 7.78  
##  3rd Qu.: 6.750   3rd Qu.:10.000   3rd Qu.: 9.00   3rd Qu.: 9.00  
##  Max.   :10.000   Max.   :10.000   Max.   :10.00   Max.   :10.00  
##      IMAG3            IMAG4            IMAG5            PERQ1       
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.000   Min.   : 2.000  
##  1st Qu.: 5.000   1st Qu.: 7.000   1st Qu.: 7.000   1st Qu.: 7.000  
##  Median : 7.000   Median : 8.000   Median : 8.000   Median : 8.000  
##  Mean   : 6.744   Mean   : 7.588   Mean   : 7.932   Mean   : 7.944  
##  3rd Qu.: 8.000   3rd Qu.: 9.000   3rd Qu.: 9.000   3rd Qu.: 9.000  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      PERQ2            PERQ3          PERQ4            PERQ5       
##  Min.   : 1.000   Min.   : 1.0   Min.   : 1.000   Min.   : 3.000  
##  1st Qu.: 6.000   1st Qu.: 7.0   1st Qu.: 7.000   1st Qu.: 7.000  
##  Median : 7.000   Median : 8.0   Median : 8.000   Median : 8.000  
##  Mean   : 7.192   Mean   : 7.7   Mean   : 7.916   Mean   : 7.872  
##  3rd Qu.: 8.000   3rd Qu.: 9.0   3rd Qu.: 9.000   3rd Qu.: 9.000  
##  Max.   :10.000   Max.   :10.0   Max.   :10.000   Max.   :10.000  
##      PERQ6            PERQ7            PERV1            PERV2       
##  Min.   : 1.000   Min.   : 1.000   Min.   : 1.000   Min.   : 1.000  
##  1st Qu.: 7.000   1st Qu.: 7.000   1st Qu.: 5.000   1st Qu.: 6.000  
##  Median : 8.000   Median : 8.000   Median : 6.000   Median : 7.000  
##  Mean   : 7.776   Mean   : 7.592   Mean   : 6.156   Mean   : 6.916  
##  3rd Qu.: 9.000   3rd Qu.: 9.000   3rd Qu.: 8.000   3rd Qu.: 8.000  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="customer-satisfaction-and-loyalty.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(mobi) <span class="co">#from library(psych)</span></span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">vars</th>
<th align="right">n</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">median</th>
<th align="right">trimmed</th>
<th align="right">mad</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">range</th>
<th align="right">skew</th>
<th align="right">kurtosis</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CUEX1</td>
<td align="right">1</td>
<td align="right">250</td>
<td align="right">7.580</td>
<td align="right">1.621765</td>
<td align="right">8</td>
<td align="right">7.680</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.6632888</td>
<td align="right">0.8289969</td>
<td align="right">0.1025694</td>
</tr>
<tr class="even">
<td align="left">CUEX2</td>
<td align="right">2</td>
<td align="right">250</td>
<td align="right">7.532</td>
<td align="right">1.792716</td>
<td align="right">8</td>
<td align="right">7.665</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7996766</td>
<td align="right">1.4470764</td>
<td align="right">0.1133813</td>
</tr>
<tr class="odd">
<td align="left">CUEX3</td>
<td align="right">3</td>
<td align="right">250</td>
<td align="right">7.424</td>
<td align="right">2.102834</td>
<td align="right">8</td>
<td align="right">7.630</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.8489926</td>
<td align="right">0.6154474</td>
<td align="right">0.1329949</td>
</tr>
<tr class="even">
<td align="left">CUSA1</td>
<td align="right">4</td>
<td align="right">250</td>
<td align="right">7.988</td>
<td align="right">1.233671</td>
<td align="right">8</td>
<td align="right">8.030</td>
<td align="right">1.4826</td>
<td align="right">4</td>
<td align="right">10</td>
<td align="right">6</td>
<td align="right">-0.2201919</td>
<td align="right">0.1527890</td>
<td align="right">0.0780242</td>
</tr>
<tr class="odd">
<td align="left">CUSA2</td>
<td align="right">5</td>
<td align="right">250</td>
<td align="right">7.128</td>
<td align="right">1.765242</td>
<td align="right">7</td>
<td align="right">7.180</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.5471886</td>
<td align="right">0.5579660</td>
<td align="right">0.1116437</td>
</tr>
<tr class="even">
<td align="left">CUSA3</td>
<td align="right">6</td>
<td align="right">250</td>
<td align="right">7.316</td>
<td align="right">1.747099</td>
<td align="right">7</td>
<td align="right">7.405</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.6671235</td>
<td align="right">0.9615690</td>
<td align="right">0.1104962</td>
</tr>
<tr class="odd">
<td align="left">CUSCO</td>
<td align="right">7</td>
<td align="right">250</td>
<td align="right">7.068</td>
<td align="right">2.274217</td>
<td align="right">7</td>
<td align="right">7.285</td>
<td align="right">2.2239</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7099909</td>
<td align="right">0.2384216</td>
<td align="right">0.1438341</td>
</tr>
<tr class="even">
<td align="left">CUSL1</td>
<td align="right">8</td>
<td align="right">250</td>
<td align="right">7.452</td>
<td align="right">2.658565</td>
<td align="right">8</td>
<td align="right">7.860</td>
<td align="right">2.9652</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9946527</td>
<td align="right">0.0768705</td>
<td align="right">0.1681424</td>
</tr>
<tr class="odd">
<td align="left">CUSL2</td>
<td align="right">9</td>
<td align="right">250</td>
<td align="right">4.988</td>
<td align="right">2.839031</td>
<td align="right">4</td>
<td align="right">4.800</td>
<td align="right">2.9652</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">0.5449058</td>
<td align="right">-0.9063918</td>
<td align="right">0.1795561</td>
</tr>
<tr class="even">
<td align="left">CUSL3</td>
<td align="right">10</td>
<td align="right">250</td>
<td align="right">7.668</td>
<td align="right">2.218437</td>
<td align="right">8</td>
<td align="right">7.955</td>
<td align="right">2.9652</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-1.0592863</td>
<td align="right">0.8637662</td>
<td align="right">0.1403063</td>
</tr>
<tr class="odd">
<td align="left">IMAG1</td>
<td align="right">11</td>
<td align="right">250</td>
<td align="right">7.640</td>
<td align="right">1.699988</td>
<td align="right">8</td>
<td align="right">7.765</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9014379</td>
<td align="right">1.6887323</td>
<td align="right">0.1075167</td>
</tr>
<tr class="even">
<td align="left">IMAG2</td>
<td align="right">12</td>
<td align="right">250</td>
<td align="right">7.780</td>
<td align="right">1.687302</td>
<td align="right">8</td>
<td align="right">7.930</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7931040</td>
<td align="right">0.9620206</td>
<td align="right">0.1067143</td>
</tr>
<tr class="odd">
<td align="left">IMAG3</td>
<td align="right">13</td>
<td align="right">250</td>
<td align="right">6.744</td>
<td align="right">2.131817</td>
<td align="right">7</td>
<td align="right">6.905</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.7930042</td>
<td align="right">0.6570813</td>
<td align="right">0.1348279</td>
</tr>
<tr class="even">
<td align="left">IMAG4</td>
<td align="right">14</td>
<td align="right">250</td>
<td align="right">7.588</td>
<td align="right">1.841690</td>
<td align="right">8</td>
<td align="right">7.755</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9231357</td>
<td align="right">1.3210435</td>
<td align="right">0.1164787</td>
</tr>
<tr class="odd">
<td align="left">IMAG5</td>
<td align="right">15</td>
<td align="right">250</td>
<td align="right">7.932</td>
<td align="right">1.557266</td>
<td align="right">8</td>
<td align="right">8.070</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-1.0694987</td>
<td align="right">2.6817548</td>
<td align="right">0.0984901</td>
</tr>
<tr class="even">
<td align="left">PERQ1</td>
<td align="right">16</td>
<td align="right">250</td>
<td align="right">7.944</td>
<td align="right">1.421600</td>
<td align="right">8</td>
<td align="right">8.040</td>
<td align="right">1.4826</td>
<td align="right">2</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">-0.7203890</td>
<td align="right">1.1786363</td>
<td align="right">0.0899099</td>
</tr>
<tr class="odd">
<td align="left">PERQ2</td>
<td align="right">17</td>
<td align="right">250</td>
<td align="right">7.192</td>
<td align="right">1.891414</td>
<td align="right">7</td>
<td align="right">7.330</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.8186657</td>
<td align="right">0.7287376</td>
<td align="right">0.1196235</td>
</tr>
<tr class="even">
<td align="left">PERQ3</td>
<td align="right">18</td>
<td align="right">250</td>
<td align="right">7.700</td>
<td align="right">1.821888</td>
<td align="right">8</td>
<td align="right">7.885</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9064463</td>
<td align="right">0.8310284</td>
<td align="right">0.1152263</td>
</tr>
<tr class="odd">
<td align="left">PERQ4</td>
<td align="right">19</td>
<td align="right">250</td>
<td align="right">7.916</td>
<td align="right">1.651622</td>
<td align="right">8</td>
<td align="right">8.105</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-1.0704382</td>
<td align="right">1.7901560</td>
<td align="right">0.1044578</td>
</tr>
<tr class="even">
<td align="left">PERQ5</td>
<td align="right">20</td>
<td align="right">250</td>
<td align="right">7.872</td>
<td align="right">1.453294</td>
<td align="right">8</td>
<td align="right">7.970</td>
<td align="right">1.4826</td>
<td align="right">3</td>
<td align="right">10</td>
<td align="right">7</td>
<td align="right">-0.6770313</td>
<td align="right">0.5583053</td>
<td align="right">0.0919144</td>
</tr>
<tr class="odd">
<td align="left">PERQ6</td>
<td align="right">21</td>
<td align="right">250</td>
<td align="right">7.776</td>
<td align="right">1.629862</td>
<td align="right">8</td>
<td align="right">7.925</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9743906</td>
<td align="right">1.7870540</td>
<td align="right">0.1030815</td>
</tr>
<tr class="even">
<td align="left">PERQ7</td>
<td align="right">22</td>
<td align="right">250</td>
<td align="right">7.592</td>
<td align="right">1.843674</td>
<td align="right">8</td>
<td align="right">7.775</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.9593571</td>
<td align="right">1.0528448</td>
<td align="right">0.1166042</td>
</tr>
<tr class="odd">
<td align="left">PERV1</td>
<td align="right">23</td>
<td align="right">250</td>
<td align="right">6.156</td>
<td align="right">2.183284</td>
<td align="right">6</td>
<td align="right">6.260</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.3971992</td>
<td align="right">-0.2142253</td>
<td align="right">0.1380830</td>
</tr>
<tr class="even">
<td align="left">PERV2</td>
<td align="right">24</td>
<td align="right">250</td>
<td align="right">6.916</td>
<td align="right">1.842423</td>
<td align="right">7</td>
<td align="right">6.980</td>
<td align="right">1.4826</td>
<td align="right">1</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">-0.6445980</td>
<td align="right">0.9714600</td>
<td align="right">0.1165251</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="customer-satisfaction-and-loyalty.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mobi<span class="sc">$</span>CUSL1)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-158-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="customer-satisfaction-and-loyalty.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mobi<span class="sc">$</span>CUSL2)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-158-2.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="customer-satisfaction-and-loyalty.html#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The structural model</span></span>
<span id="cb308-2"><a href="customer-satisfaction-and-loyalty.html#cb308-2" aria-hidden="true" tabindex="-1"></a>EPSIsm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;IMAGE&quot;</span>, <span class="st">&quot;VALUE&quot;</span>,<span class="st">&quot;EXP&quot;</span>,<span class="st">&quot;VALUE&quot;</span>,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;VALUE&quot;</span>,<span class="st">&quot;VALUE&quot;</span>,<span class="st">&quot;SATISF&quot;</span>,<span class="st">&quot;SATISF&quot;</span>,<span class="st">&quot;LOYAL&quot;</span>,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;LOYAL&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb308-3"><a href="customer-satisfaction-and-loyalty.html#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSIsm)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb308-4"><a href="customer-satisfaction-and-loyalty.html#cb308-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(EPSIsm)</span></code></pre></div>
<pre><code>##      source   target  
## [1,] &quot;IMAGE&quot;  &quot;VALUE&quot; 
## [2,] &quot;EXP&quot;    &quot;VALUE&quot; 
## [3,] &quot;QUAL&quot;   &quot;VALUE&quot; 
## [4,] &quot;VALUE&quot;  &quot;SATISF&quot;
## [5,] &quot;SATISF&quot; &quot;LOYAL&quot; 
## [6,] &quot;IMAGE&quot;  &quot;LOYAL&quot;</code></pre>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="customer-satisfaction-and-loyalty.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The measurement model</span></span>
<span id="cb310-2"><a href="customer-satisfaction-and-loyalty.html#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="co">#IMAG5 has been added compared to the original setup (forgotten in original setup)</span></span>
<span id="cb310-3"><a href="customer-satisfaction-and-loyalty.html#cb310-3" aria-hidden="true" tabindex="-1"></a>EPSImm1 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;IMAGE&quot;</span>, <span class="st">&quot;IMAG1&quot;</span>,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;IMAG2&quot;</span>,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;IMAG3&quot;</span>,<span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;IMAG4&quot;</span>, <span class="st">&quot;IMAGE&quot;</span>,<span class="st">&quot;IMAG5&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb310-4"><a href="customer-satisfaction-and-loyalty.html#cb310-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm1)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb310-5"><a href="customer-satisfaction-and-loyalty.html#cb310-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(EPSImm1)</span></code></pre></div>
<pre><code>##      source  target 
## [1,] &quot;IMAGE&quot; &quot;IMAG1&quot;
## [2,] &quot;IMAGE&quot; &quot;IMAG2&quot;
## [3,] &quot;IMAGE&quot; &quot;IMAG3&quot;
## [4,] &quot;IMAGE&quot; &quot;IMAG4&quot;
## [5,] &quot;IMAGE&quot; &quot;IMAG5&quot;</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="customer-satisfaction-and-loyalty.html#cb312-1" aria-hidden="true" tabindex="-1"></a>EPSImm2 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;EXP&quot;</span>, <span class="st">&quot;CUEX1&quot;</span>,<span class="st">&quot;EXP&quot;</span>,<span class="st">&quot;CUEX2&quot;</span>,<span class="st">&quot;EXP&quot;</span>,<span class="st">&quot;CUEX3&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb312-2"><a href="customer-satisfaction-and-loyalty.html#cb312-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb312-3"><a href="customer-satisfaction-and-loyalty.html#cb312-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-4"><a href="customer-satisfaction-and-loyalty.html#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;Pure&quot; service quality </span></span>
<span id="cb312-5"><a href="customer-satisfaction-and-loyalty.html#cb312-5" aria-hidden="true" tabindex="-1"></a>EPSImm3 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ3&quot;</span>,<span class="st">&quot;QUAL&quot;</span>,<span class="st">&quot;PERQ4&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb312-6"><a href="customer-satisfaction-and-loyalty.html#cb312-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm3)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb312-7"><a href="customer-satisfaction-and-loyalty.html#cb312-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(EPSImm3,<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##      source target 
## [1,] &quot;QUAL&quot; &quot;PERQ3&quot;
## [2,] &quot;QUAL&quot; &quot;PERQ4&quot;</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="customer-satisfaction-and-loyalty.html#cb314-1" aria-hidden="true" tabindex="-1"></a>EPSImm4 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;VALUE&quot;</span>, <span class="st">&quot;PERV1&quot;</span>,<span class="st">&quot;VALUE&quot;</span>,<span class="st">&quot;PERV2&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb314-2"><a href="customer-satisfaction-and-loyalty.html#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm4)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb314-3"><a href="customer-satisfaction-and-loyalty.html#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="customer-satisfaction-and-loyalty.html#cb314-4" aria-hidden="true" tabindex="-1"></a>EPSImm5 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;SATISF&quot;</span>, <span class="st">&quot;CUSA1&quot;</span>,<span class="st">&quot;SATISF&quot;</span>,<span class="st">&quot;CUSA2&quot;</span>,<span class="st">&quot;SATISF&quot;</span>,<span class="st">&quot;CUSA3&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb314-5"><a href="customer-satisfaction-and-loyalty.html#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm5)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb314-6"><a href="customer-satisfaction-and-loyalty.html#cb314-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-7"><a href="customer-satisfaction-and-loyalty.html#cb314-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Exclusion of CUSL2</span></span>
<span id="cb314-8"><a href="customer-satisfaction-and-loyalty.html#cb314-8" aria-hidden="true" tabindex="-1"></a>EPSImm6 <span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;LOYAL&quot;</span>, <span class="st">&quot;CUSL1&quot;</span>,<span class="st">&quot;LOYAL&quot;</span>,<span class="st">&quot;CUSL3&quot;</span>),<span class="at">byrow=</span><span class="cn">TRUE</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb314-9"><a href="customer-satisfaction-and-loyalty.html#cb314-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(EPSImm6)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;source&quot;</span>,<span class="st">&quot;target&quot;</span>)</span>
<span id="cb314-10"><a href="customer-satisfaction-and-loyalty.html#cb314-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-11"><a href="customer-satisfaction-and-loyalty.html#cb314-11" aria-hidden="true" tabindex="-1"></a>EPSImm <span class="ot">&lt;-</span><span class="fu">rbind</span>(EPSImm1,EPSImm2,EPSImm3,EPSImm4,EPSImm5,EPSImm6)</span>
<span id="cb314-12"><a href="customer-satisfaction-and-loyalty.html#cb314-12" aria-hidden="true" tabindex="-1"></a>EPSImm</span></code></pre></div>
<pre><code>##       source   target 
##  [1,] &quot;IMAGE&quot;  &quot;IMAG1&quot;
##  [2,] &quot;IMAGE&quot;  &quot;IMAG2&quot;
##  [3,] &quot;IMAGE&quot;  &quot;IMAG3&quot;
##  [4,] &quot;IMAGE&quot;  &quot;IMAG4&quot;
##  [5,] &quot;IMAGE&quot;  &quot;IMAG5&quot;
##  [6,] &quot;EXP&quot;    &quot;CUEX1&quot;
##  [7,] &quot;EXP&quot;    &quot;CUEX2&quot;
##  [8,] &quot;EXP&quot;    &quot;CUEX3&quot;
##  [9,] &quot;QUAL&quot;   &quot;PERQ3&quot;
## [10,] &quot;QUAL&quot;   &quot;PERQ4&quot;
## [11,] &quot;VALUE&quot;  &quot;PERV1&quot;
## [12,] &quot;VALUE&quot;  &quot;PERV2&quot;
## [13,] &quot;SATISF&quot; &quot;CUSA1&quot;
## [14,] &quot;SATISF&quot; &quot;CUSA2&quot;
## [15,] &quot;SATISF&quot; &quot;CUSA3&quot;
## [16,] &quot;LOYAL&quot;  &quot;CUSL1&quot;
## [17,] &quot;LOYAL&quot;  &quot;CUSL3&quot;</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="customer-satisfaction-and-loyalty.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The whole model</span></span>
<span id="cb316-2"><a href="customer-satisfaction-and-loyalty.html#cb316-2" aria-hidden="true" tabindex="-1"></a>EPSI <span class="ot">&lt;-</span> <span class="fu">plsm</span>(<span class="at">data=</span>mobi,<span class="at">strucmod=</span>EPSIsm,<span class="at">measuremod=</span>EPSImm)</span>
<span id="cb316-3"><a href="customer-satisfaction-and-loyalty.html#cb316-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-4"><a href="customer-satisfaction-and-loyalty.html#cb316-4" aria-hidden="true" tabindex="-1"></a>EPSI[[<span class="st">&quot;D&quot;</span>]] <span class="co">#The structural model (inner relations)</span></span></code></pre></div>
<pre><code>##        EXP IMAGE QUAL VALUE SATISF LOYAL
## EXP      0     0    0     1      0     0
## IMAGE    0     0    0     1      0     1
## QUAL     0     0    0     1      0     0
## VALUE    0     0    0     0      1     0
## SATISF   0     0    0     0      0     1
## LOYAL    0     0    0     0      0     0</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="customer-satisfaction-and-loyalty.html#cb318-1" aria-hidden="true" tabindex="-1"></a>EPSI[[<span class="st">&quot;M&quot;</span>]] <span class="co">#The measurement model</span></span></code></pre></div>
<pre><code>##       EXP IMAGE QUAL VALUE SATISF LOYAL
## CUEX1   1     0    0     0      0     0
## CUEX2   1     0    0     0      0     0
## CUEX3   1     0    0     0      0     0
## IMAG1   0     1    0     0      0     0
## IMAG2   0     1    0     0      0     0
## IMAG3   0     1    0     0      0     0
## IMAG4   0     1    0     0      0     0
## IMAG5   0     1    0     0      0     0
## PERQ3   0     0    1     0      0     0
## PERQ4   0     0    1     0      0     0
## PERV1   0     0    0     1      0     0
## PERV2   0     0    0     1      0     0
## CUSA1   0     0    0     0      1     0
## CUSA2   0     0    0     0      1     0
## CUSA3   0     0    0     0      1     0
## CUSL1   0     0    0     0      0     1
## CUSL3   0     0    0     0      0     1</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="customer-satisfaction-and-loyalty.html#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimation of model</span></span>
<span id="cb320-2"><a href="customer-satisfaction-and-loyalty.html#cb320-2" aria-hidden="true" tabindex="-1"></a>epsi <span class="ot">&lt;-</span> <span class="fu">sempls</span>(<span class="at">model=</span>EPSI,<span class="at">data=</span>mobi)</span></code></pre></div>
<pre><code>## All 250 observations are valid.
## Converged after 5 iterations.
## Tolerance: 1e-07
## Scheme: centroid</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="customer-satisfaction-and-loyalty.html#cb322-1" aria-hidden="true" tabindex="-1"></a>epsi</span></code></pre></div>
<pre><code>##                     Path Estimate
## lam_1_1     EXP -&gt; CUEX1     0.79
## lam_1_2     EXP -&gt; CUEX2     0.58
## lam_1_3     EXP -&gt; CUEX3     0.68
## lam_2_1   IMAGE -&gt; IMAG1     0.74
## lam_2_2   IMAGE -&gt; IMAG2     0.57
## lam_2_3   IMAGE -&gt; IMAG3     0.61
## lam_2_4   IMAGE -&gt; IMAG4     0.79
## lam_2_5   IMAGE -&gt; IMAG5     0.73
## lam_3_1    QUAL -&gt; PERQ3     0.90
## lam_3_2    QUAL -&gt; PERQ4     0.85
## lam_4_1   VALUE -&gt; PERV1     0.90
## lam_4_2   VALUE -&gt; PERV2     0.94
## lam_5_1  SATISF -&gt; CUSA1     0.79
## lam_5_2  SATISF -&gt; CUSA2     0.84
## lam_5_3  SATISF -&gt; CUSA3     0.86
## lam_6_1   LOYAL -&gt; CUSL1     0.84
## lam_6_2   LOYAL -&gt; CUSL3     0.91
## beta_1_4    EXP -&gt; VALUE     0.11
## beta_2_4  IMAGE -&gt; VALUE     0.30
## beta_3_4   QUAL -&gt; VALUE     0.26
## beta_4_5 VALUE -&gt; SATISF     0.61
## beta_2_6  IMAGE -&gt; LOYAL     0.21
## beta_5_6 SATISF -&gt; LOYAL     0.51</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="customer-satisfaction-and-loyalty.html#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluation of estimated model</span></span>
<span id="cb324-2"><a href="customer-satisfaction-and-loyalty.html#cb324-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb324-3"><a href="customer-satisfaction-and-loyalty.html#cb324-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plsLoadings</span>(epsi)</span></code></pre></div>
<pre><code>##        EXP IMAGE QUAL VALUE SATISF LOYAL
## CUEX1 0.79     .    .     .      .     .
## CUEX2 0.58     .    .     .      .     .
## CUEX3 0.68     .    .     .      .     .
## IMAG1    .  0.74    .     .      .     .
## IMAG2    .  0.57    .     .      .     .
## IMAG3    .  0.61    .     .      .     .
## IMAG4    .  0.79    .     .      .     .
## IMAG5    .  0.73    .     .      .     .
## PERQ3    .     . 0.90     .      .     .
## PERQ4    .     . 0.85     .      .     .
## PERV1    .     .    .  0.90      .     .
## PERV2    .     .    .  0.94      .     .
## CUSA1    .     .    .     .   0.79     .
## CUSA2    .     .    .     .   0.84     .
## CUSA3    .     .    .     .   0.86     .
## CUSL1    .     .    .     .      .  0.84
## CUSL3    .     .    .     .      .  0.91</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="customer-satisfaction-and-loyalty.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Composite reliability</span></span>
<span id="cb326-2"><a href="customer-satisfaction-and-loyalty.html#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dgrho</span>(epsi)</span></code></pre></div>
<pre><code>##        Dillon-Goldstein&#39;s rho reflective MVs
## EXP                      0.73              3
## IMAGE                    0.82              5
## QUAL                     0.86              2
## VALUE                    0.92              2
## SATISF                   0.87              3
## LOYAL                    0.87              2</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="customer-satisfaction-and-loyalty.html#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AVE is average of communality for a construct</span></span>
<span id="cb328-2"><a href="customer-satisfaction-and-loyalty.html#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="fu">communality</span>(epsi)</span></code></pre></div>
<pre><code>##        communality reflective MVs
## EXP           0.47              3
## IMAGE         0.48              5
## QUAL          0.76              2
## VALUE         0.85              2
## SATISF        0.69              3
## LOYAL         0.77              2
## 
##  Average communality: 0.63</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="customer-satisfaction-and-loyalty.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="do">### check for discriminant validity using loadings. If the relative difference between a loading and a cross-loading</span></span>
<span id="cb330-2"><a href="customer-satisfaction-and-loyalty.html#cb330-2" aria-hidden="true" tabindex="-1"></a><span class="co"># is more than 0.2 the the cross-loading will be printed</span></span>
<span id="cb330-3"><a href="customer-satisfaction-and-loyalty.html#cb330-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-4"><a href="customer-satisfaction-and-loyalty.html#cb330-4" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span><span class="fu">plsLoadings</span>(epsi)</span>
<span id="cb330-5"><a href="customer-satisfaction-and-loyalty.html#cb330-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(l, <span class="at">type=</span><span class="st">&quot;discriminant&quot;</span>, <span class="at">cutoff=</span><span class="fl">0.5</span>, <span class="at">reldiff=</span><span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>##        EXP IMAGE QUAL VALUE SATISF LOYAL
## CUEX1 0.79     .    .     .      .     .
## CUEX2 0.58     .    .     .      .     .
## CUEX3 0.68     .    .     .      .     .
## IMAG1    .  0.74    .     .      .     .
## IMAG2    .  0.57    .     .      .     .
## IMAG3    .  0.61    .     .      .     .
## IMAG4    .  0.79    .     .      .     .
## IMAG5    .  0.73    .     .      .     .
## PERQ3    .     . 0.90     .      .     .
## PERQ4    .     . 0.85     .      .     .
## PERV1    .     .    .  0.90      .     .
## PERV2    .     .    .  0.94      .     .
## CUSA1    .     .    .     .   0.79     .
## CUSA2    .     .    .     .   0.84     .
## CUSA3    .     .    .     .   0.86     .
## CUSL1    .     .    .     .      .  0.84
## CUSL3    .     .    .     .      .  0.91</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="customer-satisfaction-and-loyalty.html#cb332-1" aria-hidden="true" tabindex="-1"></a>pC <span class="ot">&lt;-</span> <span class="fu">pathCoeff</span>(epsi)</span>
<span id="cb332-2"><a href="customer-satisfaction-and-loyalty.html#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pC,<span class="at">abbreviate=</span><span class="cn">TRUE</span>,<span class="at">minlength=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     EXP IMA QUA  VAL  SAT  LOY
## EXP   .   .   . 0.11    .    .
## IMA   .   .   . 0.30    . 0.21
## QUA   .   .   . 0.26    .    .
## VAL   .   .   .    . 0.61    .
## SAT   .   .   .    .    . 0.51
## LOY   .   .   .    .    .    .</code></pre>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="customer-satisfaction-and-loyalty.html#cb334-1" aria-hidden="true" tabindex="-1"></a>tE<span class="ot">&lt;-</span> <span class="fu">totalEffects</span>(epsi)</span>
<span id="cb334-2"><a href="customer-satisfaction-and-loyalty.html#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tE,<span class="at">abbreviate=</span><span class="cn">TRUE</span>,<span class="at">minlength=</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>##     EXP IMA QUA   VAL   SAT   LOY
## EXP   .   .   . 0.106 0.065 0.033
## IMA   .   .   . 0.296 0.180 0.298
## QUA   .   .   . 0.260 0.158 0.081
## VAL   .   .   .     . 0.610 0.312
## SAT   .   .   .     .     . 0.512
## LOY   .   .   .     .     .     .</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="customer-satisfaction-and-loyalty.html#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co">#R2</span></span>
<span id="cb336-2"><a href="customer-satisfaction-and-loyalty.html#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rSquared</span>(epsi)</span></code></pre></div>
<pre><code>##        R-squared
## EXP            .
## IMAGE          .
## QUAL           .
## VALUE       0.32
## SATISF      0.37
## LOYAL       0.45</code></pre>
<p>we still see that there are low <span class="math inline">\(R^2\)</span></p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="customer-satisfaction-and-loyalty.html#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Bootstrapping - estimation of standard errors</span></span>
<span id="cb338-2"><a href="customer-satisfaction-and-loyalty.html#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb338-3"><a href="customer-satisfaction-and-loyalty.html#cb338-3" aria-hidden="true" tabindex="-1"></a>epsiBoot <span class="ot">&lt;-</span> <span class="fu">bootsempls</span>(epsi,<span class="at">nboot=</span><span class="dv">500</span>,<span class="at">start=</span><span class="st">&quot;ones&quot;</span>,<span class="at">verbose=</span><span class="cn">FALSE</span>)</span>
<span id="cb338-4"><a href="customer-satisfaction-and-loyalty.html#cb338-4" aria-hidden="true" tabindex="-1"></a>epsiBoot</span></code></pre></div>
<pre><code>## Call: bootsempls(object = epsi, nboot = 500, start = &quot;ones&quot;, verbose = FALSE)
## 
##                 Estimate      Bias Std.Error
## EXP -&gt; CUEX1       0.787 -1.55e-02   0.07163
## EXP -&gt; CUEX2       0.583 -1.91e-02   0.14742
## EXP -&gt; CUEX3       0.682 -3.18e-03   0.10264
## IMAGE -&gt; IMAG1     0.737 -4.02e-03   0.04051
## IMAGE -&gt; IMAG2     0.569 -4.89e-03   0.06784
## IMAGE -&gt; IMAG3     0.607 -2.51e-03   0.06196
## IMAGE -&gt; IMAG4     0.790 -1.31e-03   0.03987
## IMAGE -&gt; IMAG5     0.730 -2.54e-03   0.04754
## QUAL -&gt; PERQ3      0.896  1.46e-05   0.02078
## QUAL -&gt; PERQ4      0.846 -2.84e-03   0.03756
## VALUE -&gt; PERV1     0.904 -2.08e-03   0.02118
## VALUE -&gt; PERV2     0.938  5.94e-04   0.00715
## SATISF -&gt; CUSA1    0.785 -3.18e-03   0.03452
## SATISF -&gt; CUSA2    0.845  3.41e-04   0.02307
## SATISF -&gt; CUSA3    0.864  1.32e-03   0.01645
## LOYAL -&gt; CUSL1     0.837 -3.22e-03   0.03913
## LOYAL -&gt; CUSL3     0.914 -6.55e-05   0.01073
## EXP -&gt; VALUE       0.106  1.60e-02   0.08455
## IMAGE -&gt; VALUE     0.296  7.13e-04   0.10320
## QUAL -&gt; VALUE      0.260 -8.88e-03   0.09773
## VALUE -&gt; SATISF    0.610 -1.23e-03   0.05526
## IMAGE -&gt; LOYAL     0.206  1.08e-02   0.07371
## SATISF -&gt; LOYAL    0.512 -6.88e-03   0.08686</code></pre>
<p>We see that again the relationship between EXP and VALUE is still very
low, perhaps one should drop the expectations.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="customer-satisfaction-and-loyalty.html#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Structural model coefficients</span></span>
<span id="cb340-2"><a href="customer-satisfaction-and-loyalty.html#cb340-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parallelplot</span>(epsiBoot,<span class="at">reflinesAt=</span><span class="dv">0</span>, <span class="at">alpha=</span><span class="fl">0.8</span>,</span>
<span id="cb340-3"><a href="customer-satisfaction-and-loyalty.html#cb340-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">varnames=</span><span class="fu">attr</span>(epsiBoot<span class="sc">$</span>t,<span class="st">&quot;path&quot;</span>)[<span class="dv">18</span><span class="sc">:</span><span class="dv">23</span>])</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-160-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="customer-satisfaction-and-loyalty.html#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Constructing observations</span></span>
<span id="cb341-2"><a href="customer-satisfaction-and-loyalty.html#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plsWeights</span>(epsi)</span></code></pre></div>
<pre><code>##        EXP IMAGE QUAL VALUE SATISF LOYAL
## CUEX1 0.56     .    .     .      .     .
## CUEX2 0.34     .    .     .      .     .
## CUEX3 0.52     .    .     .      .     .
## IMAG1    .  0.29    .     .      .     .
## IMAG2    .  0.23    .     .      .     .
## IMAG3    .  0.25    .     .      .     .
## IMAG4    .  0.36    .     .      .     .
## IMAG5    .  0.30    .     .      .     .
## PERQ3    .     . 0.62     .      .     .
## PERQ4    .     . 0.52     .      .     .
## PERV1    .     .    .  0.49      .     .
## PERV2    .     .    .  0.60      .     .
## CUSA1    .     .    .     .   0.35     .
## CUSA2    .     .    .     .   0.38     .
## CUSA3    .     .    .     .   0.47     .
## CUSL1    .     .    .     .      .  0.48
## CUSL3    .     .    .     .      .  0.65</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="customer-satisfaction-and-loyalty.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Standardised observations for  (constructs)</span></span>
<span id="cb343-2"><a href="customer-satisfaction-and-loyalty.html#cb343-2" aria-hidden="true" tabindex="-1"></a>epsi<span class="sc">$</span>factor_scores</span></code></pre></div>
<pre><code>##                 EXP        IMAGE        QUAL        VALUE      SATISF
##   [1,] -0.658301221 -1.949363685 -1.55684926 -2.195324010 -1.32184667
##   [2,]  1.704988931  1.630829659  1.44521531  1.855937388  1.37237187
##   [3,] -0.408794091 -1.010377934 -1.21411966  0.215032279 -0.10859055
##   [4,] -0.333710896  0.392506075  0.81475730 -0.878904460  1.90778446
##   [5,]  0.686617734  0.787436333  0.75975612 -0.331936091  0.94394863
##   [6,]  1.014608854  0.893700188  1.10248572  1.855937388 -0.10859055
##   [7,] -1.153914686 -1.010258477  0.15679870 -0.229933342  0.37332737
##   [8,] -2.790983560  0.446388894 -0.21343148 -0.229933342 -0.60811280
##   [9,] -0.408794091 -0.331570085 -0.87139007 -0.229933342 -0.39390118
##  [10,] -1.059932174 -0.264864511  0.12929811 -0.776901711 -1.35773701
##  [11,] -0.350652780 -0.076077609  0.12929811  0.215032279  0.24781908
##  [12,]  1.704988931  0.480052279  0.12929811 -0.229933342  0.10562107
##  [13,]  0.245744786  0.275410705 -0.21343148 -0.554418901  0.10562107
##  [14,]  1.954496061  1.957050821  1.44521531  0.539517838  0.94394863
##  [15,] -0.736785211  0.201958486  0.44452712 -1.546352891 -0.32280217
##  [16,] -0.603560704  0.759906758  0.78725671 -0.897381772 -0.03749154
##  [17,] -0.120044967  0.973228519  1.12998630  0.743523337  0.39093170
##  [18,] -1.102574963 -2.109522639 -0.89889066  0.215032279 -1.07242639
##  [19,]  0.877983552  0.949355974  0.78725671  0.437515089  0.92634429
##  [20,] -1.352082093 -0.909519517 -0.21343148  0.215032279 -0.16208522
##  [21,] -1.449465400  0.349903599  0.12929811  0.215032279  0.58753899
##  [22,]  0.126061369 -0.108959222  0.49952829 -0.878904460 -1.57194864
##  [23,] -0.791525728 -0.479284644 -0.21343148 -0.229933342 -0.92931377
##  [24,] -0.159286962 -0.035737557  0.12929811  1.308969018  0.37332737
##  [25,] -0.061903655 -0.614958218 -1.84457768 -1.323870081 -2.16085591
##  [26,]  0.761700930  1.957050821  1.44521531  0.762000648  1.47936122
##  [27,]  0.378969293  0.830269364  0.12929811  0.215032279 -0.53701379
##  [28,]  0.877983552 -2.399772575 -1.84457768  1.855937388 -0.53701379
##  [29,] -0.755684527 -0.227556375 -0.18593089  0.539517838 -0.10859055
##  [30,]  0.913824753  1.722398973  1.10248572  1.410971767  1.64007817
##  [31,] -0.564318709  0.092650436  0.44452712  1.086486208  0.65863800
##  [32,] -0.658301221 -0.479284644 -0.21343148 -0.878904460 -1.07242639
##  [33,] -1.027491768  1.028884304 -0.13092972  0.743523337 -0.28691183
##  [34,]  0.339727298  0.606667305  1.44521531  0.437515089  0.55233033
##  [35,]  0.997666969 -0.889950117 -1.84457768 -3.066777939 -2.85698545
##  [36,]  1.571764424  1.201866014 -0.44615872  0.437515089 -0.39390118
##  [37,] -0.101145650 -0.715207720 -0.24093206 -1.323870081 -1.46472636
##  [38,] -0.560917915 -0.505650167 -0.21343148 -0.656421650 -0.53701379
##  [39,] -0.061903655  0.208215673  1.10248572  1.308969018  0.99744330
##  [40,] -0.159286962 -0.343121612 -0.21343148  0.317035028 -0.10859055
##  [41,]  1.954496061  0.364487041  1.44521531  0.762000648  1.42586654
##  [42,]  0.476352599  0.429921387  0.47202770  0.437515089  0.42682204
##  [43,] -1.601589223  1.207880366  1.44521531  1.410971767  1.37237187
##  [44,] -0.061903655 -0.978487516  0.12929811 -1.101387271 -0.12619488
##  [45,]  1.069349371  1.722398973  1.44521531  1.410971767  1.90778446
##  [46,]  0.877983552  1.067463669  1.12998630  0.437515089  0.65863800
##  [47,]  0.686617734  0.134994008  0.47202770 -1.546352891 -0.32280217
##  [48,] -0.716442532 -0.283701618 -0.18593089  0.539517838  0.15911575
##  [49,] -0.680601332 -2.583372314 -2.58503803 -1.648355640 -1.91075394
##  [50,] -0.673799743 -1.133524987  1.10248572 -2.742292379 -1.30424234
##  [51,]  0.877983552  0.875471995  0.49952829 -0.452416152  0.80175061
##  [52,] -0.697543216 -0.110719909 -0.52866048 -0.554418901 -0.60811280
##  [53,]  0.054378967 -0.188977010  0.10179753  0.762000648  0.39093170
##  [54,]  1.072750165 -0.808052186  0.75975612  0.437515089 -0.10859055
##  [55,] -0.907808351 -0.344882299 -0.21343148  0.437515089 -0.32280217
##  [56,]  0.226845470 -0.556270516  0.15679870  0.437515089 -0.10859055
##  [57,] -0.542018598 -0.240490228 -1.50184808 -0.878904460 -2.30328684
##  [58,]  0.090220168  1.023848868  1.44521531  0.762000648  0.65863800
##  [59,]  1.072750165  1.048453705  0.44452712  1.086486208  1.47936122
##  [60,] -1.063332968 -0.283701618 -0.18593089 -0.331936091 -0.10859055
##  [61,] -0.829324361 -0.887527116 -1.18661908 -1.425872830 -1.58955297
##  [62,] -0.791525728 -0.328295335  0.15679870  0.215032279  0.17672008
##  [63,]  0.784001040  0.217261941  0.12929811  0.984483459  0.15911575
##  [64,] -0.506177398 -1.075203365 -2.84526586 -0.554418901 -0.82232442
##  [65,]  0.534493911 -0.607429802  0.12929811 -0.007450531 -0.66160747
##  [66,]  0.129462163  0.428160701  0.44452712 -1.221867332 -0.09098622
##  [67,]  0.761700930 -0.471093914  0.75975612  0.215032279  0.10562107
##  [68,]  0.378969293 -0.479284644 -0.18593089 -0.878904460 -2.76760043
##  [69,]  0.093620962  0.155591803 -0.21343148 -0.007450531  0.15911575
##  [70,]  0.187603475 -0.153552939  0.44452712 -0.331936091 -0.60811280
##  [71,] -0.159286962  0.368740707  0.44452712  0.215032279  0.44442638
##  [72,]  1.954496061  0.595617516  1.10248572  0.215032279  0.78323168
##  [73,]  0.512193800  0.845342264  1.44521531 -3.066777939  1.90778446
##  [74,] -1.001790863 -1.216414114 -1.21411966  0.215032279 -1.14352539
##  [75,]  1.260715189 -0.306302934 -0.18593089  0.215032279 -1.67917091
##  [76,] -0.519718488 -1.875775941 -0.87139007 -1.425872830 -0.87581910
##  [77,]  1.416239807 -0.287465826  0.12929811  0.762000648 -0.07270021
##  [78,] -1.637430424 -0.669342775 -1.55684926 -0.878904460 -0.37629685
##  [79,] -0.253269474 -0.031973349 -0.21343148 -0.331936091 -0.32280217
##  [80,] -0.217428273 -0.501885959 -0.21343148  0.215032279 -0.17968956
##  [81,]  0.975366859  0.659048341  1.10248572  0.215032279  0.58753899
##  [82,] -1.001790863  0.276681934  0.12929811  0.539517838 -0.48351912
##  [83,]  0.378969293  0.545486624  1.12998630  0.539517838  1.40826221
##  [84,] -0.658301221 -0.539194095  0.12929811 -0.007450531 -0.59050847
##  [85,] -0.003762344 -0.443860573 -0.18593089 -0.007450531 -0.37629685
##  [86,] -1.442663811  0.255841305  0.78725671 -0.127930592  0.03452207
##  [87,]  1.224873988  0.597378203  0.12929811  1.086486208  1.12295158
##  [88,]  1.108591366  0.775884807  0.78725671  1.308969018  0.42682204
##  [89,]  0.187603475  0.120776646 -0.18593089  0.539517838  0.65863800
##  [90,] -0.408794091  0.433685595  0.81475730  0.539517838  0.30222836
##  [91,]  0.378969293  1.009265426  1.10248572  0.762000648  0.67624233
##  [92,] -0.061903655 -0.289226513 -0.55616107 -0.007450531  0.10562107
##  [93,]  0.320827982  0.720229021  0.47202770  0.539517838  0.85524529
##  [94,] -0.813825839 -0.134226373  0.75975612  0.113029530 -0.17968956
##  [95,] -0.791525728 -2.705745954 -3.50322446 -1.425872830 -3.10640573
##  [96,]  0.531093116  1.457847949  0.49952829  1.410971767  0.90873996
##  [97,] -0.195128162  0.001081121  0.10179753  0.984483459  0.64103367
##  [98,] -0.350652780 -0.596610568 -0.52866048  0.215032279 -0.32280217
##  [99,] -1.099174169 -0.910008975 -0.52866048 -0.229933342 -0.10859055
## [100,]  0.090220168  1.029616597  1.44521531  0.215032279  0.85524529
## [101,] -0.195128162 -0.019150594  0.12929811  0.539517838 -0.53701379
## [102,]  0.129462163  0.215501254 -0.18593089  0.215032279  0.10562107
## [103,]  0.187603475 -0.351386109 -0.58366165  0.539517838  0.37332737
## [104,] -0.658301221 -0.805505806 -0.50115990 -0.007450531  0.51552538
## [105,]  0.284986781  1.139414105  0.44452712  0.762000648  0.72973700
## [106,] -1.116116053 -1.415588490  0.15679870 -0.878904460 -1.35773701
## [107,]  1.954496061 -0.663143286 -0.26843265  1.206966269  0.94394863
## [108,]  0.032078857  0.271646498  0.12929811 -0.674898962  0.64103367
## [109,] -0.516317693  1.086127920 -1.39184574  0.762000648  0.15911575
## [110,]  0.570335111  0.407320072  0.12929811  0.539517838  1.47936122
## [111,] -0.369552096 -0.806900413 -0.21343148 -0.229933342  0.39093170
## [112,]  0.975366859  1.066681898  0.10179753  0.864003398 -0.05509587
## [113,]  1.358098495  0.701391913  0.78725671  0.984483459  1.14055592
## [114,]  0.877983552  0.992797919  1.44521531  0.762000648  1.47936122
## [115,]  0.414810494  1.144449542  1.44521531  0.762000648  0.90873996
## [116,]  0.220043881  0.778134951 -2.18730727 -1.546352891 -1.07242639
## [117,] -1.751755614  1.013029633  0.78725671  1.855937388  1.33716321
## [118,]  1.954496061  1.957050821  0.41702653  0.762000648  0.72973700
## [119,]  1.571764424  0.854631366  1.12998630  1.308969018  0.64103367
## [120,]  0.823243035  1.611087402  0.12929811  0.762000648  1.33716321
## [121,]  1.224873988  0.657287654  0.44452712  0.539517838  0.28394235
## [122,]  0.226845470 -0.826346435 -1.15911849 -1.870838450 -1.49993503
## [123,]  1.455481802  1.957050821  1.44521531  1.855937388  1.90778446
## [124,] -0.427693408 -1.723392025 -0.87139007 -0.554418901 -1.30424234
## [125,] -0.639401905 -0.556270516 -2.47503569 -0.007450531 -0.53701379
## [126,] -0.253269474 -2.846528731  0.10179753 -0.878904460 -0.67921181
## [127,]  1.513623113  1.474924370  0.78725671  1.308969018  1.35476754
## [128,] -0.849667039 -0.399266856  0.12929811 -0.554418901  0.10562107
## [129,] -0.061903655 -0.575107624  0.15679870 -0.878904460 -0.87581910
## [130,] -0.159286962  0.332827178  0.12929811  0.215032279 -0.10859055
## [131,]  0.498652710 -0.844866942 -0.89889066  0.743523337 -0.16140354
## [132,]  0.148361479 -0.921963912 -0.87139007 -1.425872830 -1.35773701
## [133,] -2.025520287 -1.777287124 -2.15980668 -0.878904460 -1.64304764
## [134,]  0.457453283  1.219921351  1.44521531  1.206966269 -0.19729389
## [135,] -0.907808351  0.099327102  0.12929811 -0.007450531 -0.10859055
## [136,] -0.827366929  0.346139391  0.15679870  0.762000648  0.37332737
## [137,]  1.954496061  1.957050821  1.44521531  1.855937388  1.90778446
## [138,]  0.129462163  0.079827680  0.81475730  0.317035028  0.94394863
## [139,]  0.917225547  0.968193082  1.12998630 -0.470893463  1.64007817
## [140,]  0.570335111  0.326812826  0.12929811  1.188488957  0.37332737
## [141,]  0.284986781  1.470670704  1.12998630  0.335512340  0.92634429
## [142,]  0.129462163  0.349903599  0.44452712  0.215032279  0.10562107
## [143,] -1.757113841 -1.255482936 -0.87139007 -1.101387271 -1.92835827
## [144,]  0.414810494  1.069956648 -0.21343148 -0.572896213  0.37332737
## [145,]  1.954496061  1.957050821  1.44521531  1.855937388  1.90778446
## [146,]  0.877983552 -0.925497566  0.78725671  1.308969018  0.94394863
## [147,] -0.661702015 -1.678308851 -2.50253627 -1.203390020 -1.91075394
## [148,] -1.695571735 -0.406552437  0.12929811 -0.007450531  0.10562107
## [149,] -2.120946161 -1.455076793 -0.89889066 -0.878904460 -0.01920553
## [150,]  0.913824753  0.311324234 -0.52866048 -0.229933342 -0.16208522
## [151,]  0.877983552  1.025852389  1.12998630  0.762000648  0.44442638
## [152,]  0.378969293  0.332827178  0.12929811 -0.229933342  0.37332737
## [153,] -0.333710896  0.857490425 -0.89889066 -1.444350142 -0.48351912
## [154,]  1.954496061 -0.809405673  1.44521531  0.743523337  0.81935494
## [155,]  0.531093116 -0.060099559  0.47202770 -0.007450531  0.10562107
## [156,]  0.975366859  0.215501254  0.12929811 -0.007450531 -0.17968956
## [157,]  0.378969293 -0.554266995 -2.44753510  0.215032279 -0.10859055
## [158,] -0.506177398  0.971957290  0.12929811  0.762000648  0.65863800
## [159,] -1.813297720 -1.877536627 -0.55616107 -0.776901711 -0.66160747
## [160,]  0.534493911  0.176921889 -0.52866048  0.335512340  0.15911575
## [161,]  0.281585987  0.992797919  0.12929811  0.539517838 -0.10859055
## [162,]  0.187603475 -0.245122254  0.12929811 -0.554418901 -0.12619488
## [163,]  0.129462163  0.463465315  0.78725671  0.317035028  0.92634429
## [164,] -0.600159910 -1.556436948  0.10179753 -0.211456030 -1.66133366
## [165,]  0.913824753  0.146792158 -1.87207826 -2.844295129 -2.03626222
## [166,] -0.473736991  0.643732606  0.07429694 -0.229933342  0.90873996
## [167,]  1.260715189  1.453594283  1.44521531  0.215032279  0.37332737
## [168,]  0.223444675 -0.958379180  0.12929811  0.317035028 -0.87581910
## [169,] -1.546848706  0.563834274  0.12929811  0.094552218 -0.32280217
## [170,] -0.022661660 -1.357439726 -1.18661908 -0.229933342 -0.32280217
## [171,] -0.007163138 -0.847849379 -0.52866048 -0.331936091 -0.87581910
## [172,]  0.877983552 -0.941706169  0.81475730  1.855937388  0.90873996
## [173,] -0.408794091  0.059106508  0.44452712  0.539517838  0.15911575
## [174,]  0.187603475 -0.883153994 -0.52866048 -0.878904460 -1.19702007
## [175,]  0.628476423  1.353834238  0.78725671  0.094552218  1.15816025
## [176,]  0.913824753  0.484305944  0.12929811  0.437515089  0.67624233
## [177,] -0.061903655  0.558971695  0.78725671  1.855937388  1.12295158
## [178,]  1.033508170  0.196664146  0.15679870  0.215032279  0.31983269
## [179,]  0.339727298 -0.479284644 -0.52866048  0.215032279  0.53404432
## [180,]  0.129462163  0.375660208 -2.24230844 -0.007450531 -0.10859055
## [181,]  0.148361479  0.211737046 -0.18593089 -0.331936091 -0.10859055
## [182,] -1.027491768 -0.516103322 -2.15980668 -1.852361139 -1.09003072
## [183,]  1.380398606  1.573413186  0.44452712  0.094552218  0.15911575
## [184,]  0.378969293  0.332827178  0.12929811  0.762000648  0.10562107
## [185,] -1.254698787 -0.579534146 -1.15911849 -0.331936091 -1.66065197
## [186,]  1.455481802  1.705322552  1.44521531  1.855937388  1.90778446
## [187,] -0.603560704 -0.074806380  0.75975612  0.762000648 -0.05509587
## [188,] -3.413082031 -0.986994847 -2.53003686 -3.066777939 -2.64277382
## [189,] -1.254698787 -0.698863592 -1.18661908 -0.554418901 -0.87581910
## [190,]  0.281585987  0.640211233  0.12929811  0.215032279 -0.10859055
## [191,]  1.704988931  0.110985805 -1.10411732 -1.768835701  1.08706124
## [192,]  0.512193800  1.957050821  1.44521531  1.188488957  0.83672635
## [193,]  0.917225547  1.070446106  1.12998630 -0.007450531  0.80175061
## [194,]  1.954496061 -0.155174179  1.10248572  1.531451828  0.87284962
## [195,] -0.600159910 -0.175664797 -0.21343148 -0.776901711 -0.89342343
## [196,]  0.573735906 -1.147446115 -0.21343148 -0.878904460 -1.10763505
## [197,]  1.954496061  0.901117506  1.44521531  0.743523337  1.90778446
## [198,]  1.954496061  0.875471995  0.75975612  1.855937388  1.37237187
## [199,]  0.129462163 -0.188977010 -0.18593089 -0.554418901 -0.37629685
## [200,]  1.166732677  0.447660123  0.10179753 -0.007450531  0.94394863
## [201,]  0.378969293 -0.050810457  0.47202770 -0.229933342  0.42682204
## [202,] -0.217428273  0.159356010  0.78725671  0.437515089  1.05185258
## [203,] -0.311410785 -1.507038349 -0.81638890 -1.425872830  0.37332737
## [204,] -0.888909034 -2.066932444 -0.87139007 -1.323870081 -1.35773701
## [205,] -0.061903655  0.348805227 -0.52866048 -0.878904460 -0.05509587
## [206,] -1.235799470 -1.712342236  0.15679870  0.215032279 -1.69654232
## [207,]  0.570335111  0.585826676  0.78725671  1.308969018  0.35572304
## [208,] -0.120044967  0.159845468 -0.52866048  0.864003398  1.10466557
## [209,] -0.677200537  0.619370604 -0.21343148  0.215032279 -0.17968956
## [210,] -0.736785211 -0.383045972  0.81475730  1.206966269  0.90873996
## [211,] -0.159286962 -0.750755170 -1.21411966  0.215032279 -0.64400314
## [212,] -0.408794091  0.371406543 -0.21343148  0.215032279 -0.39390118
## [213,] -0.986292341 -0.538095723 -0.89889066 -0.999384521 -0.80472009
## [214,] -0.849667039 -0.228045833 -0.87139007  1.086486208  0.15911575
## [215,] -1.695571735 -1.021320546 -0.50115990 -0.109453281 -1.16112972
## [216,] -2.483335119 -0.882895090 -1.24162025 -1.221867332 -0.21557990
## [217,] -1.406822610  0.716464813 -0.18593089  0.762000648 -0.12619488
## [218,]  0.975366859  0.780138472  0.44452712 -0.878904460  0.87284962
## [219,]  0.320827982  0.025443123  0.12929811 -0.331936091  0.58753899
## [220,] -3.212957192 -3.399750081 -3.50322446 -1.972841200 -2.90979844
## [221,] -0.408794091 -1.013302673  0.75975612 -0.878904460 -0.71510215
## [222,]  0.013179540  0.664083777  0.75975612  0.317035028  0.44442638
## [223,] -0.061903655  0.837554945  1.10248572  0.215032279  0.37332737
## [224,] -0.752283733 -0.052813978 -0.21343148 -1.323870081 -0.80472009
## [225,]  0.324228776 -0.657128933 -0.52866048 -1.101387271  0.62342933
## [226,]  0.148361479  0.838826173  0.12929811 -0.109453281 -0.10859055
## [227,] -1.005191657 -0.686908654 -0.52866048 -2.093321261 -1.21462440
## [228,]  0.262686670  1.375337182  0.44452712  0.437515089  0.85524529
## [229,] -0.849667039 -0.406552437 -0.21343148 -1.870838450 -0.37629685
## [230,]  1.954496061  1.957050821  1.44521531  1.855937388  1.90778446
## [231,] -2.250769874 -1.003754667 -1.55684926 -1.101387271 -1.64304764
## [232,] -0.369552096 -0.019150594  0.12929811  0.094552218  0.01600313
## [233,] -0.178186278  0.662985405  1.10248572  1.308969018  0.87284962
## [234,] -0.560917915 -0.483048852 -0.87139007  0.762000648 -0.39390118
## [235,] -0.603560704 -2.545714167 -2.21480785 -0.999384521 -1.14352539
## [236,] -0.907808351 -0.633429246 -0.52866048  0.215032279 -0.96452243
## [237,] -0.888909034 -1.183849101 -0.87139007 -0.229933342 -0.32280217
## [238,] -0.120044967 -0.534940430 -0.87139007 -0.776901711 -0.37629685
## [239,] -0.022661660 -0.670005089 -2.18730727  0.113029530 -1.55434431
## [240,] -0.755684527 -0.400538085 -0.18593089 -0.229933342  0.37332737
## [241,] -0.875367944  1.380862076  1.44521531  0.437515089  1.62247383
## [242,]  1.954496061 -2.415965110  1.10248572 -3.066777939  0.14082973
## [243,] -1.367580615  0.717978876  0.75975612 -0.878904460  1.47936122
## [244,]  1.455481802  1.470670704  0.81475730  0.094552218  0.69452834
## [245,] -1.601589223 -0.981762266  0.49952829 -0.433938840 -0.60811280
## [246,] -0.408794091 -0.982741182 -0.84388949  0.094552218 -1.71414665
## [247,]  1.166732677  0.037603564  1.10248572 -0.878904460  0.65863800
## [248,]  0.129462163 -0.192132304 -0.55616107  0.762000648  0.15911575
## [249,] -0.600159910 -0.093643487 -0.55616107 -0.878904460 -0.53701379
## [250,]  0.324228776  0.989033711  0.81475730  0.419037777  0.08801674
##              LOYAL
##   [1,] -0.75409297
##   [2,]  1.14853353
##   [3,] -0.46039135
##   [4,]  1.14853353
##   [5,]  0.56113029
##   [6,]  1.14853353
##   [7,]  0.01526528
##   [8,] -0.34864473
##   [9,] -0.46039135
##  [10,] -0.02627295
##  [11,]  0.56113029
##  [12,] -1.22974959
##  [13,]  0.01526528
##  [14,]  1.14853353
##  [15,]  0.23875851
##  [16,]  0.37917528
##  [17,]  1.14853353
##  [18,] -2.18106284
##  [19,]  0.96657852
##  [20,] -0.39018296
##  [21,]  0.49092190
##  [22,] -1.00625636
##  [23,] -0.27843634
##  [24,]  0.49092190
##  [25,] -2.76846608
##  [26,]  1.14853353
##  [27,] -0.27843634
##  [28,]  0.56113029
##  [29,]  0.37917528
##  [30,]  1.14853353
##  [31,]  0.78462352
##  [32,] -1.52345121
##  [33,]  1.14853353
##  [34,]  0.56113029
##  [35,] -3.13237609
##  [36,]  0.01526528
##  [37,] -2.47476446
##  [38,] -0.20822796
##  [39,]  0.85483191
##  [40,]  0.85483191
##  [41,]  0.78462352
##  [42,]  0.37917528
##  [43,]  1.14853353
##  [44,]  0.12701189
##  [45,]  0.78462352
##  [46,] -2.04064606
##  [47,] -0.64234635
##  [48,]  0.19722028
##  [49,] -1.70540622
##  [50,] -0.82430136
##  [51,]  0.56113029
##  [52,] -0.46039135
##  [53,]  0.60266852
##  [54,]  0.19722028
##  [55,] -0.27843634
##  [56,] -0.27843634
##  [57,] -1.22974959
##  [58,]  0.19722028
##  [59,]  1.14853353
##  [60,] -0.86583958
##  [61,] -1.15954120
##  [62,]  0.19722028
##  [63,]  0.30896690
##  [64,] -0.02627295
##  [65,] -2.36301785
##  [66,] -0.75409297
##  [67,] -0.57213796
##  [68,] -2.25127123
##  [69,]  0.37917528
##  [70,]  0.01526528
##  [71,]  0.30896690
##  [72,] -0.34864473
##  [73,] -3.13237609
##  [74,] -0.86583958
##  [75,] -0.31997457
##  [76,] -0.39018296
##  [77,]  0.49092190
##  [78,]  0.56113029
##  [79,]  0.19722028
##  [80,]  0.19722028
##  [81,]  0.78462352
##  [82,]  0.37917528
##  [83,]  1.14853353
##  [84,] -0.57213796
##  [85,] -0.68388458
##  [86,] -0.50192958
##  [87,]  1.14853353
##  [88,]  0.56113029
##  [89,]  1.14853353
##  [90,]  0.49092190
##  [91,]  0.56113029
##  [92,] -0.16668973
##  [93,]  0.85483191
##  [94,] -0.68388458
##  [95,] -3.13237609
##  [96,]  0.85483191
##  [97,]  0.67287690
##  [98,]  0.01526528
##  [99,] -0.86583958
## [100,]  0.60266852
## [101,] -0.68388458
## [102,] -0.27843634
## [103,]  0.96657852
## [104,] -0.34864473
## [105,]  1.14853353
## [106,] -0.64234635
## [107,]  0.19722028
## [108,]  0.49092190
## [109,]  1.14853353
## [110,]  1.14853353
## [111,]  0.37917528
## [112,]  0.85483191
## [113,]  1.14853353
## [114,]  1.14853353
## [115,]  0.78462352
## [116,]  0.49092190
## [117,]  1.14853353
## [118,]  1.14853353
## [119,]  0.26742867
## [120,]  0.56113029
## [121,] -0.46039135
## [122,] -1.49478105
## [123,]  1.14853353
## [124,]  0.19722028
## [125,] -0.39018296
## [126,] -2.06931623
## [127,]  0.85483191
## [128,] -0.09648134
## [129,] -1.07646475
## [130,]  0.01526528
## [131,]  0.56113029
## [132,] -1.41170460
## [133,]  1.14853353
## [134,]  0.56113029
## [135,] -0.09648134
## [136,]  1.14853353
## [137,]  1.14853353
## [138,]  0.78462352
## [139,]  0.30896690
## [140,]  0.56113029
## [141,]  0.78462352
## [142,]  1.14853353
## [143,] -0.93604797
## [144,]  0.56113029
## [145,]  1.14853353
## [146,] -0.12515150
## [147,] -1.52345121
## [148,] -0.27843634
## [149,] -1.22974959
## [150,]  1.14853353
## [151,]  1.14853353
## [152,]  0.19722028
## [153,]  0.96657852
## [154,]  1.14853353
## [155,] -0.27843634
## [156,] -0.09648134
## [157,] -1.07646475
## [158,]  0.56113029
## [159,] -0.71255474
## [160,]  0.37917528
## [161,]  0.56113029
## [162,]  0.26742867
## [163,]  0.96657852
## [164,] -1.04779459
## [165,]  1.14853353
## [166,] -1.22974959
## [167,]  1.14853353
## [168,]  0.08547366
## [169,]  0.19722028
## [170,]  0.01526528
## [171,] -0.39018296
## [172,]  1.14853353
## [173,]  0.49092190
## [174,] -0.64234635
## [175,] -0.48906151
## [176,] -1.22974959
## [177,]  0.05680350
## [178,]  0.37917528
## [179,]  1.14853353
## [180,] -0.64234635
## [181,] -0.09648134
## [182,] -0.39018296
## [183,]  1.14853353
## [184,] -1.00625636
## [185,] -1.11800298
## [186,]  1.14853353
## [187,]  0.37917528
## [188,] -0.46039135
## [189,] -0.86583958
## [190,]  0.56113029
## [191,]  0.56113029
## [192,] -0.48906151
## [193,] -0.48906151
## [194,]  1.14853353
## [195,] -1.22974959
## [196,] -0.57213796
## [197,]  1.14853353
## [198,]  1.14853353
## [199,]  0.85483191
## [200,]  0.49092190
## [201,] -0.78276313
## [202,]  0.56113029
## [203,] -0.16668973
## [204,]  0.19722028
## [205,]  0.56113029
## [206,] -3.13237609
## [207,]  1.14853353
## [208,]  0.78462352
## [209,]  0.37917528
## [210,]  0.23875851
## [211,] -0.68388458
## [212,] -1.37016637
## [213,] -0.09648134
## [214,]  0.37917528
## [215,] -1.04779459
## [216,] -1.95756961
## [217,]  1.14853353
## [218,]  0.67287690
## [219,]  0.67287690
## [220,] -2.54497285
## [221,] -0.86583958
## [222,]  1.14853353
## [223,]  0.67287690
## [224,] -0.27843634
## [225,] -0.12515150
## [226,]  0.26742867
## [227,] -1.41170460
## [228,]  0.37917528
## [229,] -0.68388458
## [230,]  1.14853353
## [231,] -2.36301785
## [232,] -1.22974959
## [233,]  0.56113029
## [234,] -0.09648134
## [235,] -1.22974959
## [236,] -0.27843634
## [237,]  0.37917528
## [238,] -0.71255474
## [239,] -2.95042109
## [240,] -0.23689812
## [241,]  1.14853353
## [242,]  1.14853353
## [243,]  1.14853353
## [244,]  1.14853353
## [245,]  0.01526528
## [246,] -1.95756961
## [247,] -0.05494311
## [248,]  0.01526528
## [249,] -0.27843634
## [250,]  1.14853353
## attr(,&quot;scaled:center&quot;)
##           EXP         IMAGE          QUAL         VALUE        SATISF 
## -7.435719e-17 -3.844147e-17 -1.184608e-16 -4.979350e-17 -2.037259e-16 
##         LOYAL 
## -5.889733e-17 
## attr(,&quot;scaled:scale&quot;)
##       EXP     IMAGE      QUAL     VALUE    SATISF     LOYAL 
## 0.5230488 1.4692068 0.7579182 1.0143180 1.4925016 1.0023920</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="customer-satisfaction-and-loyalty.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(epsi)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-160-2.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="customer-satisfaction-and-loyalty.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(epsi,<span class="at">use=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-160-3.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="customer-satisfaction-and-loyalty.html#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Unstandardised solution</span></span>
<span id="cb347-2"><a href="customer-satisfaction-and-loyalty.html#cb347-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-3"><a href="customer-satisfaction-and-loyalty.html#cb347-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-4"><a href="customer-satisfaction-and-loyalty.html#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get unstandardized LV</span></span>
<span id="cb347-5"><a href="customer-satisfaction-and-loyalty.html#cb347-5" aria-hidden="true" tabindex="-1"></a>unstandardized_LV <span class="ot">&lt;-</span> <span class="cf">function</span>(data, sempls_model){</span>
<span id="cb347-6"><a href="customer-satisfaction-and-loyalty.html#cb347-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save object to hold outer weights which will be scaled in loop</span></span>
<span id="cb347-7"><a href="customer-satisfaction-and-loyalty.html#cb347-7" aria-hidden="true" tabindex="-1"></a>  outer_weights_resc <span class="ot">&lt;-</span> sempls_model<span class="sc">$</span>outer_weights</span>
<span id="cb347-8"><a href="customer-satisfaction-and-loyalty.html#cb347-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Find standard deviation of indicators</span></span>
<span id="cb347-9"><a href="customer-satisfaction-and-loyalty.html#cb347-9" aria-hidden="true" tabindex="-1"></a>  std_indicators <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">lapply</span>(data, <span class="at">FUN =</span> sd))</span>
<span id="cb347-10"><a href="customer-satisfaction-and-loyalty.html#cb347-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (lv <span class="cf">in</span> <span class="fu">colnames</span>(sempls_model<span class="sc">$</span>model<span class="sc">$</span>M)) {</span>
<span id="cb347-11"><a href="customer-satisfaction-and-loyalty.html#cb347-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check estimation mode of LV</span></span>
<span id="cb347-12"><a href="customer-satisfaction-and-loyalty.html#cb347-12" aria-hidden="true" tabindex="-1"></a>    mode <span class="ot">&lt;-</span> <span class="fu">attr</span>(sempls_model<span class="sc">$</span>model<span class="sc">$</span>blocks[[lv]], <span class="st">&quot;mode&quot;</span>)</span>
<span id="cb347-13"><a href="customer-satisfaction-and-loyalty.html#cb347-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (mode <span class="sc">==</span> <span class="st">&quot;A&quot;</span>) {</span>
<span id="cb347-14"><a href="customer-satisfaction-and-loyalty.html#cb347-14" aria-hidden="true" tabindex="-1"></a>      tmp_indicator_names <span class="ot">&lt;-</span> sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[,<span class="dv">1</span>]<span class="sc">==</span>lv,<span class="dv">2</span>]</span>
<span id="cb347-15"><a href="customer-satisfaction-and-loyalty.html#cb347-15" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb347-16"><a href="customer-satisfaction-and-loyalty.html#cb347-16" aria-hidden="true" tabindex="-1"></a>      tmp_indicator_names <span class="ot">&lt;-</span> sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[sempls_model<span class="sc">$</span>model<span class="sc">$</span>measuremod[,<span class="dv">2</span>]<span class="sc">==</span>lv,<span class="dv">1</span>]  </span>
<span id="cb347-17"><a href="customer-satisfaction-and-loyalty.html#cb347-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb347-18"><a href="customer-satisfaction-and-loyalty.html#cb347-18" aria-hidden="true" tabindex="-1"></a>    tmp_weights <span class="ot">&lt;-</span> outer_weights_resc[tmp_indicator_names,lv]</span>
<span id="cb347-19"><a href="customer-satisfaction-and-loyalty.html#cb347-19" aria-hidden="true" tabindex="-1"></a>    tmp_weights <span class="ot">&lt;-</span> tmp_weights<span class="sc">/</span>std_indicators[tmp_indicator_names]</span>
<span id="cb347-20"><a href="customer-satisfaction-and-loyalty.html#cb347-20" aria-hidden="true" tabindex="-1"></a>    outer_weights_resc[tmp_indicator_names,lv] <span class="ot">&lt;-</span> tmp_weights<span class="sc">/</span><span class="fu">sum</span>(tmp_weights)</span>
<span id="cb347-21"><a href="customer-satisfaction-and-loyalty.html#cb347-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-22"><a href="customer-satisfaction-and-loyalty.html#cb347-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb347-23"><a href="customer-satisfaction-and-loyalty.html#cb347-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data as matrix in order to perform matrix multiplication</span></span>
<span id="cb347-24"><a href="customer-satisfaction-and-loyalty.html#cb347-24" aria-hidden="true" tabindex="-1"></a>  data_mat <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(data[,<span class="fu">rownames</span>(outer_weights_resc)])</span>
<span id="cb347-25"><a href="customer-satisfaction-and-loyalty.html#cb347-25" aria-hidden="true" tabindex="-1"></a>  unstandardized_LV <span class="ot">&lt;-</span> data_mat <span class="sc">%*%</span> outer_weights_resc</span>
<span id="cb347-26"><a href="customer-satisfaction-and-loyalty.html#cb347-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(unstandardized_LV)</span>
<span id="cb347-27"><a href="customer-satisfaction-and-loyalty.html#cb347-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb347-28"><a href="customer-satisfaction-and-loyalty.html#cb347-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-29"><a href="customer-satisfaction-and-loyalty.html#cb347-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Unstandardized LV</span></span>
<span id="cb347-30"><a href="customer-satisfaction-and-loyalty.html#cb347-30" aria-hidden="true" tabindex="-1"></a>LV_unstand <span class="ot">&lt;-</span> <span class="fu">unstandardized_LV</span>(<span class="at">data =</span> mobi, <span class="at">sempls_model =</span> epsi)</span>
<span id="cb347-31"><a href="customer-satisfaction-and-loyalty.html#cb347-31" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(LV_unstand)</span></code></pre></div>
<pre><code>##           EXP    IMAGE      QUAL     VALUE    SATISF     LOYAL
## [1,] 6.683271 5.189807  5.437305  2.593244  5.790523  6.000000
## [2,] 9.683271 9.598305 10.000000 10.000000  9.302147 10.000000
## [3,] 7.000000 6.346034  5.958203  7.000000  7.371872  6.617466
## [4,] 7.095312 8.073486  9.041797  5.000000 10.000000 10.000000
## [5,] 8.390534 8.559786  8.958203  6.000000  8.743744  8.765069
## [6,] 8.806891 8.690635  9.479102 10.000000  7.371872 10.000000</code></pre>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="customer-satisfaction-and-loyalty.html#cb349-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LV_unstand[,<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-160-4.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="customer-satisfaction-and-loyalty.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(LV_unstand,<span class="at">pch=</span><span class="dv">19</span>,<span class="at">cex=</span><span class="fl">0.7</span>,<span class="at">cex.axis=</span><span class="fl">0.8</span>,<span class="at">col.axis=</span><span class="st">&quot;gray70&quot;</span>,<span class="at">gap=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-160-5.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="customer-satisfaction-and-loyalty.html#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(LV_unstand)</span></code></pre></div>
<pre><code>##       EXP             IMAGE             QUAL            VALUE       
##  Min.   : 3.186   Min.   : 3.404   Min.   : 2.479   Min.   : 1.000  
##  1st Qu.: 6.683   1st Qu.: 6.835   1st Qu.: 7.000   1st Qu.: 5.568  
##  Median : 7.525   Median : 7.650   Median : 8.000   Median : 7.000  
##  Mean   : 7.519   Mean   : 7.590   Mean   : 7.803   Mean   : 6.607  
##  3rd Qu.: 8.299   3rd Qu.: 8.474   3rd Qu.: 8.990   3rd Qu.: 7.966  
##  Max.   :10.000   Max.   :10.000   Max.   :10.000   Max.   :10.000  
##      SATISF           LOYAL       
##  Min.   : 3.465   Min.   : 1.000  
##  1st Qu.: 6.813   1st Qu.: 6.419  
##  Median : 7.640   Median : 8.000  
##  Mean   : 7.513   Mean   : 7.585  
##  3rd Qu.: 8.389   3rd Qu.: 9.235  
##  Max.   :10.000   Max.   :10.000</code></pre>
</div>
</div>
<div id="segmentation-clustering" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Segmentation (Clustering)</h2>
<div id="what-is-clustering" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> What is clustering</h3>
<p>Basically what we aim to do, is separate e.g., customers into a given amount of groups.</p>
<p>We have the following measures:</p>
<ol style="list-style-type: decimal">
<li>Between-cluster variation: this is from one center to other cluster centers, we want to maximize this.</li>
<li>Within-cluster variation: this is the distance from the center of the clusters to the center.</li>
</ol>
</div>
<div id="clustering-techniques" class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Clustering techniques</h3>
<p>There are many techniques and no one size fits all.</p>
<p>We are gogin to focus on:</p>
<ol style="list-style-type: decimal">
<li>Hierarchical algorithms, and</li>
<li>Partitioning algorithsm, and main focus on</li>
<li>K-means, as this is the most widely used.</li>
</ol>
<p><strong>K-means advantages and disadvantages</strong></p>
<ul>
<li>Advantages:
<ul>
<li>Relatively efficient</li>
<li>Better than most hierarchical methods at handling noisy data and outliers</li>
</ul></li>
<li>Disadvantges
<ul>
<li>Need to specify k, the number of clusters in advance</li>
<li>In small samples, results depend strongly on initial cluster centers</li>
<li>In principle k-means works only with continuous variables</li>
<li>it will always create the amount of groups, hence it is a good idea to see if you can visualize the data</li>
</ul></li>
</ul>
</div>
<div id="an-example-with-hbat" class="section level3" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> An example with HBAT</h3>
<div id="background" class="section level4" number="2.5.3.1">
<h4><span class="header-section-number">2.5.3.1</span> 1. Background</h4>
<p>The dataset for this case study is from Hair et al.2010, Multivariate Data Analysis, Pearson Education.</p>
<p>HBAT is a manufacturer of paper products who sells products to two market segments: the newsprint industry and the magazine industry.The current market is very competitive, so the manufacturer wants to understand how its customers perceive the company and make purchasing decisions, in order to enforce customers’ loyalty. The manufacturer commissioned a study asking its customers to complete a questionnaire on a secure website. In total,100 customers (purchasing managers from different firms) buying from HBAT completed the questionnaire. The data consist of three main pieces of information:</p>
<ol style="list-style-type: decimal">
<li><p>A 1st type of information is available from HBAT’s data warehouse and includes information, such as: customer type in terms of length of purchase relationship(x1), industry type(x2), size of the customer(x3), region of the customer(x4) and distribution system(X5).</p></li>
<li><p>The 2nd type of information is collected based on the online questionnaire and includes customers’ perceptions of HBAT ́s performance on 13 attributes using a continuous 0-10 line scale with 10 being “Excellent” and 0 being “Poor”. The 13 attributes are:</p></li>
</ol>
<ul>
<li>X6 Product quality</li>
<li>X7 E-commerce</li>
<li>X8 Technical support</li>
<li>X9 Complaint resolution</li>
<li>X10 Advertising</li>
<li>X11 Product line</li>
<li>X12 Salesforce image</li>
<li>X13 Competitive pricing</li>
<li>X14 Warranty and claims</li>
<li>X15 Packaging</li>
<li>X16 Order and billing</li>
<li>X17 Price flexibility</li>
<li>X18 Delivery speed</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>The 3rd type of information relates to purchase outcomes and business relationships:</li>
</ol>
<ul>
<li>satisfaction with HBAT, future purchase intention, etc (X19-X22)</li>
<li>whether the firm would consider a strategic alliance/partnership with HBAT (X23).</li>
</ul>
<div id="the-primary-objective-is" class="section level5" number="2.5.3.1.1">
<h5><span class="header-section-number">2.5.3.1.1</span> 1.1. The primary objective is:</h5>
<ul>
<li>to develop a taxonomy that segments the customers into groups with similar perceptions. Once identified, separate strategies with different appeals can be formulated for each segment. In addition to forming a taxonomy of customers that can be used for market segmentation, cluster analysis also facilitates data simplification (each segment is used to define the basic character of segment members) and identification of relationships (e.g. for estimating the impact of customers perceptions on sales in each segment, enabling the analyst to understant what uniquely impacts each segment rather than the sample as a whole).</li>
</ul>
</div>
</div>
<div id="the-data-data-understanding-phase" class="section level4" number="2.5.3.2">
<h4><span class="header-section-number">2.5.3.2</span> 2. The data (Data Understanding Phase)</h4>
<div id="load-data-correctly" class="section level5" number="2.5.3.2.1">
<h5><span class="header-section-number">2.5.3.2.1</span> 2.1 Load data correctly</h5>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="customer-satisfaction-and-loyalty.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb353-2"><a href="customer-satisfaction-and-loyalty.html#cb353-2" aria-hidden="true" tabindex="-1"></a>HBAT <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(<span class="at">file =</span> <span class="st">&quot;Data/Clustering/HBAT.sav&quot;</span>, <span class="at">to.data.frame=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="check-if-the-data-is-numerical-or-categorical" class="section level5" number="2.5.3.2.2">
<h5><span class="header-section-number">2.5.3.2.2</span> 2.2 Check if the data is numerical or categorical</h5>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="customer-satisfaction-and-loyalty.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(HBAT)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    100 obs. of  24 variables:
##  $ id : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ x1 : Factor w/ 3 levels &quot;Less than 1 year&quot;,..: 2 3 3 1 2 1 1 2 2 1 ...
##  $ x2 : Factor w/ 2 levels &quot;Magazine industry&quot;,..: 1 2 1 2 1 2 2 1 2 1 ...
##  $ x3 : Factor w/ 2 levels &quot;Small (0 to 499)&quot;,..: 2 1 2 2 2 1 2 2 2 2 ...
##  $ x4 : Factor w/ 2 levels &quot;USA/North America&quot;,..: 2 1 2 2 1 2 2 2 2 2 ...
##  $ x5 : Factor w/ 2 levels &quot;Indirect through broker&quot;,..: 2 1 2 1 2 1 1 1 1 1 ...
##  $ x6 : num  8.5 8.2 9.2 6.4 9 6.5 6.9 6.2 5.8 6.4 ...
##  $ x7 : num  3.9 2.7 3.4 3.3 3.4 2.8 3.7 3.3 3.6 4.5 ...
##  $ x8 : num  2.5 5.1 5.6 7 5.2 3.1 5 3.9 5.1 5.1 ...
##  $ x9 : num  5.9 7.2 5.6 3.7 4.6 4.1 2.6 4.8 6.7 6.1 ...
##  $ x10: num  4.8 3.4 5.4 4.7 2.2 4 2.1 4.6 3.7 4.7 ...
##  $ x11: num  4.9 7.9 7.4 4.7 6 4.3 2.3 3.6 5.9 5.7 ...
##  $ x12: num  6 3.1 5.8 4.5 4.5 3.7 5.4 5.1 5.8 5.7 ...
##  $ x13: num  6.8 5.3 4.5 8.8 6.8 8.5 8.9 6.9 9.3 8.4 ...
##  $ x14: num  4.7 5.5 6.2 7 6.1 5.1 4.8 5.4 5.9 5.4 ...
##  $ x15: num  4.3 4 4.6 3.6 4.5 9.5 2.5 4.8 4.4 5.3 ...
##  $ x16: num  5 3.9 5.4 4.3 4.5 3.6 2.1 4.3 4.4 4.1 ...
##  $ x17: num  5.1 4.3 4 4.1 3.5 4.7 4.2 6.3 6.1 5.8 ...
##  $ x18: num  3.7 4.9 4.5 3 3.5 3.3 2 3.7 4.6 4.4 ...
##  $ x19: num  8.2 5.7 8.9 4.8 7.1 4.7 5.7 6.3 7 5.5 ...
##  $ x20: num  8 6.5 8.4 6 6.6 6.3 7.8 5.8 7.5 5.9 ...
##  $ x21: num  8.4 7.5 9 7.2 9 6.1 7.2 7.7 8.2 6.7 ...
##  $ x22: num  65.1 67.1 72.1 40.1 57.1 50.1 41.1 56.1 56.1 59.1 ...
##  $ x23: Factor w/ 2 levels &quot;No, would not consider&quot;,..: 2 1 2 1 1 1 1 1 2 1 ...
##  - attr(*, &quot;variable.labels&quot;)= Named chr [1:24] &quot;ID&quot; &quot;X1 - Customer Type&quot; &quot;X2 - Industry Type&quot; &quot;X3 - Firm Size&quot; ...
##   ..- attr(*, &quot;names&quot;)= chr [1:24] &quot;id&quot; &quot;x1&quot; &quot;x2&quot; &quot;x3&quot; ...
##  - attr(*, &quot;codepage&quot;)= int 65001</code></pre>
</div>
<div id="missing-treatment" class="section level5" number="2.5.3.2.3">
<h5><span class="header-section-number">2.5.3.2.3</span> 2.3 Missing treatment</h5>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="customer-satisfaction-and-loyalty.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DataExplorer)</span>
<span id="cb356-2"><a href="customer-satisfaction-and-loyalty.html#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_missing</span>(HBAT)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-163-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="customer-satisfaction-and-loyalty.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na.data.frame</span>(HBAT))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>We will only work with the perceptions and hence not the factors.</p>
</div>
<div id="select-relevant-variables" class="section level5" number="2.5.3.2.4">
<h5><span class="header-section-number">2.5.3.2.4</span> 2.4 Select relevant variables</h5>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="customer-satisfaction-and-loyalty.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables aimed for clustering</span></span>
<span id="cb359-2"><a href="customer-satisfaction-and-loyalty.html#cb359-2" aria-hidden="true" tabindex="-1"></a>HBAT_CLU <span class="ot">=</span> HBAT[,<span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">19</span>)]</span></code></pre></div>
</div>
<div id="identify-extreme-outliers-the-most-dissimilar-customers" class="section level5" number="2.5.3.2.5">
<h5><span class="header-section-number">2.5.3.2.5</span> 2.5.Identify extreme outliers (the most dissimilar customers)</h5>
<p>There is no best single way to identify the outliers. Many methods are available.</p>
<ul>
<li><p>One option when the variables are all metric is:</p>
<ul>
<li>Calculate the difference between the observed value for a variable and the variable mean</li>
<li>Square the difference</li>
<li>Sum the squared differences to get a total deviations for that observation across all variables</li>
<li>Take the square root</li>
<li>Repeat this process for all observations</li>
<li>Observations with the highest dissimilarity have the potential to be outliers</li>
<li>Do not focus on the absolute value; rather, look for any value that is relatively large compare to others.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="customer-satisfaction-and-loyalty.html#cb360-1" aria-hidden="true" tabindex="-1"></a>diss <span class="ot">=</span> <span class="fu">sqrt</span>((HBAT_CLU<span class="sc">$</span>x6 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x6))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-2"><a href="customer-satisfaction-and-loyalty.html#cb360-2" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x7 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x7))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-3"><a href="customer-satisfaction-and-loyalty.html#cb360-3" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x8 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x8))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-4"><a href="customer-satisfaction-and-loyalty.html#cb360-4" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x9<span class="sc">-</span><span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x9))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-5"><a href="customer-satisfaction-and-loyalty.html#cb360-5" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x10 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x10))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-6"><a href="customer-satisfaction-and-loyalty.html#cb360-6" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x11<span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x11))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-7"><a href="customer-satisfaction-and-loyalty.html#cb360-7" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x12 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x12))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb360-8"><a href="customer-satisfaction-and-loyalty.html#cb360-8" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x13 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x13))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-9"><a href="customer-satisfaction-and-loyalty.html#cb360-9" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x14 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x14))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-10"><a href="customer-satisfaction-and-loyalty.html#cb360-10" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x15 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x15))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-11"><a href="customer-satisfaction-and-loyalty.html#cb360-11" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x16 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x16))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-12"><a href="customer-satisfaction-and-loyalty.html#cb360-12" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x17<span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x17))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb360-13"><a href="customer-satisfaction-and-loyalty.html#cb360-13" aria-hidden="true" tabindex="-1"></a>              (HBAT_CLU<span class="sc">$</span>x18 <span class="sc">-</span> <span class="fu">mean</span>(HBAT_CLU<span class="sc">$</span>x18))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb360-14"><a href="customer-satisfaction-and-loyalty.html#cb360-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-15"><a href="customer-satisfaction-and-loyalty.html#cb360-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add diss to the dataset</span></span>
<span id="cb360-16"><a href="customer-satisfaction-and-loyalty.html#cb360-16" aria-hidden="true" tabindex="-1"></a>HBAT<span class="sc">$</span>diss <span class="ot">=</span> diss</span>
<span id="cb360-17"><a href="customer-satisfaction-and-loyalty.html#cb360-17" aria-hidden="true" tabindex="-1"></a><span class="co"># order by diss (decreasing order)</span></span>
<span id="cb360-18"><a href="customer-satisfaction-and-loyalty.html#cb360-18" aria-hidden="true" tabindex="-1"></a>newHBAT<span class="ot">&lt;-</span> HBAT[<span class="fu">order</span>(<span class="sc">-</span>diss),] </span>
<span id="cb360-19"><a href="customer-satisfaction-and-loyalty.html#cb360-19" aria-hidden="true" tabindex="-1"></a><span class="co"># display the first 10% rows (the first 10 observations in our dataset)</span></span>
<span id="cb360-20"><a href="customer-satisfaction-and-loyalty.html#cb360-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(newHBAT[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">25</span>)], <span class="dv">10</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">id</th>
<th align="right">diss</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">87</td>
<td align="right">87</td>
<td align="right">6.928141</td>
</tr>
<tr class="even">
<td align="left">7</td>
<td align="right">7</td>
<td align="right">6.767181</td>
</tr>
<tr class="odd">
<td align="left">92</td>
<td align="right">92</td>
<td align="right">6.334014</td>
</tr>
<tr class="even">
<td align="left">90</td>
<td align="right">90</td>
<td align="right">6.149157</td>
</tr>
<tr class="odd">
<td align="left">6</td>
<td align="right">6</td>
<td align="right">6.053869</td>
</tr>
<tr class="even">
<td align="left">84</td>
<td align="right">84</td>
<td align="right">5.982937</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="right">22</td>
<td align="right">5.978623</td>
</tr>
<tr class="even">
<td align="left">57</td>
<td align="right">57</td>
<td align="right">5.766622</td>
</tr>
<tr class="odd">
<td align="left">48</td>
<td align="right">48</td>
<td align="right">5.498648</td>
</tr>
<tr class="even">
<td align="left">72</td>
<td align="right">72</td>
<td align="right">5.433832</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="customer-satisfaction-and-loyalty.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># observe in the output that id 87 displays the largest diss value, meaning the highest average distance overall. However,it does not stand out over the others too much. In this dataset, we do not find any extreme outlier. </span></span></code></pre></div>
</div>
<div id="standardize-the-variables-mean0-std.dev1" class="section level5" number="2.5.3.2.6">
<h5><span class="header-section-number">2.5.3.2.6</span> 2.6 Standardize the variables (mean=0, std.dev=1)</h5>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="customer-satisfaction-and-loyalty.html#cb362-1" aria-hidden="true" tabindex="-1"></a>sd.data<span class="ot">=</span><span class="fu">scale</span>(HBAT_CLU)</span></code></pre></div>
</div>
</div>
<div id="hierarchical-clustering-using-variables" class="section level4" number="2.5.3.3">
<h4><span class="header-section-number">2.5.3.3</span> 3. Hierarchical clustering (using variables)</h4>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="customer-satisfaction-and-loyalty.html#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using complete, avg and single linkage + Euclidian distance</span></span>
<span id="cb363-2"><a href="customer-satisfaction-and-loyalty.html#cb363-2" aria-hidden="true" tabindex="-1"></a> hc.complete <span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(sd.data), <span class="at">method=</span><span class="st">&quot;complete&quot;</span>)  </span>
<span id="cb363-3"><a href="customer-satisfaction-and-loyalty.html#cb363-3" aria-hidden="true" tabindex="-1"></a> hc.average <span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(sd.data), <span class="at">method=</span><span class="st">&quot;average&quot;</span>) </span>
<span id="cb363-4"><a href="customer-satisfaction-and-loyalty.html#cb363-4" aria-hidden="true" tabindex="-1"></a> hc.single <span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(sd.data), <span class="at">method=</span><span class="st">&quot;single&quot;</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="customer-satisfaction-and-loyalty.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the dendograms</span></span>
<span id="cb364-2"><a href="customer-satisfaction-and-loyalty.html#cb364-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb364-3"><a href="customer-satisfaction-and-loyalty.html#cb364-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(hc.complete, <span class="at">main=</span><span class="st">&quot;Complete linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-168-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="customer-satisfaction-and-loyalty.html#cb365-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(hc.average, <span class="at">main=</span><span class="st">&quot;Average linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-168-2.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="customer-satisfaction-and-loyalty.html#cb366-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">plot</span>(hc.single, <span class="at">main=</span><span class="st">&quot;Single linkage&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">sub=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-168-3.png" width="720" style="display: block; margin: auto;" /></p>
<p>Based on the dendograms we observe:</p>
<ul>
<li>the choice of linkage type affects the results</li>
<li>none of the linkage methods yield a balanced, attractive cluster solution</li>
<li>one reason could be that many of the variables in our dataset are highly correlated</li>
<li>multicolinearity (very highly correlated variables) can be an issue in cluster analysis</li>
<li>in other words, the cluster analysis works best with uncorrelated features</li>
<li>Therefore, we have two alternatives:
<ol style="list-style-type: lower-alpha">
<li>Select the variables so that the remaining ones are not strongly correlated to one another</li>
<li>Run a PCA to extract the most important principal components, and afterwards fit the cluster model using PCs vector scores, instead of the original variables. PCs are expected to retain most of the information in the dataset and by definition they are orthogonal (uncorrelated) with one another. We adopt this alternative below.</li>
</ol></li>
</ul>
<p>we see that the complete linkage appear to yield the best result.</p>
</div>
<div id="hierarchical-clustering-using-pcs-score-vectors" class="section level4" number="2.5.3.4">
<h4><span class="header-section-number">2.5.3.4</span> 4. Hierarchical clustering (using PCs score vectors)</h4>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="customer-satisfaction-and-loyalty.html#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Run PCA</span></span>
<span id="cb367-2"><a href="customer-satisfaction-and-loyalty.html#cb367-2" aria-hidden="true" tabindex="-1"></a>HBAT.pca <span class="ot">=</span> <span class="fu">prcomp</span>(HBAT_CLU, <span class="at">scale =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb367-3"><a href="customer-satisfaction-and-loyalty.html#cb367-3" aria-hidden="true" tabindex="-1"></a>HBAT.pca</span>
<span id="cb367-4"><a href="customer-satisfaction-and-loyalty.html#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(HBAT.pca)</span>
<span id="cb367-5"><a href="customer-satisfaction-and-loyalty.html#cb367-5" aria-hidden="true" tabindex="-1"></a><span class="fu">screeplot</span>(HBAT.pca, <span class="at">type=</span><span class="st">&quot;line&quot;</span>)</span>
<span id="cb367-6"><a href="customer-satisfaction-and-loyalty.html#cb367-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lty=</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-169-1.png" width="720" style="display: block; margin: auto;" /></p>
<pre><code>## Standard deviations (1, .., p=13):
##  [1] 1.88867011 1.73137071 1.31836167 1.13455941 1.00261538 0.78652035
##  [7] 0.74258178 0.66857604 0.52984507 0.44800545 0.40767063 0.36202055
## [13] 0.09489861
## 
## Rotation (n x k) = (13 x 13):
##              PC1         PC2         PC3         PC4         PC5          PC6
## x6  -0.008446162 -0.36209283 -0.04678935  0.47025543  0.05007347  0.053218125
## x7  -0.244268729  0.25887463  0.35900707  0.34222834 -0.09769943  0.376718762
## x8  -0.069090049 -0.27405908  0.52503623 -0.36487985  0.01424126 -0.052463334
## x9  -0.457137214 -0.12307431 -0.20045850 -0.10240177 -0.08595970  0.056968447
## x10 -0.255224876  0.20968349  0.18298044  0.32643625  0.12554223 -0.780692662
## x11 -0.252450282 -0.42196215 -0.10369985  0.21751972 -0.03205501  0.163391859
## x12 -0.290987483  0.27281337  0.35867289  0.29559280 -0.01309635  0.195905988
## x13  0.008246314  0.43224128 -0.01407530 -0.15377746  0.02328483  0.358023704
## x14 -0.128457735 -0.26796431  0.52277710 -0.32283288  0.13005779  0.001572649
## x15 -0.065686377  0.01201495 -0.09504456  0.01527331  0.97011829  0.145935408
## x16 -0.430501041 -0.10171830 -0.16835005 -0.14893939 -0.05661020  0.028760422
## x17 -0.278546553  0.37514985 -0.14985400 -0.34574836  0.01358671 -0.154763215
## x18 -0.478712405 -0.07283481 -0.21649677 -0.08389812 -0.03767846  0.020892771
##             PC7         PC8         PC9         PC10        PC11         PC12
## x6  -0.66589654  0.33225521 -0.22462438  0.007874262 -0.18916547  0.004949852
## x7   0.20788462  0.18096215  0.04333602 -0.568040361 -0.12566307  0.242746705
## x8  -0.12857096  0.02143816 -0.36226254 -0.317860485  0.37815324 -0.340652073
## x9  -0.01886806 -0.04489722 -0.30907596  0.143600911  0.42151255  0.646668513
## x10 -0.13799303 -0.24702527  0.12615240 -0.132664225  0.08789281  0.064371162
## x11  0.14409748 -0.51451471  0.07780447 -0.095834270 -0.07938639 -0.183829669
## x12  0.09050524  0.06131073 -0.12450579  0.663204133  0.14586925 -0.308660927
## x13 -0.62750296 -0.48310471  0.13005088 -0.074305149  0.10264536 -0.009554218
## x14 -0.10712744 -0.07358489  0.29554570  0.264416777 -0.46117870  0.360900790
## x15  0.10467064  0.04524136 -0.02892652 -0.056036609  0.08198456 -0.003969278
## x16 -0.13766958  0.40015006  0.66839914 -0.055764820  0.26409100 -0.225868516
## x17 -0.09410061  0.28163148 -0.30107123 -0.053262879 -0.37941812 -0.067534206
## x18  0.06694700 -0.21116321 -0.20232546 -0.066810707 -0.38574841 -0.296113322
##             PC13
## x6  -0.003255188
## x7   0.024896668
## x8  -0.007706804
## x9   0.014147290
## x10  0.012734529
## x11 -0.575848184
## x12 -0.049860958
## x13  0.017852976
## x14  0.013022281
## x15  0.011434967
## x16 -0.008058268
## x17 -0.534199397
## x18  0.615473481
## Importance of components:
##                           PC1    PC2    PC3     PC4     PC5     PC6     PC7
## Standard deviation     1.8887 1.7314 1.3184 1.13456 1.00262 0.78652 0.74258
## Proportion of Variance 0.2744 0.2306 0.1337 0.09902 0.07733 0.04759 0.04242
## Cumulative Proportion  0.2744 0.5050 0.6387 0.73769 0.81502 0.86261 0.90502
##                            PC8    PC9    PC10    PC11    PC12    PC13
## Standard deviation     0.66858 0.5298 0.44801 0.40767 0.36202 0.09490
## Proportion of Variance 0.03438 0.0216 0.01544 0.01278 0.01008 0.00069
## Cumulative Proportion  0.93941 0.9610 0.97644 0.98923 0.99931 1.00000</code></pre>
<p>Based on the elbow, eigen values and % of variance explained criteria, we may decide to select the first 4 PCs as the most important (see Case Study PCA from last week for full details).</p>
<p>Hierarchical clustering based on the first 4 PCs score vectors using Euclidian distance (dist) using linkage=complete, average, or single</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="customer-satisfaction-and-loyalty.html#cb369-1" aria-hidden="true" tabindex="-1"></a>hc.complete<span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(HBAT.pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]), <span class="at">method=</span><span class="st">&quot;complete&quot;</span>)</span>
<span id="cb369-2"><a href="customer-satisfaction-and-loyalty.html#cb369-2" aria-hidden="true" tabindex="-1"></a>hc.average<span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(HBAT.pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]), <span class="at">method=</span><span class="st">&quot;average&quot;</span>)</span>
<span id="cb369-3"><a href="customer-satisfaction-and-loyalty.html#cb369-3" aria-hidden="true" tabindex="-1"></a>hc.single<span class="ot">=</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(HBAT.pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]), <span class="at">method=</span><span class="st">&quot;single&quot;</span>)</span>
<span id="cb369-4"><a href="customer-satisfaction-and-loyalty.html#cb369-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-5"><a href="customer-satisfaction-and-loyalty.html#cb369-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.complete, <span class="at">main=</span><span class="st">&quot;Hierarchical cluster with complete linkage&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-170-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="customer-satisfaction-and-loyalty.html#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.average, <span class="at">main=</span><span class="st">&quot;Hierarchical cluster with average linkage&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-170-2.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="customer-satisfaction-and-loyalty.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc.single, <span class="at">main=</span><span class="st">&quot;Hierarchical cluster with single linkage&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-170-3.png" width="720" style="display: block; margin: auto;" /></p>
<p>Looking at the dendograms: Single linkage does not perform well again. Likewise, average linkage creates innapropriate clusters. Complete linkage creates more appropriate clusters. It comes out that 3-cluster is the most plausible solution.</p>
<p>To visualize the dendogram with red borders around the 3 clusters uncomment the next lines:</p>
<ul>
<li>hc.complete &lt;- hclust(dist(HBAT.pca$x[,1:4]), method=“complete”)</li>
<li>plot(hc.complete, main=“Hierarchical cluster with complete linkage”)</li>
<li>rect.hclust(hc.complete , k = 3, border = “red”)</li>
</ul>
<p>Before proceeding with K-means, we can profile the original variables on the three clusters to confirm that the differences between the clusters are distinctive.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="customer-satisfaction-and-loyalty.html#cb372-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Save the clusters by cutting the tree into 3 clusters </span></span>
<span id="cb372-2"><a href="customer-satisfaction-and-loyalty.html#cb372-2" aria-hidden="true" tabindex="-1"></a>    hc.clusters <span class="ot">=</span> <span class="fu">cutree</span>(hc.complete,<span class="dv">3</span>)</span>
<span id="cb372-3"><a href="customer-satisfaction-and-loyalty.html#cb372-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># Add the cluster variable to my data</span></span>
<span id="cb372-4"><a href="customer-satisfaction-and-loyalty.html#cb372-4" aria-hidden="true" tabindex="-1"></a>    HBAT_CLU<span class="sc">$</span>clusters <span class="ot">=</span> hc.clusters</span>
<span id="cb372-5"><a href="customer-satisfaction-and-loyalty.html#cb372-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># Check size of the clusters</span></span>
<span id="cb372-6"><a href="customer-satisfaction-and-loyalty.html#cb372-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(HBAT_CLU<span class="sc">$</span>clusters)</span></code></pre></div>
<pre><code>## 
##  1  2  3 
## 26 53 21</code></pre>
<p>Run Anova to see if differences in means between clusters are significant and to define the characteristics of the clusters. The independent variable: cluster membership. The dependent variables: the 13 original variables.</p>
<p><strong><em>Does not appear to run</em></strong></p>
<p>The F-statistic from one-way ANOVA examine if there are sig. differences between the three clusters on the respective independent variable. The results indicate sig. differences with respect to all the variables, except x6, x13 and x15.</p>
<p>We may examine the means for the significant variables and characterize the clusters.</p>
<p>Examples:</p>
<p><strong><em>For some reason, this chunk cannot be knitted hence <code>eval=FALSE</code></em></strong></p>
<p>We want to see one cluster being different than the others. In some examples we see that the box is pretty much overlapping with the others, hence that can also be an explanation of why a given cluster is not significant on some variables.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="customer-satisfaction-and-loyalty.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the same for:  x14, x16, x17, x18</span></span>
<span id="cb374-2"><a href="customer-satisfaction-and-loyalty.html#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Interpreting the clusters by looking at the extremes (highest and lowest means): </span></span>
<span id="cb374-3"><a href="customer-satisfaction-and-loyalty.html#cb374-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Cluster 1 has a relatively lower mean on x9 and x11 variables than the other two clusters. This means that customers in this cluster are unhappy about complaint resolution (x9) and product line (x11) </span></span>
<span id="cb374-4"><a href="customer-satisfaction-and-loyalty.html#cb374-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Cluster 2 has a relatively higher mean on x8 (Technical support) and x11(Product line), than the other two clusters.</span></span>
<span id="cb374-5"><a href="customer-satisfaction-and-loyalty.html#cb374-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># - Cluster 3 has a relatively higher mean on x7(E-commerce perceptions), x9(complain resolution), x10(advertising), x12 (salesforce image), than the other two clusters. </span></span>
<span id="cb374-6"><a href="customer-satisfaction-and-loyalty.html#cb374-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  - Overall, as expected, these results indicate that each of the three clusters exibit somewhat distinctive characteristics. </span></span>
<span id="cb374-7"><a href="customer-satisfaction-and-loyalty.html#cb374-7" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: the label assigned to clusters &quot;1&quot;, &quot;2&quot;, &quot;3&quot; can changes from one computer to another. </span></span></code></pre></div>
</div>
<div id="k-means" class="section level4" number="2.5.3.5">
<h4><span class="header-section-number">2.5.3.5</span> 5. K-means</h4>
<p>In k-means clustering the analyst must specify the number of clusters to extract. But how can one know how many segments exist in the population?</p>
<p>One possibility is to rely on theory. The analyst might expect a certain number of segments in the population investigated based on previous knowledge.</p>
<p>Another possibility is to use the results from Hierarchical Clustering.There we identified 3 clusters.Thus, we run K-means clutering with K=3.</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="customer-satisfaction-and-loyalty.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb375-2"><a href="customer-satisfaction-and-loyalty.html#cb375-2" aria-hidden="true" tabindex="-1"></a>km.out<span class="ot">=</span> <span class="fu">kmeans</span>(HBAT.pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="dv">3</span>, <span class="at">nstart=</span><span class="dv">20</span>)</span>
<span id="cb375-3"><a href="customer-satisfaction-and-loyalty.html#cb375-3" aria-hidden="true" tabindex="-1"></a>km.out <span class="co"># evaluate this output</span></span>
<span id="cb375-4"><a href="customer-satisfaction-and-loyalty.html#cb375-4" aria-hidden="true" tabindex="-1"></a>km.clusters<span class="ot">=</span>km.out<span class="sc">$</span>cluster <span class="co"># saving the clusters</span></span></code></pre></div>
<pre><code>## K-means clustering with 3 clusters of sizes 39, 30, 31
## 
## Cluster means:
##          PC1        PC2         PC3         PC4
## 1 -0.3330352 -1.7369154 -0.08640935  0.26069725
## 2 -1.6905084  1.3919404  0.05935694 -0.31601740
## 3  2.0549557  0.8381126  0.05126634 -0.02215066
## 
## Clustering vector:
##   [1] 2 1 1 3 1 3 3 3 2 2 1 3 2 1 2 1 2 2 2 2 3 1 1 1 2 2 1 3 1 3 1 3 3 2 3 3 1
##  [38] 1 2 2 3 1 2 2 1 2 1 2 1 1 3 1 1 3 2 1 2 1 1 1 1 3 3 3 3 2 2 2 3 2 2 3 2 1
##  [75] 2 1 2 1 1 3 1 1 3 3 1 3 3 1 1 2 1 3 1 1 3 1 3 3 2 3
## 
## Within cluster sum of squares by cluster:
## [1] 181.6540 162.0146 181.0767
##  (between_SS / total_SS =  44.7 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;     &quot;tot.withinss&quot;
## [6] &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;         &quot;ifault&quot;</code></pre>
<p>We can compare k-means with hierarchical solution (if we want) using a cross-classification table:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="customer-satisfaction-and-loyalty.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(km.clusters, hc.clusters)</span></code></pre></div>
<pre><code>##            hc.clusters
## km.clusters  1  2  3
##           1  1 36  2
##           2  4  7 19
##           3 21 10  0</code></pre>
<p>Perfect fit would appear if only one cell in each row or column of the table contained a value.</p>
<p>The two methods produce quite different clusters (this is typical), but most of the observations in k-means are grouped with the same observations they cluster with in the hc.cluster solution. In practice the researchers rely on the K-means solution.</p>
<p>We now interpret the meaning of the clusters by analysing the pattern of their cluster means (as we did before with hierarchical clustering)</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="customer-satisfaction-and-loyalty.html#cb379-1" aria-hidden="true" tabindex="-1"></a>HBAT_CLU<span class="sc">$</span>clustersK <span class="ot">=</span> km.out<span class="sc">$</span>cluster</span>
<span id="cb379-2"><a href="customer-satisfaction-and-loyalty.html#cb379-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-3"><a href="customer-satisfaction-and-loyalty.html#cb379-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x6 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK  , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-4"><a href="customer-satisfaction-and-loyalty.html#cb379-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x7 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK  , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-5"><a href="customer-satisfaction-and-loyalty.html#cb379-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x8 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-6"><a href="customer-satisfaction-and-loyalty.html#cb379-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x9 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-7"><a href="customer-satisfaction-and-loyalty.html#cb379-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x10 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-8"><a href="customer-satisfaction-and-loyalty.html#cb379-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x11 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-9"><a href="customer-satisfaction-and-loyalty.html#cb379-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x12 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-10"><a href="customer-satisfaction-and-loyalty.html#cb379-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x13 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-11"><a href="customer-satisfaction-and-loyalty.html#cb379-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x14 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-12"><a href="customer-satisfaction-and-loyalty.html#cb379-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x15 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-13"><a href="customer-satisfaction-and-loyalty.html#cb379-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x16 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-14"><a href="customer-satisfaction-and-loyalty.html#cb379-14" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x17 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span>
<span id="cb379-15"><a href="customer-satisfaction-and-loyalty.html#cb379-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x18 <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK , <span class="at">data=</span>HBAT_CLU[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span></code></pre></div>
<pre><code>##                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## HBAT_CLU$clustersK  1  55.28   55.28   39.33 9.68e-09 ***
## Residuals          98 137.73    1.41                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value Pr(&gt;F)
## HBAT_CLU$clustersK  1   0.05  0.0507   0.102   0.75
## Residuals          98  48.53  0.4952               
##                    Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## HBAT_CLU$clustersK  1  19.61  19.610   9.053 0.00333 **
## Residuals          98 212.28   2.166                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## HBAT_CLU$clustersK  1  39.84   39.84   37.28 2.06e-08 ***
## Residuals          98 104.73    1.07                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value Pr(&gt;F)
## HBAT_CLU$clustersK  1    0.1  0.1036   0.081  0.777
## Residuals          98  125.6  1.2819               
##                    Df Sum Sq Mean Sq F value Pr(&gt;F)    
## HBAT_CLU$clustersK  1  92.64   92.64   115.5 &lt;2e-16 ***
## Residuals          98  78.63    0.80                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value Pr(&gt;F)
## HBAT_CLU$clustersK  1    0.0   0.000       0  0.999
## Residuals          98  113.8   1.162               
##                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## HBAT_CLU$clustersK  1  55.76   55.76   30.27 3.01e-07 ***
## Residuals          98 180.57    1.84                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## HBAT_CLU$clustersK  1   8.62   8.623    14.6 0.000234 ***
## Residuals          98  57.90   0.591                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value Pr(&gt;F)
## HBAT_CLU$clustersK  1   0.54  0.5365   0.239  0.626
## Residuals          98 220.15  2.2465               
##                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## HBAT_CLU$clustersK  1  22.81  22.810   35.71 3.71e-08 ***
## Residuals          98  62.60   0.639                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value Pr(&gt;F)  
## HBAT_CLU$clustersK  1   4.92   4.924    3.47 0.0655 .
## Residuals          98 139.07   1.419                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
##                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## HBAT_CLU$clustersK  1  16.48  16.483   43.76 1.98e-09 ***
## Residuals          98  36.92   0.377                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>According to Anova F-test, the K-means clusters differ significantly based on x6,x7,x8,x10,x11,x12,x13,x17. As we did before for non-hierarchical clustering, interpretation of differences among clusters begins by looking for extreme mean values associated with each cluster. In other words, variable means that are the highest or lowest compared to other clusters are useful in the process of interpreting the clusters.</p>
<p><strong>We can take a look at the plots of the means:</strong></p>
<p><em>Example for x6:</em></p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="customer-satisfaction-and-loyalty.html#cb381-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(<span class="st">&quot;ggpubr&quot;</span>)</span>
<span id="cb381-2"><a href="customer-satisfaction-and-loyalty.html#cb381-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggboxplot</span>(HBAT_CLU, <span class="at">x =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">y =</span> <span class="st">&quot;x13&quot;</span>, </span>
<span id="cb381-3"><a href="customer-satisfaction-and-loyalty.html#cb381-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb381-4"><a href="customer-satisfaction-and-loyalty.html#cb381-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;x13&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ClustersK&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/lastrun7-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="customer-satisfaction-and-loyalty.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To complement the descriptive analysis, we ask for a statistical differences between means based on TukeyHSD(Honestly Significant Difference) </span></span>
<span id="cb382-2"><a href="customer-satisfaction-and-loyalty.html#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(HBAT_CLU<span class="sc">$</span>x6 <span class="sc">~</span> <span class="fu">as.factor</span>(HBAT_CLU<span class="sc">$</span>clustersK), <span class="at">data=</span>HBAT_CLU[ ,<span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>]))</span></code></pre></div>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = HBAT_CLU$x6 ~ as.factor(HBAT_CLU$clustersK), data = HBAT_CLU[, 1:13])
## 
## $`as.factor(HBAT_CLU$clustersK)`
##           diff        lwr        upr     p adj
## 2-1 -2.0446154 -2.6544070 -1.4348237 0.0000000
## 3-1 -1.7028950 -2.3071019 -1.0986880 0.0000000
## 3-2  0.3417204 -0.3013718  0.9848127 0.4184721</code></pre>
<p>We see tat that cluster 1 appear to be different from the two other clusters. Therefore, we also see the Tukey HSF is also saying that there is difference between 1 - 2 and 1 - 3, although 2 - 3 are pretty much the same.</p>
<p><strong>Interpretation of the clusters</strong>: Cluster 1 has 39 observations and is most distiguished by a relatively higher mean on x6, and x?, x?…, than the other two clusters. Cluster 2 has 31 observations and is mostly distiguished by a relatively higher /lower mean on ….,than the other two clusters. Cluster 3 has 30 observations and is most distiguished by a relatively higher /lower mean on …., than the other two clusters.</p>
<p>Using the pca3d library we represent the cluster solution into the first 2 PCs dimensions. This is another descriptive illustration of the clusters and their profile.</p>
<p><strong>For some reason this cannot be run when knitting</strong></p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="customer-satisfaction-and-loyalty.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pca3d) </span>
<span id="cb384-2"><a href="customer-satisfaction-and-loyalty.html#cb384-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pca2d</span>(HBAT.pca, <span class="at">biplot=</span><span class="cn">TRUE</span>, <span class="at">group=</span>km.clusters, <span class="at">legend =</span> <span class="st">&quot;topright&quot;</span>, <span class="at">show.ellipses=</span><span class="cn">TRUE</span>, <span class="at">ellipse.ci=</span><span class="fl">0.75</span>, <span class="at">show.plane=</span><span class="cn">TRUE</span>, <span class="at">show.labels =</span> <span class="cn">TRUE</span>)</span>
<span id="cb384-3"><a href="customer-satisfaction-and-loyalty.html#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co"># See Case Study PCA for biplot interpretation.</span></span></code></pre></div>
</div>
<div id="validation-and-profiling-the-clusters" class="section level4" number="2.5.3.6">
<h4><span class="header-section-number">2.5.3.6</span> 6. Validation and profiling the clusters</h4>
<ul>
<li>The analyst should perform tests to confirm the validity of the cluster solution while also ensuring the cluster solution has practical significance.</li>
</ul>
<div id="assessing-cluster-stability" class="section level5" number="2.5.3.6.1">
<h5><span class="header-section-number">2.5.3.6.1</span> 6.1. Assessing cluster stability</h5>
<ul>
<li>The stability of the cluster solution can be evaluated by splitting the data (if sufficiently big), running two cluster analysis and comparing the results.</li>
</ul>
</div>
<div id="assessing-criterion-predictive-validity" class="section level5" number="2.5.3.6.2">
<h5><span class="header-section-number">2.5.3.6.2</span> 6.2. Assessing criterion (predictive) validity</h5>
<ul>
<li><p>To assess predictive validity of the clusters, we can focus on other variables that have a theoretically based relationship to the clustering variables, but were not included (!) in the cluster analysis. Given this relationship, we should see significant differences in these variables across the clusters. If significant differences do exist, we can draw the conclusion that the clusters depict groups that have predictive validity. For this purpose, we consider four outcome measures from the HBAT,</p></li>
<li><p>x19 Satisfaction</p></li>
<li><p>x20 Likelihood to recommend</p></li>
<li><p>x21 Likelihood to purchase</p></li>
<li><p>x22 Purchase level</p></li>
</ul>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="customer-satisfaction-and-loyalty.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MANOVA allows us to compare simultaneusly the means of these continuous variables among the clusters</span></span>
<span id="cb385-2"><a href="customer-satisfaction-and-loyalty.html#cb385-2" aria-hidden="true" tabindex="-1"></a>manova.model <span class="ot">&lt;-</span> <span class="fu">manova</span>(<span class="fu">cbind</span>(x19,x20,x21,x22) <span class="sc">~</span> HBAT_CLU<span class="sc">$</span>clustersK, <span class="at">data =</span> HBAT)</span>
<span id="cb385-3"><a href="customer-satisfaction-and-loyalty.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(manova.model)</span></code></pre></div>
<pre><code>##                    Df  Pillai approx F num Df den Df    Pr(&gt;F)    
## HBAT_CLU$clustersK  1 0.49108   22.918      4     95 2.831e-13 ***
## Residuals          98                                             
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The overall F-test is significant at 10% level of significance =&gt; initial evidence that some these variables can be predicted by simply knowing to which cluster an HBAT customer belongs.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="customer-satisfaction-and-loyalty.html#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To check individual F-tests: </span></span>
<span id="cb387-2"><a href="customer-satisfaction-and-loyalty.html#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(manova.model)</span></code></pre></div>
<pre><code>##  Response x19 :
##                    Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## HBAT_CLU$clustersK  1 48.930  48.930  52.292 1.064e-10 ***
## Residuals          98 91.698   0.936                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response x20 :
##                    Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## HBAT_CLU$clustersK  1 30.296 30.2956  38.327 1.399e-08 ***
## Residuals          98 77.464  0.7905                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response x21 :
##                    Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## HBAT_CLU$clustersK  1 16.370 16.3700  22.793 6.314e-06 ***
## Residuals          98 70.383  0.7182                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##  Response x22 :
##                    Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## HBAT_CLU$clustersK  1 3413.8  3413.8  76.745 5.898e-14 ***
## Residuals          98 4359.2    44.5                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>Note the output reveals significant F-test for x20, x21 (at 10% level) and x22</li>
</ul>
<p>Digging more into which specific means differ between the three clusters:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="customer-satisfaction-and-loyalty.html#cb389-1" aria-hidden="true" tabindex="-1"></a>HBAT<span class="sc">$</span>clustersK <span class="ot">=</span> HBAT_CLU<span class="sc">$</span>clustersK</span>
<span id="cb389-2"><a href="customer-satisfaction-and-loyalty.html#cb389-2" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb389-3"><a href="customer-satisfaction-and-loyalty.html#cb389-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(HBAT, <span class="at">x =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">y =</span> <span class="st">&quot;x20&quot;</span>, </span>
<span id="cb389-4"><a href="customer-satisfaction-and-loyalty.html#cb389-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb389-5"><a href="customer-satisfaction-and-loyalty.html#cb389-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;x20&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ClustersK&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/MANOVA3-1.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="customer-satisfaction-and-loyalty.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For example we see that cluster 1 is the most likely to recommend and cluster 2 is the least    likely.</span></span>
<span id="cb390-2"><a href="customer-satisfaction-and-loyalty.html#cb390-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-3"><a href="customer-satisfaction-and-loyalty.html#cb390-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(HBAT, <span class="at">x =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">y =</span> <span class="st">&quot;x21&quot;</span>, </span>
<span id="cb390-4"><a href="customer-satisfaction-and-loyalty.html#cb390-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb390-5"><a href="customer-satisfaction-and-loyalty.html#cb390-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;x21&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ClustersK&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/MANOVA3-2.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="customer-satisfaction-and-loyalty.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Idem we see that cluster 1 is the most likely to purchase and cluster 2 is the least likely.</span></span>
<span id="cb391-2"><a href="customer-satisfaction-and-loyalty.html#cb391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-3"><a href="customer-satisfaction-and-loyalty.html#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggboxplot</span>(HBAT, <span class="at">x =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">y =</span> <span class="st">&quot;x22&quot;</span>, </span>
<span id="cb391-4"><a href="customer-satisfaction-and-loyalty.html#cb391-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;clustersK&quot;</span>, <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>),</span>
<span id="cb391-5"><a href="customer-satisfaction-and-loyalty.html#cb391-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&quot;x22&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;ClustersK&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/MANOVA3-3.png" width="720" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="customer-satisfaction-and-loyalty.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Idem we see that cluster 1 has the highest purchase level and cluster 2 is the lowest.</span></span></code></pre></div>
<p><em>Idem = the same as previous</em></p>
</div>
<div id="profiling-the-final-cluster-solution" class="section level5" number="2.5.3.6.3">
<h5><span class="header-section-number">2.5.3.6.3</span> 6.3. Profiling the final cluster solution</h5>
<ul>
<li>A final task can be to profile the clusters on a set of additional
qualitative variables, not included in the cluster analysis. In this
example, five characteristics of HBAT customers are available:</li>
<li>length of purchase relationship(x1)</li>
<li>industry type(x2)</li>
<li>size of the customer(x3)</li>
<li>region of the customer(x4)</li>
<li>distribution system(X5)</li>
</ul>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="customer-satisfaction-and-loyalty.html#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-classification table allows us to profile the clusters based on these categorical variables </span></span>
<span id="cb393-2"><a href="customer-satisfaction-and-loyalty.html#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Chi-square test</span></span>
<span id="cb393-3"><a href="customer-satisfaction-and-loyalty.html#cb393-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)       </span>
<span id="cb393-4"><a href="customer-satisfaction-and-loyalty.html#cb393-4" aria-hidden="true" tabindex="-1"></a>tblx1 <span class="ot">=</span> <span class="fu">table</span>(HBAT<span class="sc">$</span>x1, HBAT_CLU<span class="sc">$</span>clustersK) </span>
<span id="cb393-5"><a href="customer-satisfaction-and-loyalty.html#cb393-5" aria-hidden="true" tabindex="-1"></a>tblx1</span></code></pre></div>
<pre><code>##                   
##                     1  2  3
##   Less than 1 year  2  5 25
##   1 to 5 years      8 22  5
##   Over 5 years     29  3  1</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="customer-satisfaction-and-loyalty.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(tblx1)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  tblx1
## X-squared = 85.369, df = 4, p-value &lt; 2.2e-16</code></pre>
<p>Significant chi-square value reveals for example that x1 (customer type) tends to be associated with certain clusters. In my output observe that customers of “Over 5 years” tend to be concentrated in cluster 1 (recall these were customers that were also most likely to recommend and to purchase). Cluster 2 consists predominantly of customers of “less than 1 year” (they were the customers least likely to recommend and purchase in the future); and cluster 3 consists predominantly of customers between 1 to 5 years. Idem, we can evaluate x2, x3, x4 and x5. From these qualitative variables, distinctive profiles can be developed for each cluster. These profiles support the distinctiveness of the clusters on variables not used in the analysis at any prior point.</p>
</div>
</div>
<div id="final-remarks" class="section level4" number="2.5.3.7">
<h4><span class="header-section-number">2.5.3.7</span> 7. Final remarks</h4>
<ul>
<li>The clustering techniques discussed (hierarchical and K-means) can be applied to numeric (continuous) variables. This course focuses exclusively on these two methods.</li>
<li>For clustering with categorical variables, one option is to use Expectation Maximization algorithm, which yields probabilistic
classes (clusters).</li>
<li>Finally, if interested in clustering with both categorical and continous variables, refer to a new package in R called ‘clustMixType’ (k-Prototypes Clustering for Mixed Variable-Type Data) which can handle mixed data.</li>
</ul>
</div>
</div>
<div id="an-example-with-mcdonalds-data" class="section level3" number="2.5.4">
<h3><span class="header-section-number">2.5.4</span> An example with McDonalds data</h3>
<p>The following is seperated into several sections.</p>
<div id="loading-and-exploring-the-data" class="section level4" number="2.5.4.1">
<h4><span class="header-section-number">2.5.4.1</span> Loading and exploring the data</h4>
<p><strong>Step 1: Deciding to segment or not</strong></p>
<p>You are the manager of a fast food restaurant. The restaurant can take the position that it caters to the entire market. In such case, there is no need to understand systematic differences across market segments. Alternatively, the restaurant can take the position that, despite their market power, there is value in investigating systematic heterogeneity among customers annd harvest these differences with a differentiated marketing strategy. We go for the second alternative.</p>
<p><strong>Step 2: Specifying the ideal target segment</strong></p>
<p>Decide which are the key features that make a segment attractive?</p>
<ul>
<li>homogeneous</li>
<li>substantially distinct</li>
<li>large enough</li>
<li>identifyiable</li>
<li>reachable (channels of communication and distribution exist to aim at that target)</li>
</ul>
<p>In terms of attractiveness, the obvious choice would be a segment with positive perception of our restaurant, which frequently eats out, and likes fast food. But, the manager can also decide that they not only want to solidify position, but rather wish to learn more about the market segments which are currently not fond of fast food.</p>
<p><strong>Step 3: Collecting data</strong></p>
<p>Data originally from Dolnicar (2018) contains responses from 1453 adult</p>
<p>Australian consumers relating to their perceptions of fast food restaurant with respect to different attributes (yummy, convenient, spicy, fattening greasy, fast, cheap, tasty, expensive, healthy, and disgusting). For each attribute, respondents provided either (Yes) or (No) response indicating whether the restaurant possesses this attribute.</p>
<p>Note1: data here is categorical, not continuous. In addition, respondents indicated age, gender, visit frequency, and likeliness.</p>
<p>Note2: Colecting additional data on dining out behavior and their use of information channels would allow the development of a more prosperous and more detailed description of our clusters. But this information is not available in the dataset.</p>
<p><strong>Step 4: Exploring data</strong></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="customer-satisfaction-and-loyalty.html#cb397-1" aria-hidden="true" tabindex="-1"></a>mcdonalds <span class="ot">&lt;-</span> <span class="fu">read.csv</span> (<span class="st">&quot;Data/Clustering/mcdonalds.csv&quot;</span>)</span>
<span id="cb397-2"><a href="customer-satisfaction-and-loyalty.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mcdonalds)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1453 obs. of  15 variables:
##  $ yummy         : chr  &quot;No&quot; &quot;Yes&quot; &quot;No&quot; &quot;Yes&quot; ...
##  $ convenient    : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ spicy         : chr  &quot;No&quot; &quot;No&quot; &quot;Yes&quot; &quot;No&quot; ...
##  $ fattening     : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ greasy        : chr  &quot;No&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ fast          : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ cheap         : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;No&quot; &quot;Yes&quot; ...
##  $ tasty         : chr  &quot;No&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; ...
##  $ expensive     : chr  &quot;Yes&quot; &quot;Yes&quot; &quot;Yes&quot; &quot;No&quot; ...
##  $ healthy       : chr  &quot;No&quot; &quot;No&quot; &quot;Yes&quot; &quot;No&quot; ...
##  $ disgusting    : chr  &quot;No&quot; &quot;No&quot; &quot;No&quot; &quot;Yes&quot; ...
##  $ Like          : chr  &quot;-3&quot; &quot;+2&quot; &quot;+1&quot; &quot;+4&quot; ...
##  $ Age           : int  61 51 62 69 49 55 56 23 58 32 ...
##  $ VisitFrequency: chr  &quot;Every three months&quot; &quot;Every three months&quot; &quot;Every three months&quot; &quot;Once a week&quot; ...
##  $ Gender        : chr  &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; &quot;Female&quot; ...</code></pre>
<p>We see that the categorical data is actually coded in words, this we need to transform.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="customer-satisfaction-and-loyalty.html#cb399-1" aria-hidden="true" tabindex="-1"></a>MD.x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(mcdonalds[, <span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>])</span>
<span id="cb399-2"><a href="customer-satisfaction-and-loyalty.html#cb399-2" aria-hidden="true" tabindex="-1"></a>MD.x <span class="ot">&lt;-</span> (MD.x <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>) <span class="sc">+</span> <span class="dv">0</span></span>
<span id="cb399-3"><a href="customer-satisfaction-and-loyalty.html#cb399-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(MD.x)</span></code></pre></div>
<pre><code>##      yummy convenient spicy fattening greasy fast cheap tasty expensive healthy
## [1,]     0          1     0         1      0    1     1     0         1       0
## [2,]     1          1     0         1      1    1     1     1         1       0
## [3,]     0          1     1         1      1    1     0     1         1       1
## [4,]     1          1     0         1      1    1     1     1         0       0
## [5,]     0          1     0         1      1    1     1     0         0       1
## [6,]     1          1     0         1      0    1     1     1         0       0
##      disgusting
## [1,]          0
## [2,]          0
## [3,]          0
## [4,]          1
## [5,]          0
## [6,]          0</code></pre>
<p>Let us look at the colmeans.</p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="customer-satisfaction-and-loyalty.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">colMeans</span>(MD.x), <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">barplot</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>,<span class="at">main =</span> <span class="st">&quot;Variable means&quot;</span>)</span>
<span id="cb401-2"><a href="customer-satisfaction-and-loyalty.html#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>),<span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>,<span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-174-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that few people rate the food to be spicy and most think that it is convenient, fast and fattening.</p>
<p>We are going to run <strong>PCA</strong> to see variables are correlated.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="customer-satisfaction-and-loyalty.html#cb402-1" aria-hidden="true" tabindex="-1"></a>MD.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(MD.x)</span>
<span id="cb402-2"><a href="customer-satisfaction-and-loyalty.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MD.pca)</span></code></pre></div>
<pre><code>## Importance of components:
##                           PC1    PC2    PC3    PC4     PC5    PC6     PC7
## Standard deviation     0.7570 0.6075 0.5046 0.3988 0.33741 0.3103 0.28970
## Proportion of Variance 0.2994 0.1928 0.1331 0.0831 0.05948 0.0503 0.04385
## Cumulative Proportion  0.2994 0.4922 0.6253 0.7084 0.76787 0.8182 0.86201
##                            PC8     PC9    PC10    PC11
## Standard deviation     0.27512 0.26525 0.24884 0.23690
## Proportion of Variance 0.03955 0.03676 0.03235 0.02932
## Cumulative Proportion  0.90156 0.93832 0.97068 1.00000</code></pre>
<p>We see that the first three components reaches the 60% level.</p>
<p>now lets look at the loadings</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="customer-satisfaction-and-loyalty.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(MD.pca, <span class="at">digits =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Standard deviations (1, .., p=11):
##  [1] 0.8 0.6 0.5 0.4 0.3 0.3 0.3 0.3 0.3 0.2 0.2
## 
## Rotation (n x k) = (11 x 11):
##               PC1   PC2   PC3    PC4    PC5   PC6   PC7   PC8    PC9   PC10
## yummy       0.477 -0.36  0.30 -0.055 -0.308  0.17 -0.28  0.01 -0.572  0.110
## convenient  0.155 -0.02  0.06  0.142  0.278 -0.35 -0.06 -0.11  0.018  0.666
## spicy       0.006 -0.02  0.04 -0.198  0.071 -0.36  0.71  0.38 -0.400  0.076
## fattening  -0.116  0.03  0.32  0.354 -0.073 -0.41 -0.39  0.59  0.161  0.005
## greasy     -0.304  0.06  0.80 -0.254  0.361  0.21  0.04 -0.14  0.003 -0.009
## fast        0.108  0.09  0.06  0.097  0.108 -0.59 -0.09 -0.63 -0.166 -0.240
## cheap       0.337  0.61  0.15 -0.119 -0.129 -0.10 -0.04  0.14 -0.076 -0.428
## tasty       0.472 -0.31  0.29  0.003 -0.211 -0.08  0.36 -0.07  0.639 -0.079
## expensive  -0.329 -0.60 -0.02 -0.068 -0.003 -0.26 -0.07  0.03 -0.067 -0.454
## healthy     0.214 -0.08 -0.19 -0.763  0.288 -0.18 -0.35  0.18  0.186  0.038
## disgusting -0.375  0.14  0.09 -0.370 -0.729 -0.21 -0.03 -0.17  0.072  0.290
##              PC11
## yummy       0.045
## convenient -0.542
## spicy       0.142
## fattening   0.251
## greasy      0.002
## fast        0.339
## cheap      -0.489
## tasty       0.020
## expensive  -0.490
## healthy     0.158
## disgusting -0.041</code></pre>
<p>We see component 1 is highly influenced by yummy and tasty, hence something about the taste.</p>
<p>Then the second component is hihgly described by cheap and expensive, hence something about price.</p>
<p>Component 3 is more about the fattening and greasy-ness.</p>
<p>Lets plot the first two components.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="customer-satisfaction-and-loyalty.html#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flexclust)</span>
<span id="cb406-2"><a href="customer-satisfaction-and-loyalty.html#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">predict</span>(MD.pca), <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>) </span>
<span id="cb406-3"><a href="customer-satisfaction-and-loyalty.html#cb406-3" aria-hidden="true" tabindex="-1"></a><span class="fu">projAxes</span>(MD.pca)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-177-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>Cheap and expensive play a key role in the evaluation of the restaurant disgusting, fattening and greasy point in the same direction (respondents who view the restauratnt fattening and disgusting are also likely to view it greasy) in the opposite direction are the positive attributes: fast, convenient, healthy, tasty, and yummy</p>
<p>Notice how respondents (data points) are distributed:</p>
<ul>
<li>a group of respondents at the top, close to cheap</li>
<li>a group of respondents at the bottom, close to expensive</li>
<li>a group of respondents in thee middle</li>
</ul>
<p><strong><em>Other preliminary remarks:</em></strong>
Results indicate that some attributes are strognly related to one another and that price dimension may be critical in differentiating between groups of consumer</p>
<p>Next, one can perform the segmentation using the most important Pc, as in Lecture 1. That was one approach. Dolnicar and Grun (2008) Challenging factor-cluster segmentation. proposes using Pc in the exploration phase only, and afterwards work with raw data. We follow this approach here.</p>
<p>The clustering variables, in this case, are the dummy (0/1). Distance-based methods such as hierarchical and partitioning (e.g., k-means) work best with continuous variables. Still, in practice, K-means is often used with both categorical and continuous variables.</p>
</div>
<div id="k-means-clustering" class="section level4" number="2.5.4.2">
<h4><span class="header-section-number">2.5.4.2</span> k-Means clustering</h4>
<p>First we are going to assess how many clusters. This will be based on</p>
<ol style="list-style-type: decimal">
<li>Global stability-based data structure analysis, make boxplots for each clusters through bootstrapping to see cluster stability/reporducability, and</li>
<li>Segment Stability, to assess the stability of given segments (clusters)</li>
</ol>
<p><strong>STEP 5: Extracting segments</strong></p>
<p>We are going to use k-means clustering.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="customer-satisfaction-and-loyalty.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb407-2"><a href="customer-satisfaction-and-loyalty.html#cb407-2" aria-hidden="true" tabindex="-1"></a>MD.km28 <span class="ot">&lt;-</span> <span class="fu">stepFlexclust</span>(MD.x, <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb407-3"><a href="customer-satisfaction-and-loyalty.html#cb407-3" aria-hidden="true" tabindex="-1"></a>                         ,<span class="at">nrep =</span> <span class="dv">10</span> <span class="co">#nrep = 10 random starts, k = 2:8 possible clusters</span></span>
<span id="cb407-4"><a href="customer-satisfaction-and-loyalty.html#cb407-4" aria-hidden="true" tabindex="-1"></a>                         ,<span class="at">verbose =</span> <span class="cn">FALSE</span>) </span>
<span id="cb407-5"><a href="customer-satisfaction-and-loyalty.html#cb407-5" aria-hidden="true" tabindex="-1"></a>MD.km28 <span class="ot">&lt;-</span> <span class="fu">relabel</span>(MD.km28)  <span class="co"># relabel segment numbers to be consistent across segmentation</span></span>
<span id="cb407-6"><a href="customer-satisfaction-and-loyalty.html#cb407-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MD.km28, <span class="at">xlab =</span> <span class="st">&quot;number of segments&quot;</span>) <span class="co"># scree plot to compare different solutions</span></span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-178-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that the more clusters we have, the smaller is the within distance of the clusters, that makes sense, as each cluster is able to be more specific than in a fewer no. of cluster constellation.</p>
<p><strong><em>What are we looking for?:</em></strong></p>
<ol style="list-style-type: decimal">
<li>A big increase in heterogeneity. Although that is not visible.</li>
</ol>
<p>As we don’t see any bigger changes, we will use the approach <em>Global stability-based data structure analysis.</em></p>
<p><em>What is Global stability-based data structure analysis?</em></p>
<p>Global Stability (Dolnicar, 2010)</p>
<p>The fundamental idea is to conduct a large number of repeated computations
with many bootstrap samples, with any chosen segmentation algorithm.
If the resulting cluster is the same across repeated computations,
it can be assumed that clusters exist in the data.</p>
<p><strong>The main steps</strong></p>
<ol style="list-style-type: decimal">
<li>draw bootstrap samples</li>
<li>compute the Rand index</li>
<li>inspect boxplots to assess the reproducibility of cluster solutions
<ul>
<li>if Rand index close to 1 =&gt; existence of reproducible clusters</li>
<li>if Rand index clode to 0 =&gt; no structure in the data</li>
</ul></li>
</ol>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="customer-satisfaction-and-loyalty.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb408-2"><a href="customer-satisfaction-and-loyalty.html#cb408-2" aria-hidden="true" tabindex="-1"></a>MD.b28 <span class="ot">&lt;-</span> <span class="fu">bootFlexclust</span>(MD.x, <span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">nrep =</span> <span class="dv">10</span>, <span class="at">nboot =</span> <span class="dv">30</span>) <span class="co">#She used 100</span></span>
<span id="cb408-3"><a href="customer-satisfaction-and-loyalty.html#cb408-3" aria-hidden="true" tabindex="-1"></a><span class="co"># global stability plot:</span></span>
<span id="cb408-4"><a href="customer-satisfaction-and-loyalty.html#cb408-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MD.b28, <span class="at">xlab =</span> <span class="st">&quot;number of segments&quot;</span>,</span>
<span id="cb408-5"><a href="customer-satisfaction-and-loyalty.html#cb408-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;adjusted Rand index&quot;</span></span>
<span id="cb408-6"><a href="customer-satisfaction-and-loyalty.html#cb408-6" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">main =</span> <span class="st">&quot;Global Stability Plot&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-179-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>See the distribution of stability for each number of segments.</p>
<p><em>Median</em> in the black horizontal line. The higher the stability, the better. As noticed, <em>2- and 3-cluster solutions are pretty stable</em>. However, they do not offer a differentiated view of the market 4-cluster solution emerges as the solution containing most market segments which can still be reasonably well replicated (median adjusted Rand index is above 0.7).</p>
<p><strong><em>Hence this argue for a 2 or 3 cluster model.</em></strong></p>
<p>Although before we take any conclusions, we can see what the segment stability suggests.</p>
<p><em>What is segment stability?</em></p>
<p>Segment Stability (Dolnicar, 2017)</p>
<p>Global stability analysis explained before is based on a comparison of segmentation solutions with the same number of segments. Another way to explore that data before committing to the final market segmentation solution is to inspect how to segment memberships change each time an additional market segment is added, and to assess segment stability across solutions.</p>
<p>For this we use the <code>salsaplot</code> :-)</p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="customer-satisfaction-and-loyalty.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slsaplot</span>(MD.km28)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-180-1.png" width="720" style="display: block; margin: auto;" /></p>
<p><em>Interpretation</em>: thick green lines indicate that many members of the segment to the left of the line move across to the segment on the right side of the line. For this data, we see that segment 2 in the two-segment solution (in the far left column of the plot) remains almost unchanged until the four-segment solution, then it starts losing members. (i.e. segment 2 displays high stability until 4 segment solution). similar with segment 1 in the two-segment solution.</p>
<p>Segment 2 in the four-segment solution draws members from two segments. segment two might not be a good target segment because of the lack of stability. Similar segment 3 in the four-segment solution</p>
<p>We dont want a cluster just to be splitting up and perhaps being clustered again etc. because that indicates that a model is unstable.</p>
<p><strong><em>Hence this argue for a 2, 3 or 4 cluster model.</em></strong></p>
<p><strong>We select a four cluster model</strong></p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="customer-satisfaction-and-loyalty.html#cb410-1" aria-hidden="true" tabindex="-1"></a>MD.k4 <span class="ot">&lt;-</span> MD.km28[[<span class="st">&quot;4&quot;</span>]]</span>
<span id="cb410-2"><a href="customer-satisfaction-and-loyalty.html#cb410-2" aria-hidden="true" tabindex="-1"></a>MD.k4 </span></code></pre></div>
<pre><code>## kcca object of family &#39;kmeans&#39; 
## 
## call:
## stepFlexclust(x = MD.x, k = 4L, nrep = 10, verbose = FALSE)
## 
## cluster sizes:
## 
##   1   2   3   4 
## 334 457 237 425</code></pre>
<p>Now we are looking at the segment stability for the 4 cluster model.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="customer-satisfaction-and-loyalty.html#cb412-1" aria-hidden="true" tabindex="-1"></a>MD.r4 <span class="ot">&lt;-</span> <span class="fu">slswFlexclust</span>(MD.x, MD.k4)</span>
<span id="cb412-2"><a href="customer-satisfaction-and-loyalty.html#cb412-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MD.r4, <span class="at">ylim =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">xlab =</span> <span class="st">&quot;segment number&quot;</span>,</span>
<span id="cb412-3"><a href="customer-satisfaction-and-loyalty.html#cb412-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;segment stability&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-182-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>We see that cluster 1 nd 2 has the lowest stability.</p>
</div>
<div id="interpreting-the-clusters" class="section level4" number="2.5.4.3">
<h4><span class="header-section-number">2.5.4.3</span> Interpreting the clusters</h4>
<p><strong>STEP 6: Profiling segments</strong></p>
<p>The core of the segmentation analysis is now complete; but now we need to understand what the 4-segment k-means solution means. In lecture 1 we used anova; now we use a graphical representation to explore the clusters characteristics.</p>
<p>segment profile plot a trick to position similar attribute close to one another is to run hc on attributes (rather than consumers) before plotting</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="customer-satisfaction-and-loyalty.html#cb413-1" aria-hidden="true" tabindex="-1"></a>MD.vclust <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(<span class="fu">t</span>(MD.x)))</span>
<span id="cb413-2"><a href="customer-satisfaction-and-loyalty.html#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barchart</span>(MD.k4, <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">which =</span> <span class="fu">rev</span>(MD.vclust<span class="sc">$</span>order))</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-183-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>This plot is easy to managers to interpret. They can see the four segments with the corresponding size. The barplot shows the % of respondents - within each segment, who associate each perception with the fast-food restaurant The line with the dot is the % of respondents - in the entire sample, who associate each perception with the fast-food restaurant.</p>
<p>The marker variables differ from the overall sample percentage either by more than 25% points in absolute terms or by more than 50% in relative terms.</p>
<p>To understand the market, the manager has to do two things:</p>
<ol style="list-style-type: lower-alpha">
<li>to compare the bars for each segment with the horizontal line to see what makes each segment distinct from all consumers in the market</li>
<li>compare the bars across segments to identify the difference between segments.</li>
</ol>
<p>*<strong>Yet another visualization</strong></p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="customer-satisfaction-and-loyalty.html#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another helpful visualization for managers</span></span>
<span id="cb414-2"><a href="customer-satisfaction-and-loyalty.html#cb414-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MD.k4, <span class="at">project =</span> MD.pca, <span class="at">data =</span> MD.x, </span>
<span id="cb414-3"><a href="customer-satisfaction-and-loyalty.html#cb414-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">hull =</span> <span class="cn">FALSE</span>, <span class="at">simlines =</span> <span class="cn">FALSE</span>,</span>
<span id="cb414-4"><a href="customer-satisfaction-and-loyalty.html#cb414-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;principal component 1&quot;</span>,</span>
<span id="cb414-5"><a href="customer-satisfaction-and-loyalty.html#cb414-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;principal component 2&quot;</span>)</span>
<span id="cb414-6"><a href="customer-satisfaction-and-loyalty.html#cb414-6" aria-hidden="true" tabindex="-1"></a><span class="fu">projAxes</span>(MD.pca)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-184-1.png" width="720" style="display: block; margin: auto;" /></p>
<ul>
<li>segment 1 and 4 see the restaurant cheap, with</li>
<li>segment 1 holding some negative beliefs and</li>
<li>segment 4 some positive beliefs</li>
<li>segment 2 agrees that the restaurant is not cheap</li>
</ul>
<p><strong>STEP 7: Describing segments</strong></p>
<p>analysis based on other variables not used in segmentation analysis</p>
<p><em>Looking into the Like variable</em></p>
<p>We show how it is liked and then see how that is reflected in the clusters.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="customer-satisfaction-and-loyalty.html#cb415-1" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">clusters</span>(MD.k4)</span>
<span id="cb415-2"><a href="customer-satisfaction-and-loyalty.html#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">table</span>(k4, mcdonalds<span class="sc">$</span>Like), <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Relation between the clusters and Like&quot;</span>,</span>
<span id="cb415-3"><a href="customer-satisfaction-and-loyalty.html#cb415-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;segment number&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-185-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>colored cells indicate the deviation of observed frequencies from the expected frequencies</p>
<ul>
<li>red means that that sentiment is rarely expresed by that segment</li>
<li>blue means that that sentiment is much expresed by that segment</li>
</ul>
<p>Notice that the Y labels are fitted to cluster 1, so it is a bit hard to see.</p>
<p>That means for instance cluster 2, there are not any people who loves it, but there is a lot of people who hates it.</p>
<p><em>Looking into gender</em></p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="customer-satisfaction-and-loyalty.html#cb416-1" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">clusters</span>(MD.k4)</span>
<span id="cb416-2"><a href="customer-satisfaction-and-loyalty.html#cb416-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="fu">table</span>(k4, mcdonalds<span class="sc">$</span>Gender), <span class="at">shade =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb416-3"><a href="customer-satisfaction-and-loyalty.html#cb416-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;segment number&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-186-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>in my case, segment 2 contain significanty more men (blue box in the bottom of the second column) the rest have similar gender distribution (all white boxes)</p>
<p><em>Looking into age</em></p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="customer-satisfaction-and-loyalty.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># because age is metric</span></span>
<span id="cb417-2"><a href="customer-satisfaction-and-loyalty.html#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(mcdonalds<span class="sc">$</span>Age <span class="sc">~</span> k4, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>,</span>
<span id="cb417-3"><a href="customer-satisfaction-and-loyalty.html#cb417-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">&quot;segment number&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;age&quot;</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-187-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>the plot suggests significant differences in average age across segments</p>
<ul>
<li>cluster 1 is dominated by older people;</li>
<li>cluster 4 is dominated by the younger people. altternatively, Anova test can be implemented.</li>
</ul>
<p><strong>STEP 8: Selecting (the) target segment(s)</strong></p>
<p>mean segment values for other variables and segment evaluation plot</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="customer-satisfaction-and-loyalty.html#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb418-2"><a href="customer-satisfaction-and-loyalty.html#cb418-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mcdonalds<span class="sc">$</span>VisitFrequency)</span>
<span id="cb418-3"><a href="customer-satisfaction-and-loyalty.html#cb418-3" aria-hidden="true" tabindex="-1"></a><span class="co">#conver VisitFrequency to numeric before</span></span>
<span id="cb418-4"><a href="customer-satisfaction-and-loyalty.html#cb418-4" aria-hidden="true" tabindex="-1"></a>mcdonalds<span class="sc">$</span>VisitFrequency <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mcdonalds<span class="sc">$</span>VisitFrequency)</span>
<span id="cb418-5"><a href="customer-satisfaction-and-loyalty.html#cb418-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mcdonalds$VisitFrequency &lt;- recode(mcdonalds$VisitFrequency</span></span>
<span id="cb418-6"><a href="customer-satisfaction-and-loyalty.html#cb418-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    ,&quot;Never&quot; =&quot;1&quot;</span></span>
<span id="cb418-7"><a href="customer-satisfaction-and-loyalty.html#cb418-7" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    ,&quot;Once a year&quot;=&quot;2&quot;</span></span>
<span id="cb418-8"><a href="customer-satisfaction-and-loyalty.html#cb418-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    ,&quot;Every three months&quot; = &quot;3&quot;</span></span>
<span id="cb418-9"><a href="customer-satisfaction-and-loyalty.html#cb418-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    ,&quot;Once a month&quot; = &quot;4&quot;</span></span>
<span id="cb418-10"><a href="customer-satisfaction-and-loyalty.html#cb418-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    ,&quot;Once a week&quot;=&quot;5&quot;</span></span>
<span id="cb418-11"><a href="customer-satisfaction-and-loyalty.html#cb418-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    ,&quot;More than once a week&quot; = &quot;6&quot;</span></span>
<span id="cb418-12"><a href="customer-satisfaction-and-loyalty.html#cb418-12" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    )</span></span>
<span id="cb418-13"><a href="customer-satisfaction-and-loyalty.html#cb418-13" aria-hidden="true" tabindex="-1"></a>visit <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="fu">as.numeric</span>(mcdonalds<span class="sc">$</span>VisitFrequency), k4, mean)</span>
<span id="cb418-14"><a href="customer-satisfaction-and-loyalty.html#cb418-14" aria-hidden="true" tabindex="-1"></a>visit <span class="co">#Mean pr. cluster</span></span></code></pre></div>
<pre><code>## 
##    Every three months More than once a week                 Never 
##                   342                    54                   131 
##          Once a month           Once a week           Once a year 
##                   439                   235                   252 
##        1        2        3        4 
## 3.841317 3.566740 3.523207 3.618824</code></pre>
<p>We see that we have computed the mean for each cluster. Where cluster 4 is the lowest while cluster 1 the highest.</p>
<p><em>Doing the same, but for Like</em></p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="customer-satisfaction-and-loyalty.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mcdonalds<span class="sc">$</span>Like)</span></code></pre></div>
<pre><code>## 
##           -1           -2           -3           -4           +1           +2 
##           58           59           73           71          152          187 
##           +3           +4            0 I hate it!-5 I love it!+5 
##          229          160          169          152          143</code></pre>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="customer-satisfaction-and-loyalty.html#cb422-1" aria-hidden="true" tabindex="-1"></a>mcdonalds<span class="sc">$</span>Like <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mcdonalds<span class="sc">$</span>Like)</span>
<span id="cb422-2"><a href="customer-satisfaction-and-loyalty.html#cb422-2" aria-hidden="true" tabindex="-1"></a><span class="co"># mcdonalds$Like&lt;- recode(mcdonalds$Like</span></span>
<span id="cb422-3"><a href="customer-satisfaction-and-loyalty.html#cb422-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                         , &quot;I hate it!-5&quot;=&quot;-5&quot;</span></span>
<span id="cb422-4"><a href="customer-satisfaction-and-loyalty.html#cb422-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                         , &quot;I love it!+5&quot; = &quot;5&quot;) # conver Like to numeric</span></span>
<span id="cb422-5"><a href="customer-satisfaction-and-loyalty.html#cb422-5" aria-hidden="true" tabindex="-1"></a>like <span class="ot">&lt;-</span> <span class="fu">tapply</span>(<span class="fu">as.numeric</span>(mcdonalds<span class="sc">$</span>Like), k4, mean)</span>
<span id="cb422-6"><a href="customer-satisfaction-and-loyalty.html#cb422-6" aria-hidden="true" tabindex="-1"></a>like</span></code></pre></div>
<pre><code>##        1        2        3        4 
## 5.961078 6.849015 7.949367 7.183529</code></pre>
<p>We see the means again for each cluster.</p>
<p><em>Doing the same, but for gender</em></p>
<p>1 = Female and 0 = Male</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="customer-satisfaction-and-loyalty.html#cb424-1" aria-hidden="true" tabindex="-1"></a>female <span class="ot">&lt;-</span> <span class="fu">tapply</span>((mcdonalds<span class="sc">$</span>Gender <span class="sc">==</span> <span class="st">&quot;Female&quot;</span>) <span class="sc">+</span> <span class="dv">0</span>, k4, mean) <span class="co"># conver gender to numeric </span></span>
<span id="cb424-2"><a href="customer-satisfaction-and-loyalty.html#cb424-2" aria-hidden="true" tabindex="-1"></a>female</span></code></pre></div>
<pre><code>##         1         2         3         4 
## 0.5778443 0.4529540 0.6075949 0.5741176</code></pre>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="customer-satisfaction-and-loyalty.html#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prop.table(table(mcdonalds$Gender, k4), 2)</span></span></code></pre></div>
<p>The same as above.</p>
<p><strong><em>Plotting visit frquency against like</em></strong></p>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="customer-satisfaction-and-loyalty.html#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(visit, like</span>
<span id="cb427-2"><a href="customer-satisfaction-and-loyalty.html#cb427-2" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">cex =</span> <span class="dv">8</span> <span class="sc">*</span> female <span class="co">#This is a clever way to control the size of the cluster!</span></span>
<span id="cb427-3"><a href="customer-satisfaction-and-loyalty.html#cb427-3" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">4.5</span>)</span>
<span id="cb427-4"><a href="customer-satisfaction-and-loyalty.html#cb427-4" aria-hidden="true" tabindex="-1"></a>     ,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb427-5"><a href="customer-satisfaction-and-loyalty.html#cb427-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(visit, like, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="Customer-Analytics-Notes_files/figure-html/unnamed-chunk-190-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>The plot obtained is a segment evaluation plot. Market segments 1 and 3 are located in the attractive quadrant of the plot. Members of those segments like the fast-food restaurant and visit it frequently. These segments need to be retained, and their need must be satisfied in the future.</p>
<p>Segments 1 (in this run) is located in the least attractive position, they rarely eat there, making it unattractive as a potential market segment. they are, in general, older customers (median &gt; 50 yrs. old).</p>
<p>Segment 2 does not currently perceive the restaurant in a positive way. Still, it is a viable market segment (average “Like” is close to zero (neutral)). Manager action could attempt to address the negative perceptions of this segment (they feel it is “expensive”) and reinforce positive perceptions (if any).</p>
<p>As a result, the fast-food restaurant can enlarge its customer base. Overall the segment evaluation plot serves as a decision support tool for the management to discuss which of the four segments should be targeted.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="customer-lifetime-value.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="recommender-systems-and-customer-targeting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
